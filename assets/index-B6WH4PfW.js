(function(){const r=document.createElement("link").relList;if(r&&r.supports&&r.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))f(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const t of i.addedNodes)t.tagName==="LINK"&&t.rel==="modulepreload"&&f(t)}).observe(document,{childList:!0,subtree:!0});function l(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerPolicy&&(i.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?i.credentials="include":s.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function f(s){if(s.ep)return;s.ep=!0;const i=l(s);fetch(s.href,i)}})();const dt=()=>{const e=document.createElement("canvas"),r=e.getContext("2d");if(!r)throw new Error("CanvasRenderingContext2D is null");const l=()=>{e.width=innerWidth*devicePixelRatio,e.height=innerHeight*devicePixelRatio,r.scale(devicePixelRatio,devicePixelRatio),e.style.width=`${innerWidth}px`,e.style.height=`${innerHeight}px`},f=o=>{r.clearRect(0,0,innerWidth,innerHeight),o()};return l(),document.body.appendChild(e),{ctx:r,render:f,resize:l,rotate:(o,c,a,h)=>{r.save(),r.translate(c,a),r.rotate(Math.PI*h),r.translate(-c,-a),o(),r.restore()},translate:(o,c,a)=>{r.save(),r.translate(c,a),o(),r.restore()},shade:(o,c)=>{o=o.substring(1);const a=parseInt(o,16),h=Math.round(2.55*c),u=(a>>16)+h,p=(a>>8&255)+h,g=(a&255)+h;return"#"+(16777216+(u<255?u<1?0:u:255)*65536+(p<255?p<1?0:p:255)*256+(g<255?g<1?0:g:255)).toString(16).slice(1)},setBackground:(o,c)=>{var a;document.body.style.background=o,document.body.style.backgroundColor=c||o,(a=document.querySelector('meta[name="theme-color"]'))==null||a.setAttribute("content",c||o)},createImg:(o,c,a=c)=>{const h=document.createElement("canvas"),u=h.getContext("2d");if(!u)throw new Error("CanvasRenderingContext2D is null");return h.width=c*devicePixelRatio,h.height=a*devicePixelRatio,u.scale(devicePixelRatio,devicePixelRatio),o(u),h}}},lt=e=>{let r="",l="",f;const s=n=>e.find(d=>d.name===n)||e[0],t={render:()=>{},navigate:(n,d)=>{const o=s(n);l=r||"",r=(o==null?void 0:o.name)||"",f=d,t.render=(o==null?void 0:o.ctor())||(()=>{})},useScreenMeta:()=>({to:r,from:l,data:f})};return t},ut=()=>{const e=requestAnimationFrame||(t=>setTimeout(t,16.666666666666668)),r=[],l={};return{loop:(t,n)=>{if(Object.entries(l).find(([o,c])=>c===t)||n&&l[n])throw new Error(`Loop${n?" "+n:""} already specified`);n&&r.push(n),n=n||new Date().valueOf().toString(),l[n]=t;const d=()=>{t(),l[n]&&e(d)};d()},stop:t=>{if(typeof t=="string")delete l[t];else{const n=Object.entries(l).find(([d,o])=>o===t);n&&delete l[n[0]]}},stopAll:()=>{for(const t in l)r.indexOf(t)===-1&&delete l[t]}}};let $=[];const ht=()=>{for(const e of $)clearTimeout(e);$=[]},ft=(e,r=400)=>{let l=new Date,f=r,s=setTimeout(e,f);return $.push(s),{pause:()=>{clearTimeout(s),f-=new Date-l},resume:()=>{l=new Date,clearTimeout(s),s=setTimeout(e,f),$.push(s)},stop:()=>{clearTimeout(s)}}},V=2147483646,B=2147483647,pt=16807,gt=(e=Math.floor(Math.random()*B))=>{e=e%B,e<=0&&(e+=V);const r=()=>(e=e*pt%B,e),l=()=>(r()-1)/V;return(s,i)=>(i===void 0&&(i=s,s=0),Math.floor(l()*(i-s+1))+s)},mt=(e,r)=>(r===void 0&&(r=e,e=0),Math.floor(Math.random()*(r-e+1))+e),Mt=()=>{const e=[],r=[],l=[];return{addEventResize:c=>{c(),e.push(c)},onResizeEvents:()=>e.forEach(c=>c()),addEventClick:c=>r.push(c),onClickEvents:(c,a)=>r.forEach(h=>h(c,a)),addEventMove:c=>l.push(c),onMoveEvents:(c,a)=>l.forEach(h=>h(c,a)),removeAllEvents:()=>{e.splice(0),r.splice(0),l.splice(0)}}},k=(e,r)=>{const l=Math.pow(Math.abs(e.x-r.x),2),f=Math.pow(Math.abs(e.y-r.y),2),s=e.r||0,i=r.r||0,t=Math.pow(s+i,2);return l+f<=t},vt=(e,r)=>{const l=e.r||0,f=r.w||0,s=r.h||0;return Math.abs(r.x+f/2-e.x)<=f/2+l&&Math.abs(r.y+s/2-e.y)<=s/2+l},yt=(e,r)=>k(e,r),Et=e=>{const r={},l=s=>{const i=s.split("/");return i[i.length-1].split(".")[0]};return(()=>{for(const s of e){const i=new Audio(s);i.volume=.25,i.addEventListener("ended",function(){this.currentTime=0});const t=l(s);r[t]={audio:i,path:s}}})(),s=>{var d,o;const i=(d=r[s])==null?void 0:d.audio,t=(o=r[s])==null?void 0:o.path;if(!(!i||!t))if(i.currentTime===0)i.play();else{var n=new Audio(t);n.volume=.25,n.play()}}};let O;const Pt=(e,r)=>{if(O)throw new Error("Webcore already specified");const l=dt(),f=lt(e),{loop:s,stop:i,stopAll:t}=ut(),{addEventResize:n,onResizeEvents:d,addEventClick:o,onClickEvents:c,addEventMove:a,onMoveEvents:h,removeAllEvents:u}=Mt();let p=innerWidth/2,g=innerHeight/2,m=innerWidth<innerHeight?innerWidth:innerHeight,M=Math.ceil(Math.sqrt(innerWidth*innerWidth+innerHeight*innerHeight)/144);const E=()=>({cx:p,cy:g,s:m,m:M}),w=Et([]);O={font:"Tijuf",ctx:l.ctx,shade:l.shade,rotate:l.rotate,translate:l.translate,setBackground:l.setBackground,createImg:l.createImg,useMeasure:E,useScreenMeta:f.useScreenMeta,navigate:(v,x)=>{if(!e.some(y=>y.name===v))throw new Error(`Screen ${v} not specified`);t(),ht(),u(),new Promise(()=>f.navigate(v,x))},loop:s,loopStop:i,useTimer:ft,rand:mt,useRandChain:gt,intersect:yt,addEventResize:n,addEventClick:o,addEventMove:a,playAudio:w},s(()=>l.render(f.render),"draw"),window.onresize=()=>{p=innerWidth/2,g=innerHeight/2,m=innerWidth<innerHeight?innerWidth:innerHeight,M=Math.ceil(Math.sqrt(innerWidth*innerWidth+innerHeight*innerHeight)/144),l.resize(),d()},document.onpointerdown=v=>{c(v.clientX,v.clientY)},document.onmousemove=v=>{h(v.clientX,v.clientY)},f.navigate()},S=()=>{if(!O)throw new Error("Webcore not specified");return{...O}},N={},R=e=>{const{shade:r,ctx:l,createImg:f}=S(),s=()=>{const{r:t,c:n="#ffffff",p:d}=e,o=l.createRadialGradient(t,t,t,t,t,t/5);return o.addColorStop(0,r(n,0)),o.addColorStop(.01,r(n,0)),o.addColorStop(.075,r(n,9)),o.addColorStop(.15,r(n,0)),o.addColorStop(.15,r(n,-15)),o.addColorStop(.18,r(n,-5)),o.addColorStop(.22,r(n,-15)),d?(o.addColorStop(.24,r(n,-10)),o.addColorStop(.3,r(n,-8)),o.addColorStop(.34,r(n,-12)),o.addColorStop(.6,r(n,-6)),o.addColorStop(1,r(n,-4))):(o.addColorStop(.24,r(n,-12)),o.addColorStop(.26,r(n,-8)),o.addColorStop(.3,r(n,-2)),o.addColorStop(.34,r(n,0)),o.addColorStop(.5,r(n,5)),o.addColorStop(1,r(n,10))),o},i=()=>{const{r:t,c:n="#ffffff",p:d}=e,o=`${n}_${d?"push":"pop"}_${t}`;if(N[o])return N[o];const c=f((a=l)=>{const h=s();a.fillStyle=h,a.beginPath(),a.arc(t,t,t,0,2*Math.PI),a.closePath(),a.fill()},2*t);return N[o]=c,c};return(t=l)=>{const{x:n,y:d,r:o}=e,c=i();t.drawImage(c,n-o,d-o,2*o,2*o)}},G={},L=e=>{const{ctx:r}=S();let l;return G[e.src]?l=G[e.src]:(l=new Image,l.src=e.src,G[e.src]=l),(f=r)=>{const{w:s,h:i=s,x:t=0,y:n=0}=e;l.complete&&f.drawImage(l,t,n,s,i)}},K=e=>{const{font:r,ctx:l}=S(),f=e.text,s=e.text.length,i=2*Math.PI/s/4;return(t=l)=>{const{x:n,y:d,r:o,s:c=0,fs:a}=e,h=a||Math.round(o/4);t.textAlign="center",t.fillStyle="#f9f9f9",t.font=`${h}px ${r}`,t.save(),t.translate(n,d),t.rotate(c);for(let u=0;u<s;u++)t.save(),t.rotate(u*i),t.fillText(f[u],0,-o),t.restore();t.restore()}},St=()=>{var E,w;const{ctx:e,loop:r,rotate:l,navigate:f,useMeasure:s,addEventClick:i,addEventResize:t,setBackground:n}=S();n("#040404");let d=!1,o,c,a,h,u,p=-.2,g=0;t(()=>{const{cx:v,cy:x,s:y}=s(),P=Math.round(y*.25);o={c:"#ff6347",x:v,y:x,r:P,p:!1},c=R(o),a=L({x:v-P+Math.round(P*.35),y:x-P+Math.round(P*.35),w:P*2-Math.round(P*.7),src:"/media/sloth.svg"}),h=K({text:"nezabotin",x:v,y:x,r:Math.round(P*1.1),s:Math.PI*1.6}),u=K({text:"production",x:v,y:x,r:Math.round(P*1.1),s:Math.PI*2.6})});const m=()=>{p+=.01,g=p>=1?1:p,p>=1.8&&(o.p=!0),p>=2.2&&(o.c="#f86a9a"),p>=2.6&&f("main")};i(()=>{[1.4,1.8,2.2,2.6].some(v=>{if(p<v)return p=v,!0})});const M=()=>{r(m),d=!0};return(E=document==null?void 0:document.fonts)!=null&&E.ready?(w=document==null?void 0:document.fonts)==null||w.ready.then(M):M(),()=>{const{cx:v,cy:x}=s();e.globalAlpha=d?1:0,c(),p<1.8&&a(),p<1.4&&l(()=>{h(),u()},v,x,g),e.globalAlpha=1}},xt=()=>{const{addEventResize:e,useMeasure:r,useTimer:l,useScreenMeta:f,navigate:s,addEventClick:i,intersect:t}=S(),{from:n}=f();let d,o,c;return e(()=>{const{cx:u,cy:p,s:g,m}=r(),M=Math.round(g*.25);d={c:"#ba68c8",r:Math.round(g*.08),x:u-M-1*m,y:p-M+1*m,p:(n==="score"||n==="opening")&&!d},o=R(d),c=L({x:Number(d.x)-d.r+Math.round(d.r*.5),y:Number(d.y)-d.r+Math.round(d.r*.5),w:d.r*2-Math.round(d.r*1),src:"/media/star.svg"})}),l(()=>{d.p=!1}),i((u,p)=>{t({x:u,y:p},d)&&(d.p=!0,l(()=>{s("score")},100))}),{render:()=>{o(),d.p||c()},point:()=>({x:d.x,y:d.y,r:d.r})}},wt=()=>{const{addEventResize:e,useMeasure:r,useTimer:l,useScreenMeta:f,navigate:s,addEventClick:i,intersect:t}=S(),{from:n}=f();let d,o,c;return e(()=>{const{s:u}=r(),p=Math.round(u*.08);d={c:"#ff6347",r:p,x:Math.round(1.6*p),y:Math.round(1.6*p),p:n==="main"&&!d},o=R(d),c=L({x:Number(d.x)-p+Math.round(p*.4),y:Number(d.y)-p+Math.round(p*.4),w:p*2-Math.round(p*.8),src:"/media/back.svg"})}),l(()=>{d.p=!1}),i((u,p)=>{t({x:u,y:p},d)&&(d.p=!0,l(()=>{s("main")},100))}),{render:()=>{o(),d.p||c()},point:()=>({x:d.x,y:d.y,r:d.r})}},Ct=e=>{const{addEventResize:r,useMeasure:l,useTimer:f,addEventClick:s,intersect:i,rotate:t}=S();let n,d,o;return r(()=>{const{s:h}=l(),u=Math.round(h*.055);n={c:"#ff6347",r:u,x:Math.round(innerWidth-1.6*u),y:Math.round(innerHeight-1.6*u),p:!1},d=R(n),o=L({x:Number(n.x)-u+Math.round(u*.4),y:Number(n.y)-u+Math.round(u*.4),w:u*2-Math.round(u*.8),src:"/media/back.svg"})}),s((h,u)=>{i({x:h,y:u},n)&&(n.p=!0,e(),f(()=>{n.p=!1},100))}),{render:()=>{d(),n.p||t(()=>{o()},n.x,n.y,-.5)},point:()=>({x:n.x,y:n.y,r:n.r})}},It=e=>{const{addEventResize:r,useMeasure:l,useTimer:f,addEventClick:s,intersect:i,rotate:t}=S();let n,d,o;return r(()=>{const{s:h}=l(),u=Math.round(h*.055);n={c:"#ff6347",r:u,x:Math.round(innerWidth-1.6*u),y:Math.round(innerHeight-1.6*u-2*u-.3*u),p:!1},d=R(n),o=L({x:Number(n.x)-u+Math.round(u*.4),y:Number(n.y)-u+Math.round(u*.4),w:u*2-Math.round(u*.8),src:"/media/back.svg"})}),s((h,u)=>{i({x:h,y:u},n)&&(n.p=!0,e(),f(()=>{n.p=!1},100))}),{render:()=>{d(),n.p||t(()=>{o()},n.x,n.y,.5)},point:()=>({x:n.x,y:n.y,r:n.r})}},Rt=e=>{const{ctx:r,shade:l}=S(),f=Math.round(e.r/2.2),s=Math.round(.15*e.r),i=l(e.c||"blue",-3);return(t=r)=>{const{r:n,x:d=n,y:o=n}=e;t.lineCap="round",t.fillStyle=i,t.strokeStyle=i,t.lineWidth=f,t.beginPath(),t.moveTo(d+s,o),t.lineTo(d-s/2,o-s),t.lineTo(d-s/2,o+s),t.closePath(),t.fill(),t.beginPath(),t.moveTo(d+s,o),t.lineTo(d-s/2,o-s),t.moveTo(d-s/2,o-s),t.lineTo(d-s/2,o+s),t.moveTo(d-s/2,o+s),t.lineTo(d+s,o),t.stroke()}},ot=({getX:e,getY:r})=>{const{addEventResize:l,useMeasure:f,useTimer:s,useScreenMeta:i,navigate:t,addEventClick:n,intersect:d}=S(),{from:o}=i();let c,a,h;return l(()=>{const{cx:g,cy:m,s:M,m:E}=f();c={c:"#bef181",r:Math.round(M*.1),x:e(g,M,E),y:r(m,M,E),p:(o==="gamescore"||o==="game"||o==="opening")&&!c},a=R(c),h=Rt(c)}),s(()=>{c.p=!1}),n((g,m)=>{d({x:g,y:m},c)&&(c.p=!0,s(()=>{t("game")},100))}),{render:()=>{a(),c.p||h()},point:()=>({x:c.x,y:c.y,r:c.r})}},rt=e=>{const{ctx:r,shade:l}=S(),f=Math.round(e.r/4),s=Math.round(.12*e.r);return(i=r)=>{const{r:t,x:n=t,y:d=t}=e,o=l(e.c||"blue",-3);i.lineCap="round",i.strokeStyle=o,i.lineWidth=f,i.beginPath(),i.moveTo(n-1.5*s,d-2*s),i.lineTo(n-1.5*s,d+2*s),i.stroke(),i.beginPath(),i.moveTo(n+1.5*s,d-2*s),i.lineTo(n+1.5*s,d+2*s),i.stroke()}},bt=({getX:e,getY:r})=>{const{addEventResize:l,useMeasure:f,useTimer:s,useScreenMeta:i,navigate:t,addEventClick:n,intersect:d}=S(),{from:o}=i();let c,a,h;return l(()=>{const{cx:g,cy:m,s:M,m:E}=f();c={c:"#fd8059",r:Math.round(M*.08),x:e(g,M,E),y:r(m,M,E),p:(o==="game"||o==="opening")&&!c},a=R(c),h=rt(c)}),s(()=>{c.p=!1}),n((g,m)=>{d({x:g,y:m},c)&&(c.p=!0,s(()=>{t("main")},100))}),{render:()=>{a(),c.p||h()},point:()=>({x:c.x,y:c.y,r:c.r})}},J=e=>{const{font:r,ctx:l}=S();return(f=l)=>{const{text:s,x:i,c:t,y:n,fs:d,a:o="center",mw:c}=e;f.textAlign=o,f.fillStyle=t,f.font=`${d}px ${r}`,f.fillText(s,i,n,c)}},Tt=()=>{const{addEventResize:e,useMeasure:r,useTimer:l,useScreenMeta:f,addEventClick:s,intersect:i,navigate:t}=S(),{from:n}=f();let d,o,c,a;return e(()=>{const{cx:p,cy:g,s:m}=r(),M=Math.round(m*.25);d={c:"#f86a9a",x:p,y:g,r:M,p:n==="opening"&&!d},o=R(d),c=J({text:"Yola",c:"#f1f1f1",x:p,y:g-M+Math.round(M*.9),fs:Math.round(M/2.6),mw:M*2}),a=J({text:"PopiT",c:"#ffeb3b",x:p,y:g-M+Math.round(M*1.3),fs:Math.round(M/2.3),mw:M*2})}),l(()=>d.p=!1),s((p,g)=>{i({x:p,y:g},d)&&(d.p=!0,l(()=>{t("opening")},100))}),{render:()=>{o(),d.p||(c(),a())},point:()=>({x:d.x,y:d.y,r:d.r})}},st=({color:e="#00dcfe",frequency:r=25})=>{const{addEventResize:l,useRandChain:f,useMeasure:s,rand:i,useTimer:t,setBackground:n,useScreenMeta:d}=S(),{from:o}=d();n(e);const c=i(0,999);let a=[],h=[];l(()=>{const m=f(c),{s:M}=s();a=[];const E=Math.round(M*.05),w=Math.round(innerWidth/E/2)-1,v=Math.round((innerWidth-2*E*w)/(w+1)),x=Math.round(innerHeight/E/2)-1,y=Math.round((innerHeight-2*E*x)/(x+1));for(let P=0;P<x;P++)for(let C=0;C<w;C++)m(m(r))<1&&a.push({x:v+E+C*E*2+v*C,y:y+E+P*E*2+y*P,r:E,c:e,p:o==="opening"?!0:m(1)>0});h=a.map(P=>R(P))});const u=()=>{t(()=>{const m=i(a.length-1);a[m]&&(a[m].p=!a[m].p),u()},750)};return o==="opening"?t(()=>{a.forEach(m=>m.p=i(1)>0),u()}):u(),{render:()=>{h.forEach(m=>m())},setIntersections:m=>{a=a.filter(({x:M,y:E,r:w})=>m(M,E,w)),h=a.map(M=>R(M))}}},Q="ylp",Z="score",tt="difficulty",Y=[.14,.11,.09,.075],et=750,Wt=350,nt=5,D=[];for(let e=0;e*nt<=et-Wt;e++)D.push(et-e*nt);const z=()=>{const e=a=>localStorage.getItem(`${Q}_${a}`),r=(a,h)=>localStorage.setItem(`${Q}_${a}`,h.toString()),l=()=>+(e(Z)||0),f=a=>r(Z,a),s=a=>{const h=l();f(h+a)},i=()=>+(e(tt)||0),t=a=>{const h=i();r(tt,Math.min(Math.max(h+a,0),Y.length*D.length-1))};return{getScore:l,addScore:s,plusDifficulty:()=>t(1),minusDifficulty:()=>t(-1),getDifficultyRad:()=>{const a=i(),h=Math.floor(a/D.length);return Y[h]||Y[1]},getDifficultyTic:()=>{const a=i(),h=Math.floor(a/D.length),u=a-h*D.length;return D[u]||D[0]}}},it=(e=!1)=>{let r=["#f86a9a","#C69FEE","#5bb2f7","#92E6E6","#7ceab2","#bef181","#EFCD74","#fd8059"];const{addEventResize:l,useMeasure:f,setBackground:s,rand:i}=S(),{getDifficultyRad:t}=z();return r=[...r.splice(i(r.length-1),r.length),...r],e||l(()=>{const{s:d}=f(),o=t(),c=Math.round(d*o),a=Math.round(innerWidth/c/2)-1,h=(innerWidth-2*c*a)/(a+1),u=Math.round(innerHeight/c/2)-1,p=(innerHeight-2*c*u)/(u+1),g=innerWidth>=innerHeight,m=g?a:u,M=g?h:p,E=g?innerWidth:innerHeight;let w=0;const v=[];for(let y=0;y<m;y++)r[w]||(w=0),v.push(`${r[w]} ${(M+c+y*c*2+M*y)/E*100}%`),w++;s(`linear-gradient(${g?"to right":"to bottom"}, ${v.join(", ")})`,innerWidth<innerHeight?r[0]:"#040404")}),r},ct=({palette:e,retry:r})=>{const{addEventResize:l,useMeasure:f,rand:s,useTimer:i,useScreenMeta:t,navigate:n,addEventClick:d,intersect:o}=S(),{from:c}=t(),{getDifficultyRad:a}=z(),h=[];let u=[],p,g,m,M;const E=v=>Array.isArray(e)?e[v]:e;return l(()=>{const{s:v}=f();h.splice(0);const x=a(),y=Math.round(v*x),P=Math.round(innerWidth/y/2)-1,C=(innerWidth-2*y*P)/(P+1),I=Math.round(innerHeight/y/2)-1,T=(innerHeight-2*y*I)/(I+1),A=innerWidth>=innerHeight;let b=0;for(let W=0;W<I;W++){for(let _=0;_<P;_++){E(b)||(b=0);const U={x:C+y+_*y*2+C*_,y:T+y+W*y*2+T*W,r:y,c:E(b),p:!0};W===0&&_===P-1?(M={...U,p:(c==="main"||c==="gameover"||c==="gamescore")&&!M},p=R(M),g=rt(M)):h.push(U),b+=A?1:0}b=A?0:b+1}r&&(m=h[s(h.length-1)],i(()=>{m.p=!1})),u=h.map(W=>R(W))}),i(()=>{M.p=!1}),r&&d((v,x)=>{o({x:v,y:x},m)&&(m.p=!0,i(()=>{n("game")},100))}),d((v,x)=>{o({x:v,y:x},M)&&(M.p=!0,i(()=>{n("main")},100))}),{render:()=>{u.forEach(v=>v()),p(),M!=null&&M.p||g()},popits:h}},H=100,X=2,F="#222",Ht=e=>{const r=(e==null?void 0:e[0])||0,l=(e==null?void 0:e[1])||0,f=(e==null?void 0:e[2])||0;return"#"+(16777216+(r<255?r<1?0:r:255)*65536+(l<255?l<1?0:l:255)*256+(f<255?f<1?0:f:255)).toString(16).slice(1)},j={},Dt=e=>{const{ctx:r,shade:l,createImg:f,useRandChain:s}=S();let i;j[e.imgSrc]?i=j[e.imgSrc]:(i=j[e.imgSrc]={img:new Image,cols:[],isFilled:!1,r:e.r,drawImg:null,score:e.score},i.img.src=e.imgSrc);const t=(c,a=r)=>{const{x:h,y:u,c:p,r:g,p:m}=c;m?(a.fillStyle=l(p,5),a.beginPath(),a.arc(h+g,u+g,g,0,Math.PI*2),a.closePath(),a.fill()):(a.fillStyle=p,a.beginPath(),a.arc(h+g,u+g,g+1,0,Math.PI*2),a.closePath(),a.fill())},n=()=>{const c=[],a=(e.r*2-2*X)/H;for(let g=0;g<H;g++)for(let m=0;m<H;m++){const M={x:X+m*a,y:X+g*a,r:a/2,c:F};c.push(M)}let h=e.score;const u=[...c],p=s(0);for(let g=h;g>0;g--){const m=p(u.length-1),M=u[m],E=c.indexOf(M);M.c=i.cols[E],u.splice(m,1)}return c},d=()=>{const c=n();i.drawImg=f((a=r)=>{c.filter(h=>h.c===F).forEach(h=>t(h,a)),c.filter(h=>h.c!==F).forEach(h=>t(h,a)),c.filter(h=>h.c!==F).forEach(h=>t({...h,p:!0},a))},2*e.r)},o=async()=>{var h;const c=document.createElement("canvas");c.width=H,c.height=H;const a=c.getContext("2d",{willReadFrequently:!0});a==null||a.drawImage(i.img,0,0);for(let u=0;u<H;u++){const p=[];for(let g=0;g<H;g++){const m=(h=a==null?void 0:a.getImageData(g,u,1,1))==null?void 0:h.data;p.push(Ht(m))}i.cols.push(...p)}i.isFilled=!0,d()};return i.isFilled?(i.r!==e.r||i.score!==e.score)&&d():i.img.onload=o,(c=r)=>{const{x:a,y:h,r:u}=e;i.drawImg&&c.drawImage(i.drawImg,a-u,h-u,2*u,2*u)}},q=1e4,at=()=>{const{addEventResize:e,useMeasure:r,translate:l}=S(),{getScore:f}=z(),s=["/media/cat.png"],i=f();let t,n=0,d=0,o=Math.floor(i/q);return e(()=>{const{cx:p,cy:g,s:m}=r();t=[],n=(m-2*m*.055*1.6)/2,d=m*.05;for(let M=0;M<s.length;M++){const E=s[M];t.push(Dt({x:p,y:g+M*n*2+M*d,r:n,score:i-M*q<0?0:i-M*q,imgSrc:E}))}}),{up:()=>{o=o+1<s.length?o+1:s.length-1},down:()=>{o=o-1<0?0:o-1},render:()=>{l(()=>{t==null||t.forEach(p=>p())},0,-(o*n*2+o*d))},rect:()=>{const{cx:p,cy:g}=r(),m=innerWidth>innerHeight;return{x:m?p-n:0,y:m?0:g-n,w:m?2*n:innerWidth,h:m?innerHeight:2*n}}}},kt=e=>{const{useTimer:r,rand:l,addEventClick:f,addEventMove:s,intersect:i,navigate:t}=S(),{addScore:n,getDifficultyTic:d}=z();let o=[],c,a,h=!1,u=0,p=0,g=0;const m=d(),M=()=>{const y=e.filter(I=>o.indexOf(I)===-1),P=l(y.length-1),C=y[P];C&&(C.p=!1,o.push(y[P]))},E=()=>{a=r(()=>{if(g=Math.max(g-10,250),e.length===o.length){h=!0,a.stop(),r(()=>{t("gameover")});return}M(),E()},g)},w=y=>{o=[];const P=e.length;let C=l(Math.round(P*.3),Math.round(P*.6));const I=[...e];if(y){const T=I.indexOf(y);I.splice(T,1)}for(let T=C;T>0;T--){const A=l(I.length-1),b=I[A];b.p=!1,o.push(b),I.splice(A,1)}g=m,c==null||c.stop(),a==null||a.stop(),c=r(E,o.length*Math.min(m,500)),u=u>0?u:l(3,5)},v=y=>{g=Math.min(g+5,m),p++,y.p=!0;const P=o.indexOf(y);o.splice(P,1),o.length<=0&&(u--,u>0?w(y):(n(p),t("gamescore")))},x=(y,P,C=!1)=>{if(!h){for(const I of o)if(i({x:y,y:P},I)){v(I);return}C||M()}};f(x),s((y,P)=>x(y,P,!0)),r(()=>{w()})},zt=()=>{const{addEventResize:e}=S(),{render:r,setIntersections:l}=st({}),{render:f,point:s}=Tt(),{render:i,point:t}=ot({getX:(o,c,a)=>o+Math.round(c*.25)+2*a,getY:(o,c,a)=>o+Math.round(c*.25)+0*a}),{render:n,point:d}=xt();return e(()=>{const o=d(),c=s(),a=t();l((h,u,p)=>!k({x:h,y:u,r:p},o)&&!k({x:h,y:u,r:p},c)&&!k({x:h,y:u,r:p},a))}),()=>{r(),f(),i(),n()}},At=()=>{const e=it(),{popits:r,render:l}=ct({palette:e});return kt(r),()=>{l()}},_t=()=>{const e="#ff6347",{setBackground:r}=S(),{minusDifficulty:l}=z(),{render:f}=ct({palette:e,retry:!0});return r(e),l(),()=>{f()}},Lt=()=>{const{translate:e}=S(),{plusDifficulty:r}=z();it();const{render:l}=at(),{render:f}=ot({getX:(i,t,n)=>innerWidth>innerHeight?Math.min(i+(t-2*t*.055*1.6)/2+4*n+Math.round(t*.1),innerWidth-2*n-Math.round(t*.1)):i+(t-2*t*.055*1.6)/8+0*Math.round(t*.1)+2*n,getY:(i,t,n)=>innerWidth>innerHeight?i+(t-2*t*.055*1.6)/2+0*n-Math.round(t*.1):Math.min(i+(t-2*t*.055*1.6)/2+4*n+Math.round(t*.1),innerHeight-2*n-Math.round(t*.1))}),{render:s}=bt({getX:(i,t,n)=>innerWidth>innerHeight?Math.max(i-(t-2*t*.055*1.6)/2-4*n-Math.round(t*.1),2*n+Math.round(t*.1)):i+(t-2*t*.055*1.6)/8-2*Math.round(t*.1)-2*n,getY:(i,t,n)=>innerWidth>innerHeight?i-(t-2*t*.055*1.6)/2+0*n+Math.round(t*.1):Math.min(i+(t-2*t*.055*1.6)/2+4*n+Math.round(t*.1),innerHeight-2*n-Math.round(t*.1))});return r(),()=>{innerHeight>innerWidth?e(l,0,-Math.round(innerHeight*.07)):l(),f(),s()}},Ft=()=>{const{addEventResize:e}=S(),{render:r,setIntersections:l}=st({color:"#ffeb3b",frequency:10}),{render:f,rect:s,up:i,down:t}=at(),{render:n,point:d}=wt(),{point:o}=Ct(i),{point:c}=It(t);return e(()=>{const a=d(),h=s(),u=o(),p=c();l((g,m,M)=>!k({x:g,y:m,r:M},a)&&!vt({x:g,y:m,r:M},h)&&!k({x:g,y:m,r:M},u)&&!k({x:g,y:m,r:M},p))}),()=>{r(),f(),n()}},$t=()=>{const{ctx:e,addEventResize:r,loop:l}=S(),f={x:40,y:100};let s=1,i=1,t;const n=()=>{t=5*Math.ceil(Math.sqrt(innerWidth*innerWidth+innerHeight*innerHeight)/144)};return n(),r(n),l(()=>{f.x+=2*s,f.y+=3*i,s*=-1,i*=-1}),()=>{e.save();var d=Math.random()*2,o=Math.random()*3;e.translate(d,o),e.beginPath(),e.fillStyle="red",e.rect(f.x,f.y,t,t),e.fill(),e.restore()}},Ot=[{name:"opening",ctor:St},{name:"main",ctor:zt},{name:"game",ctor:At},{name:"gameover",ctor:_t},{name:"gamescore",ctor:Lt},{name:"score",ctor:Ft},{name:"devs",ctor:$t}];Pt(Ot);document.title="Your's last Pop it";
