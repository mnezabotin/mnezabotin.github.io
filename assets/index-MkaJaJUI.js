(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))h(s);new MutationObserver(s=>{for(const c of s)if(c.type==="childList")for(const r of c.addedNodes)r.tagName==="LINK"&&r.rel==="modulepreload"&&h(r)}).observe(document,{childList:!0,subtree:!0});function a(s){const c={};return s.integrity&&(c.integrity=s.integrity),s.referrerPolicy&&(c.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?c.credentials="include":s.crossOrigin==="anonymous"?c.credentials="omit":c.credentials="same-origin",c}function h(s){if(s.ep)return;s.ep=!0;const c=a(s);fetch(s.href,c)}})();const st=()=>{const t=document.createElement("canvas"),n=t.getContext("2d");if(!n)throw new Error("CanvasRenderingContext2D is null");const a=()=>{t.width=innerWidth*devicePixelRatio,t.height=innerHeight*devicePixelRatio,n.scale(devicePixelRatio,devicePixelRatio)},h=e=>{n.clearRect(0,0,innerWidth,innerHeight),e()};return a(),document.body.appendChild(t),{ctx:n,render:h,resize:a,rotate:(e,f,d,u)=>{n.save(),n.translate(f,d),n.rotate(Math.PI*u),n.translate(-f,-d),e(),n.restore()},translate:(e,f,d)=>{n.save(),n.translate(f,d),e(),n.restore()},shade:(e,f)=>{e=e.substring(1);const d=parseInt(e,16),u=Math.round(2.55*f),l=(d>>16)+u,p=(d>>8&255)+u,m=(d&255)+u;return"#"+(16777216+(l<255?l<1?0:l:255)*65536+(p<255?p<1?0:p:255)*256+(m<255?m<1?0:m:255)).toString(16).slice(1)},setBackground:(e,f)=>{var d;document.body.style.background=e,document.body.style.backgroundColor=f||e,(d=document.querySelector('meta[name="theme-color"]'))==null||d.setAttribute("content",f||e)},createImg:(e,f,d=f)=>{const u=document.createElement("canvas"),l=u.getContext("2d");if(!l)throw new Error("CanvasRenderingContext2D is null");return u.width=f*devicePixelRatio,u.height=d*devicePixelRatio,l.scale(devicePixelRatio,devicePixelRatio),e(l),u}}},ct=t=>{let n="",a="",h;const s=o=>t.find(i=>i.name===o)||t[0],r={render:()=>{},navigate:(o,i)=>{const e=s(o);a=n||"",n=(e==null?void 0:e.name)||"",h=i,r.render=(e==null?void 0:e.ctor())||(()=>{})},useScreenMeta:()=>({to:n,from:a,data:h})};return r},it=()=>{const t=requestAnimationFrame||(r=>setTimeout(r,16.666666666666668)),n=[],a={};return{loop:(r,o)=>{if(Object.entries(a).find(([e,f])=>f===r)||o&&a[o])throw new Error(`Loop${o?" "+o:""} already specified`);o&&n.push(o),o=o||new Date().valueOf().toString(),a[o]=r;const i=()=>{r(),a[o]&&t(i)};i()},stop:r=>{if(typeof r=="string")delete a[r];else{const o=Object.entries(a).find(([i,e])=>e===r);o&&delete a[o[0]]}},stopAll:()=>{for(const r in a)n.indexOf(r)===-1&&delete a[r]}}};let _=[];const at=()=>{for(const t of _)clearTimeout(t);_=[]},dt=(t,n=400)=>{let a=new Date,h=n,s=setTimeout(t,h);return _.push(s),{pause:()=>{clearTimeout(s),h-=new Date-a},resume:()=>{a=new Date,clearTimeout(s),s=setTimeout(t,h),_.push(s)},stop:()=>{clearTimeout(s)}}},X=2147483646,$=2147483647,lt=16807,ut=(t=Math.floor(Math.random()*$))=>{t=t%$,t<=0&&(t+=X);const n=()=>(t=t*lt%$,t),a=()=>(n()-1)/X;return(s,c)=>(c===void 0&&(c=s,s=0),Math.floor(a()*(c-s+1))+s)},ft=(t,n)=>(n===void 0&&(n=t,t=0),Math.floor(Math.random()*(n-t+1))+t),ht=()=>{const t=[],n=[],a=[];return{addEventResize:f=>{f(),t.push(f)},onResizeEvents:()=>t.forEach(f=>f()),addEventClick:f=>n.push(f),onClickEvents:(f,d)=>n.forEach(u=>u(f,d)),addEventMove:f=>a.push(f),onMoveEvents:(f,d)=>a.forEach(u=>u(f,d)),removeAllEvents:()=>{t.splice(0),n.splice(0),a.splice(0)}}},D=(t,n)=>{const a=Math.pow(Math.abs(t.x-n.x),2),h=Math.pow(Math.abs(t.y-n.y),2),s=t.r||0,c=n.r||0,r=Math.pow(s+c,2);return a+h<=r},pt=(t,n)=>{const a=t.r||0,h=n.w||0,s=n.h||0;return Math.abs(n.x+h/2-t.x)<=h/2+a&&Math.abs(n.y+s/2-t.y)<=s/2+a},gt=(t,n)=>D(t,n),mt=t=>{const n={},a=s=>{const c=s.split("/");return c[c.length-1].split(".")[0]};return(()=>{for(const s of t){const c=new Audio(s);c.volume=.25,c.addEventListener("ended",function(){this.currentTime=0});const r=a(s);n[r]={audio:c,path:s}}})(),s=>{var i,e;const c=(i=n[s])==null?void 0:i.audio,r=(e=n[s])==null?void 0:e.path;if(!(!c||!r))if(c.currentTime===0)c.play();else{var o=new Audio(r);o.volume=.25,o.play()}}};let O;const vt=(t,n)=>{if(O)throw new Error("Webcore already specified");const a=st(),h=ct(t),{loop:s,stop:c,stopAll:r}=it(),{addEventResize:o,onResizeEvents:i,addEventClick:e,onClickEvents:f,addEventMove:d,onMoveEvents:u,removeAllEvents:l}=ht();let p=innerWidth/2,m=innerHeight/2,g=innerWidth<innerHeight?innerWidth:innerHeight,v=Math.ceil(Math.sqrt(innerWidth*innerWidth+innerHeight*innerHeight)/144);const E=()=>({cx:p,cy:m,s:g,m:v}),x=mt([]);O={font:"Tijuf",ctx:a.ctx,shade:a.shade,rotate:a.rotate,translate:a.translate,setBackground:a.setBackground,createImg:a.createImg,useMeasure:E,useScreenMeta:h.useScreenMeta,navigate:(M,y)=>{if(!t.some(S=>S.name===M))throw new Error(`Screen ${M} not specified`);r(),at(),l(),new Promise(()=>h.navigate(M,y))},loop:s,loopStop:c,useTimer:dt,rand:ft,useRandChain:ut,intersect:gt,addEventResize:o,addEventClick:e,addEventMove:d,playAudio:x},s(()=>a.render(h.render),"draw"),window.onresize=()=>{p=innerWidth/2,m=innerHeight/2,g=innerWidth<innerHeight?innerWidth:innerHeight,v=Math.ceil(Math.sqrt(innerWidth*innerWidth+innerHeight*innerHeight)/144),a.resize(),i()},document.onpointerdown=M=>{f(M.clientX,M.clientY)},document.onmousemove=M=>{u(M.clientX,M.clientY)},h.navigate()},w=()=>{if(!O)throw new Error("Webcore not specified");return{...O}},B={},I=t=>{const{shade:n,ctx:a,createImg:h}=w(),s=()=>{const{r,c:o="#ffffff",p:i}=t,e=a.createRadialGradient(r,r,r,r,r,r/5);return e.addColorStop(0,n(o,0)),e.addColorStop(.01,n(o,0)),e.addColorStop(.075,n(o,9)),e.addColorStop(.15,n(o,0)),e.addColorStop(.15,n(o,-15)),e.addColorStop(.18,n(o,-5)),e.addColorStop(.22,n(o,-15)),i?(e.addColorStop(.24,n(o,-10)),e.addColorStop(.3,n(o,-8)),e.addColorStop(.34,n(o,-12)),e.addColorStop(.6,n(o,-6)),e.addColorStop(1,n(o,-4))):(e.addColorStop(.24,n(o,-12)),e.addColorStop(.26,n(o,-8)),e.addColorStop(.3,n(o,-2)),e.addColorStop(.34,n(o,0)),e.addColorStop(.5,n(o,5)),e.addColorStop(1,n(o,10))),e},c=()=>{const{r,c:o="#ffffff",p:i}=t,e=`${o}_${i?"push":"pop"}_${r}`;if(B[e])return B[e];const f=h((d=a)=>{const u=s();d.fillStyle=u,d.beginPath(),d.arc(r,r,r,0,2*Math.PI),d.closePath(),d.fill()},2*r);return B[e]=f,f};return(r=a)=>{const{x:o,y:i,r:e}=t,f=c();r.drawImage(f,o-e,i-e,2*e,2*e)}},N={},L=t=>{const{ctx:n}=w();let a;return N[t.src]?a=N[t.src]:(a=new Image,a.src=t.src,N[t.src]=a),(h=n)=>{const{w:s,h:c=s,x:r=0,y:o=0}=t;a.complete&&h.drawImage(a,r,o,s,c)}},K=t=>{const{font:n,ctx:a}=w(),h=t.text,s=t.text.length,c=2*Math.PI/s/4;return(r=a)=>{const{x:o,y:i,r:e,s:f=0,fs:d}=t,u=d||Math.round(e/4);r.textAlign="center",r.fillStyle="#f9f9f9",r.font=`${u}px ${n}`,r.save(),r.translate(o,i),r.rotate(f);for(let l=0;l<s;l++)r.save(),r.rotate(l*c),r.fillText(h[l],0,-e),r.restore();r.restore()}},Mt=()=>{var E,x;const{ctx:t,loop:n,rotate:a,navigate:h,useMeasure:s,addEventClick:c,addEventResize:r,setBackground:o}=w();o("#040404");let i=!1,e,f,d,u,l,p=-.2,m=0;r(()=>{const{cx:M,cy:y,s:S}=s(),P=Math.round(S*.25);e={c:"#ff6347",x:M,y,r:P,p:!1},f=I(e),d=L({x:M-P+Math.round(P*.35),y:y-P+Math.round(P*.35),w:P*2-Math.round(P*.7),src:"/media/sloth.svg"}),u=K({text:"nezabotin",x:M,y,r:Math.round(P*1.1),s:Math.PI*1.6}),l=K({text:"production",x:M,y,r:Math.round(P*1.1),s:Math.PI*2.6})});const g=()=>{p+=.01,m=p>=1?1:p,p>=1.8&&(e.p=!0),p>=2.2&&(e.c="#f86a9a"),p>=2.6&&h("main")};c(()=>{[1.4,1.8,2.2,2.6].some(M=>{if(p<M)return p=M,!0})});const v=()=>{n(g),i=!0};return(E=document==null?void 0:document.fonts)!=null&&E.ready?(x=document==null?void 0:document.fonts)==null||x.ready.then(v):v(),()=>{const{cx:M,cy:y}=s();t.globalAlpha=i?1:0,f(),p<1.8&&d(),p<1.4&&a(()=>{u(),l()},M,y,m),t.globalAlpha=1}},yt=()=>{const{addEventResize:t,useMeasure:n,useTimer:a,useScreenMeta:h,navigate:s,addEventClick:c,intersect:r}=w(),{from:o}=h();let i,e,f;return t(()=>{const{cx:l,cy:p,s:m,m:g}=n(),v=Math.round(m*.25);i={c:"#ba68c8",r:Math.round(m*.08),x:l-v-1*g,y:p-v+1*g,p:(o==="score"||o==="opening")&&!i},e=I(i),f=L({x:Number(i.x)-i.r+Math.round(i.r*.5),y:Number(i.y)-i.r+Math.round(i.r*.5),w:i.r*2-Math.round(i.r*1),src:"/media/star.svg"})}),a(()=>{i.p=!1}),c((l,p)=>{r({x:l,y:p},i)&&(i.p=!0,a(()=>{s("score")},100))}),{render:()=>{e(),i.p||f()},point:()=>({x:i.x,y:i.y,r:i.r})}},Et=()=>{const{addEventResize:t,useMeasure:n,useTimer:a,useScreenMeta:h,navigate:s,addEventClick:c,intersect:r}=w(),{from:o}=h();let i,e,f;return t(()=>{const{s:l}=n(),p=Math.round(l*.08);i={c:"#ff6347",r:p,x:Math.round(1.6*p),y:Math.round(1.6*p),p:o==="main"&&!i},e=I(i),f=L({x:Number(i.x)-p+Math.round(p*.4),y:Number(i.y)-p+Math.round(p*.4),w:p*2-Math.round(p*.8),src:"/media/back.svg"})}),a(()=>{i.p=!1}),c((l,p)=>{r({x:l,y:p},i)&&(i.p=!0,a(()=>{s("main")},100))}),{render:()=>{e(),i.p||f()},point:()=>({x:i.x,y:i.y,r:i.r})}},Pt=t=>{const{addEventResize:n,useMeasure:a,useTimer:h,addEventClick:s,intersect:c,rotate:r}=w();let o,i,e;return n(()=>{const{s:u}=a(),l=Math.round(u*.055);o={c:"#ff6347",r:l,x:Math.round(innerWidth-1.6*l),y:Math.round(innerHeight-1.6*l),p:!1},i=I(o),e=L({x:Number(o.x)-l+Math.round(l*.4),y:Number(o.y)-l+Math.round(l*.4),w:l*2-Math.round(l*.8),src:"/media/back.svg"})}),s((u,l)=>{c({x:u,y:l},o)&&(o.p=!0,t(),h(()=>{o.p=!1},100))}),{render:()=>{i(),o.p||r(()=>{e()},o.x,o.y,-.5)},point:()=>({x:o.x,y:o.y,r:o.r})}},St=t=>{const{addEventResize:n,useMeasure:a,useTimer:h,addEventClick:s,intersect:c,rotate:r}=w();let o,i,e;return n(()=>{const{s:u}=a(),l=Math.round(u*.055);o={c:"#ff6347",r:l,x:Math.round(innerWidth-1.6*l),y:Math.round(innerHeight-1.6*l-2*l-.3*l),p:!1},i=I(o),e=L({x:Number(o.x)-l+Math.round(l*.4),y:Number(o.y)-l+Math.round(l*.4),w:l*2-Math.round(l*.8),src:"/media/back.svg"})}),s((u,l)=>{c({x:u,y:l},o)&&(o.p=!0,t(),h(()=>{o.p=!1},100))}),{render:()=>{i(),o.p||r(()=>{e()},o.x,o.y,.5)},point:()=>({x:o.x,y:o.y,r:o.r})}},wt=t=>{const{ctx:n,shade:a}=w(),h=Math.round(t.r/2.2),s=Math.round(.15*t.r),c=a(t.c||"blue",-3);return(r=n)=>{const{r:o,x:i=o,y:e=o}=t;r.lineCap="round",r.fillStyle=c,r.strokeStyle=c,r.lineWidth=h,r.beginPath(),r.moveTo(i+s,e),r.lineTo(i-s/2,e-s),r.lineTo(i-s/2,e+s),r.closePath(),r.fill(),r.beginPath(),r.moveTo(i+s,e),r.lineTo(i-s/2,e-s),r.moveTo(i-s/2,e-s),r.lineTo(i-s/2,e+s),r.moveTo(i-s/2,e+s),r.lineTo(i+s,e),r.stroke()}},xt=()=>{const{addEventResize:t,useMeasure:n,useTimer:a,useScreenMeta:h,navigate:s,addEventClick:c,intersect:r}=w(),{from:o}=h();let i,e,f;return t(()=>{const{cx:l,cy:p,s:m,m:g}=n(),v=Math.round(m*.25);i={c:"#bef181",r:Math.round(m*.1),x:l+v+2*g,y:p+v,p:(o==="game"||o==="opening")&&!i},e=I(i),f=wt(i)}),a(()=>{i.p=!1}),c((l,p)=>{r({x:l,y:p},i)&&(i.p=!0,a(()=>{s("game")},100))}),{render:()=>{e(),i.p||f()},point:()=>({x:i.x,y:i.y,r:i.r})}},J=t=>{const{font:n,ctx:a}=w();return(h=a)=>{const{text:s,x:c,c:r,y:o,fs:i,a:e="center",mw:f}=t;h.textAlign=e,h.fillStyle=r,h.font=`${i}px ${n}`,h.fillText(s,c,o,f)}},Ct=()=>{const{addEventResize:t,useMeasure:n,useTimer:a,useScreenMeta:h}=w(),{from:s}=h();let c,r,o,i;return t(()=>{const{cx:d,cy:u,s:l}=n(),p=Math.round(l*.25);c={c:"#f86a9a",x:d,y:u,r:p,p:s==="opening"&&!c},r=I(c),o=J({text:"Yola",c:"#f1f1f1",x:d,y:u-p+Math.round(p*.9),fs:Math.round(p/2.6),mw:p*2}),i=J({text:"PopiT",c:"#ffeb3b",x:d,y:u-p+Math.round(p*1.3),fs:Math.round(p/2.3),mw:p*2})}),a(()=>c.p=!1),{render:()=>{r(),c.p||(o(),i())},point:()=>({x:c.x,y:c.y,r:c.r})}},et=({color:t="#00dcfe",frequency:n=25})=>{const{addEventResize:a,useRandChain:h,useMeasure:s,rand:c,useTimer:r,setBackground:o,useScreenMeta:i}=w(),{from:e}=i();o(t);const f=c(0,999);let d=[],u=[];a(()=>{const g=h(f),{s:v}=s();d=[];const E=Math.round(v*.05),x=Math.round(innerWidth/E/2)-1,M=Math.round((innerWidth-2*E*x)/(x+1)),y=Math.round(innerHeight/E/2)-1,S=Math.round((innerHeight-2*E*y)/(y+1));for(let P=0;P<y;P++)for(let C=0;C<x;C++)g(g(n))<1&&d.push({x:M+E+C*E*2+M*C,y:S+E+P*E*2+S*P,r:E,c:t,p:e==="opening"?!0:g(1)>0});u=d.map(P=>I(P))});const l=()=>{r(()=>{const g=c(d.length-1);d[g]&&(d[g].p=!d[g].p),l()},750)};return e==="opening"?r(()=>{d.forEach(g=>g.p=c(1)>0),l()}):l(),{render:()=>{u.forEach(g=>g())},setIntersections:g=>{d=d.filter(({x:v,y:E,r:x})=>g(v,E,x)),u=d.map(v=>I(v))}}},Q="ylp",Z="score",tt="difficulty",b=[1e3,800,500,400,350],G=[.15,.14,.11,.09,.075],z=()=>{const t=d=>localStorage.getItem(`${Q}_${d}`),n=(d,u)=>localStorage.setItem(`${Q}_${d}`,u.toString()),a=()=>+(t(Z)||0),h=d=>n(Z,d),s=d=>{const u=a();h(u+d)},c=()=>+(t(tt)||b.length),r=d=>{const u=c();n(tt,Math.min(Math.max(u+d,0),G.length*b.length-1))};return{getScore:a,addScore:s,plusDifficulty:()=>r(1),minusDifficulty:()=>r(-1),getDifficultyRad:()=>{const d=c(),u=Math.floor(d/b.length);return G[u]||G[1]},getDifficultyTic:()=>{const d=c(),u=Math.floor(d/b.length),l=d-u*b.length;return b[l]||b[0]}}},nt=(t=!1)=>{const n=["#f86a9a","#C69FEE","#5bb2f7","#92E6E6","#7ceab2","#bef181","#EFCD74","#fd8059"],{addEventResize:a,useMeasure:h,setBackground:s}=w(),{getDifficultyRad:c}=z();return t||a(()=>{const{s:o}=h(),i=c(),e=Math.round(o*i),f=Math.round(innerWidth/e/2)-1,d=(innerWidth-2*e*f)/(f+1),u=Math.round(innerHeight/e/2)-1,l=(innerHeight-2*e*u)/(u+1),p=innerWidth>=innerHeight,m=p?f:u,g=p?d:l,v=p?innerWidth:innerHeight;let E=0;const x=[];for(let y=0;y<m;y++)n[E]||(E=0),x.push(`${n[E]} ${(g+e+y*e*2+g*y)/v*100}%`),E++;s(`linear-gradient(${p?"to right":"to bottom"}, ${x.join(", ")})`,n[0])}),n},It=t=>{const{ctx:n,shade:a}=w(),h=Math.round(t.r/4),s=Math.round(.12*t.r);return(c=n)=>{const{r,x:o=r,y:i=r}=t,e=a(t.c||"blue",-3);c.lineCap="round",c.strokeStyle=e,c.lineWidth=h,c.beginPath(),c.moveTo(o-1.5*s,i-2*s),c.lineTo(o-1.5*s,i+2*s),c.stroke(),c.beginPath(),c.moveTo(o+1.5*s,i-2*s),c.lineTo(o+1.5*s,i+2*s),c.stroke()}},ot=({palette:t,retry:n})=>{const{addEventResize:a,useMeasure:h,rand:s,useTimer:c,useScreenMeta:r,navigate:o,addEventClick:i,intersect:e}=w(),{from:f}=r(),{getDifficultyRad:d}=z(),u=[];let l=[],p,m,g,v;const E=M=>Array.isArray(t)?t[M]:t;return a(()=>{const{s:M}=h();u.splice(0);const y=d(),S=Math.round(M*y),P=Math.round(innerWidth/S/2)-1,C=(innerWidth-2*S*P)/(P+1),W=Math.round(innerHeight/S/2)-1,A=(innerHeight-2*S*W)/(W+1),U=innerWidth>=innerHeight;let k=0;for(let R=0;R<W;R++){for(let H=0;H<P;H++){E(k)||(k=0);const V={x:C+S+H*S*2+C*H,y:A+S+R*S*2+A*R,r:S,c:E(k),p:!0};R===0&&H===P-1?(v={...V,p:(f==="main"||f==="gameover"||f==="gamescore")&&!v},p=I(v),m=It(v)):u.push(V),k+=U?1:0}k=U?0:k+1}n&&(g=u[s(u.length-1)],c(()=>{g.p=!1})),l=u.map(R=>I(R))}),c(()=>{v.p=!1}),n&&i((M,y)=>{e({x:M,y},g)&&(g.p=!0,c(()=>{o("game")},100))}),i((M,y)=>{e({x:M,y},v)&&(v.p=!0,c(()=>{o("main")},100))}),{render:()=>{l.forEach(M=>M()),p(),v!=null&&v.p||m()},popits:u}},T=100,Y=2,F="#222",Rt=t=>{const n=(t==null?void 0:t[0])||0,a=(t==null?void 0:t[1])||0,h=(t==null?void 0:t[2])||0;return"#"+(16777216+(n<255?n<1?0:n:255)*65536+(a<255?a<1?0:a:255)*256+(h<255?h<1?0:h:255)).toString(16).slice(1)},j={},bt=t=>{const{ctx:n,shade:a,createImg:h,useRandChain:s}=w();let c;j[t.imgSrc]?c=j[t.imgSrc]:(c=j[t.imgSrc]={img:new Image,cols:[],isFilled:!1,r:t.r,drawImg:null,score:t.score},c.img.src=t.imgSrc);const r=(f,d=n)=>{const{x:u,y:l,c:p,r:m,p:g}=f;g?(d.fillStyle=a(p,5),d.beginPath(),d.arc(u+m,l+m,m,0,Math.PI*2),d.closePath(),d.fill()):(d.fillStyle=p,d.beginPath(),d.arc(u+m,l+m,m+2,0,Math.PI*2),d.closePath(),d.fill())},o=()=>{const f=[],d=(t.r*2-2*Y)/T;for(let m=0;m<T;m++)for(let g=0;g<T;g++){const v={x:Y+g*d,y:Y+m*d,r:d/2,c:F};f.push(v)}let u=t.score;const l=[...f],p=s(0);for(let m=u;m>0;m--){const g=p(l.length-1),v=l[g],E=f.indexOf(v);v.c=c.cols[E],l.splice(g,1)}return f},i=()=>{const f=o();c.drawImg=h((d=n)=>{f.filter(u=>u.c===F).forEach(u=>r(u,d)),f.filter(u=>u.c!==F).forEach(u=>r(u,d)),f.filter(u=>u.c!==F).forEach(u=>r({...u,p:!0},d))},2*t.r)},e=async()=>{var u;const f=document.createElement("canvas");f.width=T,f.height=T;const d=f.getContext("2d",{willReadFrequently:!0});d==null||d.drawImage(c.img,0,0);for(let l=0;l<T;l++){const p=[];for(let m=0;m<T;m++){const g=(u=d==null?void 0:d.getImageData(m,l,1,1))==null?void 0:u.data;p.push(Rt(g))}c.cols.push(...p)}c.isFilled=!0,i()};return c.isFilled?(c.r!==t.r||c.score!==t.score)&&i():c.img.onload=e,(f=n)=>{const{x:d,y:u,r:l}=t;c.drawImg&&f.drawImage(c.drawImg,d-l,u-l,2*l,2*l)}},q=1e4,rt=()=>{const{addEventResize:t,useMeasure:n,translate:a}=w(),{getScore:h}=z(),s=["/media/cat.png"],c=h();let r,o=0,i=0,e=Math.floor(c/q);return t(()=>{const{cx:p,cy:m,s:g}=n();r=[],o=(g-2*g*.055*1.6)/2,i=g*.05;for(let v=0;v<s.length;v++){const E=s[v];r.push(bt({x:p,y:m+v*o*2+v*i,r:o,score:c-v*q<0?0:c-v*q,imgSrc:E}))}}),{up:()=>{e=e+1<s.length?e+1:s.length-1},down:()=>{e=e-1<0?0:e-1},render:()=>{a(()=>{r==null||r.forEach(p=>p())},0,-(e*o*2+e*i))},rect:()=>{const{cx:p,cy:m}=n(),g=innerWidth>innerHeight;return{x:g?p-o:0,y:g?0:m-o,w:g?2*o:innerWidth,h:g?innerHeight:2*o}}}},Tt=t=>{const{useTimer:n,rand:a,addEventClick:h,addEventMove:s,intersect:c,navigate:r}=w(),{addScore:o,getDifficultyTic:i}=z();let e=[],f,d,u=!1,l=0,p=0;const m=i(),g=()=>{d=n(()=>{if(t.length===e.length){u=!0,d.stop(),n(()=>{r("gameover")});return}const M=t.filter(P=>e.indexOf(P)===-1),y=a(M.length-1),S=M[y];S&&(S.p=!1,e.push(M[y])),g()},m)},v=M=>{e=[];const y=t.length;let S=a(Math.round(y*.3),Math.round(y*.6));const P=[...t];if(M){const C=P.indexOf(M);P.splice(C,1)}for(let C=S;C>0;C--){const W=a(P.length-1),A=P[W];A.p=!1,e.push(A),P.splice(W,1)}f==null||f.stop(),d==null||d.stop(),f=n(g,e.length*m),l=l>0?l:a(3,5)},E=M=>{p++,M.p=!0;const y=e.indexOf(M);e.splice(y,1),e.length<=0&&(l--,l>0?v(M):(o(p),r("gamescore")))},x=(M,y)=>{if(!u)for(const S of e)c({x:M,y},S)&&E(S)};h(x),s(x),n(()=>{v()})},Dt=()=>{const{addEventResize:t}=w(),{render:n,setIntersections:a}=et({}),{render:h,point:s}=Ct(),{render:c,point:r}=xt(),{render:o,point:i}=yt();return t(()=>{const e=i(),f=s(),d=r();a((u,l,p)=>!D({x:u,y:l,r:p},e)&&!D({x:u,y:l,r:p},f)&&!D({x:u,y:l,r:p},d))}),()=>{n(),h(),c(),o()}},Wt=()=>{const t=nt(),{popits:n,render:a}=ot({palette:t});return Tt(n),()=>{a()}},kt=()=>{const t="#ff6347",{setBackground:n}=w(),{minusDifficulty:a}=z();a();const{render:h}=ot({palette:t,retry:!0});return n(t),()=>{h()}},zt=()=>{const{addEventClick:t,navigate:n}=w(),{plusDifficulty:a}=z();a(),nt();const{render:h}=rt();return t(()=>{n("game")}),()=>{h()}},At=()=>{const{addEventResize:t}=w(),{render:n,setIntersections:a}=et({color:"#ffeb3b",frequency:10}),{render:h,rect:s,up:c,down:r}=rt(),{render:o,point:i}=Et(),{point:e}=Pt(c),{point:f}=St(r);return t(()=>{const d=i(),u=s(),l=e(),p=f();a((m,g,v)=>!D({x:m,y:g,r:v},d)&&!pt({x:m,y:g,r:v},u)&&!D({x:m,y:g,r:v},l)&&!D({x:m,y:g,r:v},p))}),()=>{n(),h(),o()}},Ht=()=>{const{ctx:t,addEventResize:n,loop:a}=w(),h={x:40,y:100};let s=1,c=1,r;const o=()=>{r=5*Math.ceil(Math.sqrt(innerWidth*innerWidth+innerHeight*innerHeight)/144)};return o(),n(o),a(()=>{h.x+=2*s,h.y+=3*c,s*=-1,c*=-1}),()=>{t.save();var i=Math.random()*2,e=Math.random()*3;t.translate(i,e),t.beginPath(),t.fillStyle="red",t.rect(h.x,h.y,r,r),t.fill(),t.restore()}},Lt=[{name:"opening",ctor:Mt},{name:"main",ctor:Dt},{name:"game",ctor:Wt},{name:"gameover",ctor:kt},{name:"gamescore",ctor:zt},{name:"score",ctor:At},{name:"devs",ctor:Ht}];vt(Lt);document.title="Your's last Popit";
