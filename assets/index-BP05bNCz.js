(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))f(i);new MutationObserver(i=>{for(const c of i)if(c.type==="childList")for(const o of c.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&f(o)}).observe(document,{childList:!0,subtree:!0});function a(i){const c={};return i.integrity&&(c.integrity=i.integrity),i.referrerPolicy&&(c.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?c.credentials="include":i.crossOrigin==="anonymous"?c.credentials="omit":c.credentials="same-origin",c}function f(i){if(i.ep)return;i.ep=!0;const c=a(i);fetch(i.href,c)}})();const ct=()=>{const t=document.createElement("canvas"),e=t.getContext("2d");if(!e)throw new Error("CanvasRenderingContext2D is null");const a=()=>{t.width=innerWidth*devicePixelRatio,t.height=innerHeight*devicePixelRatio,e.scale(devicePixelRatio,devicePixelRatio),t.style.width=`${innerWidth}px`,t.style.height=`${innerHeight}px`},f=n=>{e.clearRect(0,0,innerWidth,innerHeight),n()};return a(),document.body.appendChild(t),{ctx:e,render:f,resize:a,rotate:(n,u,d,h)=>{e.save(),e.translate(u,d),e.rotate(Math.PI*h),e.translate(-u,-d),n(),e.restore()},translate:(n,u,d)=>{e.save(),e.translate(u,d),n(),e.restore()},shade:(n,u)=>{n=n.substring(1);const d=parseInt(n,16),h=Math.round(2.55*u),l=(d>>16)+h,p=(d>>8&255)+h,g=(d&255)+h;return"#"+(16777216+(l<255?l<1?0:l:255)*65536+(p<255?p<1?0:p:255)*256+(g<255?g<1?0:g:255)).toString(16).slice(1)},setBackground:(n,u)=>{var d;document.body.style.background=n,document.body.style.backgroundColor=u||n,(d=document.querySelector('meta[name="theme-color"]'))==null||d.setAttribute("content",u||n)},createImg:(n,u,d=u)=>{const h=document.createElement("canvas"),l=h.getContext("2d");if(!l)throw new Error("CanvasRenderingContext2D is null");return h.width=u*devicePixelRatio,h.height=d*devicePixelRatio,l.scale(devicePixelRatio,devicePixelRatio),n(l),h}}},at=t=>{let e="",a="",f;const i=r=>t.find(s=>s.name===r)||t[0],o={render:()=>{},navigate:(r,s)=>{const n=i(r);a=e||"",e=(n==null?void 0:n.name)||"",f=s,o.render=(n==null?void 0:n.ctor())||(()=>{})},useScreenMeta:()=>({to:e,from:a,data:f})};return o},dt=()=>{const t=requestAnimationFrame||(o=>setTimeout(o,16.666666666666668)),e=[],a={};return{loop:(o,r)=>{if(Object.entries(a).find(([n,u])=>u===o)||r&&a[r])throw new Error(`Loop${r?" "+r:""} already specified`);r&&e.push(r),r=r||new Date().valueOf().toString(),a[r]=o;const s=()=>{o(),a[r]&&t(s)};s()},stop:o=>{if(typeof o=="string")delete a[o];else{const r=Object.entries(a).find(([s,n])=>n===o);r&&delete a[r[0]]}},stopAll:()=>{for(const o in a)e.indexOf(o)===-1&&delete a[o]}}};let $=[];const lt=()=>{for(const t of $)clearTimeout(t);$=[]},ut=(t,e=400)=>{let a=new Date,f=e,i=setTimeout(t,f);return $.push(i),{pause:()=>{clearTimeout(i),f-=new Date-a},resume:()=>{a=new Date,clearTimeout(i),i=setTimeout(t,f),$.push(i)},stop:()=>{clearTimeout(i)}}},V=2147483646,B=2147483647,ht=16807,ft=(t=Math.floor(Math.random()*B))=>{t=t%B,t<=0&&(t+=V);const e=()=>(t=t*ht%B,t),a=()=>(e()-1)/V;return(i,c)=>(c===void 0&&(c=i,i=0),Math.floor(a()*(c-i+1))+i)},pt=(t,e)=>(e===void 0&&(e=t,t=0),Math.floor(Math.random()*(e-t+1))+t),gt=()=>{const t=[],e=[],a=[];return{addEventResize:u=>{u(),t.push(u)},onResizeEvents:()=>t.forEach(u=>u()),addEventClick:u=>e.push(u),onClickEvents:(u,d)=>e.forEach(h=>h(u,d)),addEventMove:u=>a.push(u),onMoveEvents:(u,d)=>a.forEach(h=>h(u,d)),removeAllEvents:()=>{t.splice(0),e.splice(0),a.splice(0)}}},A=(t,e)=>{const a=Math.pow(Math.abs(t.x-e.x),2),f=Math.pow(Math.abs(t.y-e.y),2),i=t.r||0,c=e.r||0,o=Math.pow(i+c,2);return a+f<=o},mt=(t,e)=>{const a=t.r||0,f=e.w||0,i=e.h||0;return Math.abs(e.x+f/2-t.x)<=f/2+a&&Math.abs(e.y+i/2-t.y)<=i/2+a},Mt=(t,e)=>A(t,e),vt=t=>{const e={},a=i=>{const c=i.split("/");return c[c.length-1].split(".")[0]};return(()=>{for(const i of t){const c=new Audio(i);c.volume=.25,c.addEventListener("ended",function(){this.currentTime=0});const o=a(i);e[o]={audio:c,path:i}}})(),i=>{var s,n;const c=(s=e[i])==null?void 0:s.audio,o=(n=e[i])==null?void 0:n.path;if(!(!c||!o))if(c.currentTime===0)c.play();else{var r=new Audio(o);r.volume=.25,r.play()}}};let O;const yt=(t,e)=>{if(O)throw new Error("Webcore already specified");const a=ct(),f=at(t),{loop:i,stop:c,stopAll:o}=dt(),{addEventResize:r,onResizeEvents:s,addEventClick:n,onClickEvents:u,addEventMove:d,onMoveEvents:h,removeAllEvents:l}=gt();let p=innerWidth/2,g=innerHeight/2,M=innerWidth<innerHeight?innerWidth:innerHeight,m=Math.ceil(Math.sqrt(innerWidth*innerWidth+innerHeight*innerHeight)/144);const P=()=>({cx:p,cy:g,s:M,m}),x=vt([]);O={font:"Tijuf",ctx:a.ctx,shade:a.shade,rotate:a.rotate,translate:a.translate,setBackground:a.setBackground,createImg:a.createImg,useMeasure:P,useScreenMeta:f.useScreenMeta,navigate:(v,w)=>{if(!t.some(y=>y.name===v))throw new Error(`Screen ${v} not specified`);o(),lt(),l(),new Promise(()=>f.navigate(v,w))},loop:i,loopStop:c,useTimer:ut,rand:pt,useRandChain:ft,intersect:Mt,addEventResize:r,addEventClick:n,addEventMove:d,playAudio:x},i(()=>a.render(f.render),"draw"),window.onresize=()=>{p=innerWidth/2,g=innerHeight/2,M=innerWidth<innerHeight?innerWidth:innerHeight,m=Math.ceil(Math.sqrt(innerWidth*innerWidth+innerHeight*innerHeight)/144),a.resize(),s()},document.onpointerdown=v=>{u(v.clientX,v.clientY)},document.onmousemove=v=>{h(v.clientX,v.clientY)},f.navigate()},S=()=>{if(!O)throw new Error("Webcore not specified");return{...O}},N={},R=t=>{const{shade:e,ctx:a,createImg:f}=S(),i=()=>{const{r:o,c:r="#ffffff",p:s}=t,n=a.createRadialGradient(o,o,o,o,o,o/5);return n.addColorStop(0,e(r,0)),n.addColorStop(.01,e(r,0)),n.addColorStop(.075,e(r,9)),n.addColorStop(.15,e(r,0)),n.addColorStop(.15,e(r,-15)),n.addColorStop(.18,e(r,-5)),n.addColorStop(.22,e(r,-15)),s?(n.addColorStop(.24,e(r,-10)),n.addColorStop(.3,e(r,-8)),n.addColorStop(.34,e(r,-12)),n.addColorStop(.6,e(r,-6)),n.addColorStop(1,e(r,-4))):(n.addColorStop(.24,e(r,-12)),n.addColorStop(.26,e(r,-8)),n.addColorStop(.3,e(r,-2)),n.addColorStop(.34,e(r,0)),n.addColorStop(.5,e(r,5)),n.addColorStop(1,e(r,10))),n},c=()=>{const{r:o,c:r="#ffffff",p:s}=t,n=`${r}_${s?"push":"pop"}_${o}`;if(N[n])return N[n];const u=f((d=a)=>{const h=i();d.fillStyle=h,d.beginPath(),d.arc(o,o,o,0,2*Math.PI),d.closePath(),d.fill()},2*o);return N[n]=u,u};return(o=a)=>{const{x:r,y:s,r:n}=t,u=c();o.drawImage(u,r-n,s-n,2*n,2*n)}},G={},L=t=>{const{ctx:e}=S();let a;return G[t.src]?a=G[t.src]:(a=new Image,a.src=t.src,G[t.src]=a),(f=e)=>{const{w:i,h:c=i,x:o=0,y:r=0}=t;a.complete&&f.drawImage(a,o,r,i,c)}},K=t=>{const{font:e,ctx:a}=S(),f=t.text,i=t.text.length,c=2*Math.PI/i/4;return(o=a)=>{const{x:r,y:s,r:n,s:u=0,fs:d}=t,h=d||Math.round(n/4);o.textAlign="center",o.fillStyle="#f9f9f9",o.font=`${h}px ${e}`,o.save(),o.translate(r,s),o.rotate(u);for(let l=0;l<i;l++)o.save(),o.rotate(l*c),o.fillText(f[l],0,-n),o.restore();o.restore()}},Et=()=>{var P,x;const{ctx:t,loop:e,rotate:a,navigate:f,useMeasure:i,addEventClick:c,addEventResize:o,setBackground:r}=S();r("#040404");let s=!1,n,u,d,h,l,p=-.2,g=0;o(()=>{const{cx:v,cy:w,s:y}=i(),E=Math.round(y*.25);n={c:"#ff6347",x:v,y:w,r:E,p:!1},u=R(n),d=L({x:v-E+Math.round(E*.35),y:w-E+Math.round(E*.35),w:E*2-Math.round(E*.7),src:"/media/sloth.svg"}),h=K({text:"nezabotin",x:v,y:w,r:Math.round(E*1.1),s:Math.PI*1.6}),l=K({text:"production",x:v,y:w,r:Math.round(E*1.1),s:Math.PI*2.6})});const M=()=>{p+=.01,g=p>=1?1:p,p>=1.8&&(n.p=!0),p>=2.2&&(n.c="#f86a9a"),p>=2.6&&f("main")};c(()=>{[1.4,1.8,2.2,2.6].some(v=>{if(p<v)return p=v,!0})});const m=()=>{e(M),s=!0};return(P=document==null?void 0:document.fonts)!=null&&P.ready?(x=document==null?void 0:document.fonts)==null||x.ready.then(m):m(),()=>{const{cx:v,cy:w}=i();t.globalAlpha=s?1:0,u(),p<1.8&&d(),p<1.4&&a(()=>{h(),l()},v,w,g),t.globalAlpha=1}},Pt=()=>{const{addEventResize:t,useMeasure:e,useTimer:a,useScreenMeta:f,navigate:i,addEventClick:c,intersect:o}=S(),{from:r}=f();let s,n,u;return t(()=>{const{cx:l,cy:p,s:g,m:M}=e(),m=Math.round(g*.25);s={c:"#ba68c8",r:Math.round(g*.08),x:l-m-1*M,y:p-m+1*M,p:(r==="score"||r==="opening")&&!s},n=R(s),u=L({x:Number(s.x)-s.r+Math.round(s.r*.5),y:Number(s.y)-s.r+Math.round(s.r*.5),w:s.r*2-Math.round(s.r*1),src:"/media/star.svg"})}),a(()=>{s.p=!1}),c((l,p)=>{o({x:l,y:p},s)&&(s.p=!0,a(()=>{i("score")},100))}),{render:()=>{n(),s.p||u()},point:()=>({x:s.x,y:s.y,r:s.r})}},St=()=>{const{addEventResize:t,useMeasure:e,useTimer:a,useScreenMeta:f,navigate:i,addEventClick:c,intersect:o}=S(),{from:r}=f();let s,n,u;return t(()=>{const{s:l}=e(),p=Math.round(l*.08);s={c:"#ff6347",r:p,x:Math.round(1.6*p),y:Math.round(1.6*p),p:r==="main"&&!s},n=R(s),u=L({x:Number(s.x)-p+Math.round(p*.4),y:Number(s.y)-p+Math.round(p*.4),w:p*2-Math.round(p*.8),src:"/media/back.svg"})}),a(()=>{s.p=!1}),c((l,p)=>{o({x:l,y:p},s)&&(s.p=!0,a(()=>{i("main")},100))}),{render:()=>{n(),s.p||u()},point:()=>({x:s.x,y:s.y,r:s.r})}},wt=t=>{const{addEventResize:e,useMeasure:a,useTimer:f,addEventClick:i,intersect:c,rotate:o}=S();let r,s,n;return e(()=>{const{s:h}=a(),l=Math.round(h*.055);r={c:"#ff6347",r:l,x:Math.round(innerWidth-1.6*l),y:Math.round(innerHeight-1.6*l),p:!1},s=R(r),n=L({x:Number(r.x)-l+Math.round(l*.4),y:Number(r.y)-l+Math.round(l*.4),w:l*2-Math.round(l*.8),src:"/media/back.svg"})}),i((h,l)=>{c({x:h,y:l},r)&&(r.p=!0,t(),f(()=>{r.p=!1},100))}),{render:()=>{s(),r.p||o(()=>{n()},r.x,r.y,-.5)},point:()=>({x:r.x,y:r.y,r:r.r})}},xt=t=>{const{addEventResize:e,useMeasure:a,useTimer:f,addEventClick:i,intersect:c,rotate:o}=S();let r,s,n;return e(()=>{const{s:h}=a(),l=Math.round(h*.055);r={c:"#ff6347",r:l,x:Math.round(innerWidth-1.6*l),y:Math.round(innerHeight-1.6*l-2*l-.3*l),p:!1},s=R(r),n=L({x:Number(r.x)-l+Math.round(l*.4),y:Number(r.y)-l+Math.round(l*.4),w:l*2-Math.round(l*.8),src:"/media/back.svg"})}),i((h,l)=>{c({x:h,y:l},r)&&(r.p=!0,t(),f(()=>{r.p=!1},100))}),{render:()=>{s(),r.p||o(()=>{n()},r.x,r.y,.5)},point:()=>({x:r.x,y:r.y,r:r.r})}},Ct=t=>{const{ctx:e,shade:a}=S(),f=Math.round(t.r/2.2),i=Math.round(.15*t.r),c=a(t.c||"blue",-3);return(o=e)=>{const{r,x:s=r,y:n=r}=t;o.lineCap="round",o.fillStyle=c,o.strokeStyle=c,o.lineWidth=f,o.beginPath(),o.moveTo(s+i,n),o.lineTo(s-i/2,n-i),o.lineTo(s-i/2,n+i),o.closePath(),o.fill(),o.beginPath(),o.moveTo(s+i,n),o.lineTo(s-i/2,n-i),o.moveTo(s-i/2,n-i),o.lineTo(s-i/2,n+i),o.moveTo(s-i/2,n+i),o.lineTo(s+i,n),o.stroke()}},It=()=>{const{addEventResize:t,useMeasure:e,useTimer:a,useScreenMeta:f,navigate:i,addEventClick:c,intersect:o}=S(),{from:r}=f();let s,n,u;return t(()=>{const{cx:l,cy:p,s:g,m:M}=e(),m=Math.round(g*.25);s={c:"#bef181",r:Math.round(g*.1),x:l+m+2*M,y:p+m,p:(r==="game"||r==="opening")&&!s},n=R(s),u=Ct(s)}),a(()=>{s.p=!1}),c((l,p)=>{o({x:l,y:p},s)&&(s.p=!0,a(()=>{i("game")},100))}),{render:()=>{n(),s.p||u()},point:()=>({x:s.x,y:s.y,r:s.r})}},J=t=>{const{font:e,ctx:a}=S();return(f=a)=>{const{text:i,x:c,c:o,y:r,fs:s,a:n="center",mw:u}=t;f.textAlign=n,f.fillStyle=o,f.font=`${s}px ${e}`,f.fillText(i,c,r,u)}},Rt=()=>{const{addEventResize:t,useMeasure:e,useTimer:a,useScreenMeta:f,addEventClick:i,intersect:c,navigate:o}=S(),{from:r}=f();let s,n,u,d;return t(()=>{const{cx:p,cy:g,s:M}=e(),m=Math.round(M*.25);s={c:"#f86a9a",x:p,y:g,r:m,p:r==="opening"&&!s},n=R(s),u=J({text:"Yola",c:"#f1f1f1",x:p,y:g-m+Math.round(m*.9),fs:Math.round(m/2.6),mw:m*2}),d=J({text:"PopiT",c:"#ffeb3b",x:p,y:g-m+Math.round(m*1.3),fs:Math.round(m/2.3),mw:m*2})}),a(()=>s.p=!1),i((p,g)=>{c({x:p,y:g},s)&&(s.p=!0,a(()=>{o("opening")},100))}),{render:()=>{n(),s.p||(u(),d())},point:()=>({x:s.x,y:s.y,r:s.r})}},ot=({color:t="#00dcfe",frequency:e=25})=>{const{addEventResize:a,useRandChain:f,useMeasure:i,rand:c,useTimer:o,setBackground:r,useScreenMeta:s}=S(),{from:n}=s();r(t);const u=c(0,999);let d=[],h=[];a(()=>{const M=f(u),{s:m}=i();d=[];const P=Math.round(m*.05),x=Math.round(innerWidth/P/2)-1,v=Math.round((innerWidth-2*P*x)/(x+1)),w=Math.round(innerHeight/P/2)-1,y=Math.round((innerHeight-2*P*w)/(w+1));for(let E=0;E<w;E++)for(let C=0;C<x;C++)M(M(e))<1&&d.push({x:v+P+C*P*2+v*C,y:y+P+E*P*2+y*E,r:P,c:t,p:n==="opening"?!0:M(1)>0});h=d.map(E=>R(E))});const l=()=>{o(()=>{const M=c(d.length-1);d[M]&&(d[M].p=!d[M].p),l()},750)};return n==="opening"?o(()=>{d.forEach(M=>M.p=c(1)>0),l()}):l(),{render:()=>{h.forEach(M=>M())},setIntersections:M=>{d=d.filter(({x:m,y:P,r:x})=>M(m,P,x)),h=d.map(m=>R(m))}}},Q="ylp",Z="score",tt="difficulty",Y=[.14,.11,.09,.075],et=750,bt=350,nt=5,T=[];for(let t=0;t*nt<=et-bt;t++)T.push(et-t*nt);const z=()=>{const t=d=>localStorage.getItem(`${Q}_${d}`),e=(d,h)=>localStorage.setItem(`${Q}_${d}`,h.toString()),a=()=>+(t(Z)||0),f=d=>e(Z,d),i=d=>{const h=a();f(h+d)},c=()=>+(t(tt)||T.length),o=d=>{const h=c();e(tt,Math.min(Math.max(h+d,0),Y.length*T.length-1))};return{getScore:a,addScore:i,plusDifficulty:()=>o(1),minusDifficulty:()=>o(-1),getDifficultyRad:()=>{const d=c(),h=Math.floor(d/T.length);return Y[h]||Y[1]},getDifficultyTic:()=>{const d=c(),h=Math.floor(d/T.length),l=d-h*T.length;return T[l]||T[0]}}},rt=(t=!1)=>{let e=["#f86a9a","#C69FEE","#5bb2f7","#92E6E6","#7ceab2","#bef181","#EFCD74","#fd8059"];const{addEventResize:a,useMeasure:f,setBackground:i,rand:c}=S(),{getDifficultyRad:o}=z();return e=[...e.splice(c(e.length-1),e.length),...e],t||a(()=>{const{s}=f(),n=o(),u=Math.round(s*n),d=Math.round(innerWidth/u/2)-1,h=(innerWidth-2*u*d)/(d+1),l=Math.round(innerHeight/u/2)-1,p=(innerHeight-2*u*l)/(l+1),g=innerWidth>=innerHeight,M=g?d:l,m=g?h:p,P=g?innerWidth:innerHeight;let x=0;const v=[];for(let y=0;y<M;y++)e[x]||(x=0),v.push(`${e[x]} ${(m+u+y*u*2+m*y)/P*100}%`),x++;i(`linear-gradient(${g?"to right":"to bottom"}, ${v.join(", ")})`,innerWidth<innerHeight?e[0]:"#040404")}),e},Tt=t=>{const{ctx:e,shade:a}=S(),f=Math.round(t.r/4),i=Math.round(.12*t.r);return(c=e)=>{const{r:o,x:r=o,y:s=o}=t,n=a(t.c||"blue",-3);c.lineCap="round",c.strokeStyle=n,c.lineWidth=f,c.beginPath(),c.moveTo(r-1.5*i,s-2*i),c.lineTo(r-1.5*i,s+2*i),c.stroke(),c.beginPath(),c.moveTo(r+1.5*i,s-2*i),c.lineTo(r+1.5*i,s+2*i),c.stroke()}},st=({palette:t,retry:e})=>{const{addEventResize:a,useMeasure:f,rand:i,useTimer:c,useScreenMeta:o,navigate:r,addEventClick:s,intersect:n}=S(),{from:u}=o(),{getDifficultyRad:d}=z(),h=[];let l=[],p,g,M,m;const P=v=>Array.isArray(t)?t[v]:t;return a(()=>{const{s:v}=f();h.splice(0);const w=d(),y=Math.round(v*w),E=Math.round(innerWidth/y/2)-1,C=(innerWidth-2*y*E)/(E+1),I=Math.round(innerHeight/y/2)-1,D=(innerHeight-2*y*I)/(I+1),H=innerWidth>=innerHeight;let b=0;for(let W=0;W<I;W++){for(let _=0;_<E;_++){P(b)||(b=0);const U={x:C+y+_*y*2+C*_,y:D+y+W*y*2+D*W,r:y,c:P(b),p:!0};W===0&&_===E-1?(m={...U,p:(u==="main"||u==="gameover"||u==="gamescore")&&!m},p=R(m),g=Tt(m)):h.push(U),b+=H?1:0}b=H?0:b+1}e&&(M=h[i(h.length-1)],c(()=>{M.p=!1})),l=h.map(W=>R(W))}),c(()=>{m.p=!1}),e&&s((v,w)=>{n({x:v,y:w},M)&&(M.p=!0,c(()=>{r("game")},100))}),s((v,w)=>{n({x:v,y:w},m)&&(m.p=!0,c(()=>{r("main")},100))}),{render:()=>{l.forEach(v=>v()),p(),m!=null&&m.p||g()},popits:h}},k=100,j=2,F="#222",Dt=t=>{const e=(t==null?void 0:t[0])||0,a=(t==null?void 0:t[1])||0,f=(t==null?void 0:t[2])||0;return"#"+(16777216+(e<255?e<1?0:e:255)*65536+(a<255?a<1?0:a:255)*256+(f<255?f<1?0:f:255)).toString(16).slice(1)},q={},Wt=t=>{const{ctx:e,shade:a,createImg:f,useRandChain:i}=S();let c;q[t.imgSrc]?c=q[t.imgSrc]:(c=q[t.imgSrc]={img:new Image,cols:[],isFilled:!1,r:t.r,drawImg:null,score:t.score},c.img.src=t.imgSrc);const o=(u,d=e)=>{const{x:h,y:l,c:p,r:g,p:M}=u;M?(d.fillStyle=a(p,5),d.beginPath(),d.arc(h+g,l+g,g,0,Math.PI*2),d.closePath(),d.fill()):(d.fillStyle=p,d.beginPath(),d.arc(h+g,l+g,g+2,0,Math.PI*2),d.closePath(),d.fill())},r=()=>{const u=[],d=(t.r*2-2*j)/k;for(let g=0;g<k;g++)for(let M=0;M<k;M++){const m={x:j+M*d,y:j+g*d,r:d/2,c:F};u.push(m)}let h=t.score;const l=[...u],p=i(0);for(let g=h;g>0;g--){const M=p(l.length-1),m=l[M],P=u.indexOf(m);m.c=c.cols[P],l.splice(M,1)}return u},s=()=>{const u=r();c.drawImg=f((d=e)=>{u.filter(h=>h.c===F).forEach(h=>o(h,d)),u.filter(h=>h.c!==F).forEach(h=>o(h,d)),u.filter(h=>h.c!==F).forEach(h=>o({...h,p:!0},d))},2*t.r)},n=async()=>{var h;const u=document.createElement("canvas");u.width=k,u.height=k;const d=u.getContext("2d",{willReadFrequently:!0});d==null||d.drawImage(c.img,0,0);for(let l=0;l<k;l++){const p=[];for(let g=0;g<k;g++){const M=(h=d==null?void 0:d.getImageData(g,l,1,1))==null?void 0:h.data;p.push(Dt(M))}c.cols.push(...p)}c.isFilled=!0,s()};return c.isFilled?(c.r!==t.r||c.score!==t.score)&&s():c.img.onload=n,(u=e)=>{const{x:d,y:h,r:l}=t;c.drawImg&&u.drawImage(c.drawImg,d-l,h-l,2*l,2*l)}},X=1e4,it=()=>{const{addEventResize:t,useMeasure:e,translate:a}=S(),{getScore:f}=z(),i=["/media/cat.png"],c=f();let o,r=0,s=0,n=Math.floor(c/X);return t(()=>{const{cx:p,cy:g,s:M}=e();o=[],r=(M-2*M*.055*1.6)/2,s=M*.05;for(let m=0;m<i.length;m++){const P=i[m];o.push(Wt({x:p,y:g+m*r*2+m*s,r,score:c-m*X<0?0:c-m*X,imgSrc:P}))}}),{up:()=>{n=n+1<i.length?n+1:i.length-1},down:()=>{n=n-1<0?0:n-1},render:()=>{a(()=>{o==null||o.forEach(p=>p())},0,-(n*r*2+n*s))},rect:()=>{const{cx:p,cy:g}=e(),M=innerWidth>innerHeight;return{x:M?p-r:0,y:M?0:g-r,w:M?2*r:innerWidth,h:M?innerHeight:2*r}}}},kt=t=>{const{useTimer:e,rand:a,addEventClick:f,addEventMove:i,intersect:c,navigate:o}=S(),{addScore:r,getDifficultyTic:s}=z();let n=[],u,d,h=!1,l=0,p=0,g=0;const M=s(),m=()=>{const y=t.filter(I=>n.indexOf(I)===-1),E=a(y.length-1),C=y[E];C&&(C.p=!1,n.push(y[E]))},P=()=>{d=e(()=>{if(g=Math.max(g-10,250),t.length===n.length){h=!0,d.stop(),e(()=>{o("gameover")});return}m(),P()},g)},x=y=>{n=[];const E=t.length;let C=a(Math.round(E*.3),Math.round(E*.6));const I=[...t];if(y){const D=I.indexOf(y);I.splice(D,1)}for(let D=C;D>0;D--){const H=a(I.length-1),b=I[H];b.p=!1,n.push(b),I.splice(H,1)}g=M,u==null||u.stop(),d==null||d.stop(),u=e(P,n.length*Math.min(M,500)),l=l>0?l:a(3,5)},v=y=>{g=Math.min(g+5,M),p++,y.p=!0;const E=n.indexOf(y);n.splice(E,1),n.length<=0&&(l--,l>0?x(y):(r(p),o("gamescore")))},w=(y,E,C=!1)=>{if(!h){for(const I of n)if(c({x:y,y:E},I)){v(I);return}C||m()}};f(w),i((y,E)=>w(y,E,!0)),e(()=>{x()})},At=()=>{const{addEventResize:t}=S(),{render:e,setIntersections:a}=ot({}),{render:f,point:i}=Rt(),{render:c,point:o}=It(),{render:r,point:s}=Pt();return t(()=>{const n=s(),u=i(),d=o();a((h,l,p)=>!A({x:h,y:l,r:p},n)&&!A({x:h,y:l,r:p},u)&&!A({x:h,y:l,r:p},d))}),()=>{e(),f(),c(),r()}},zt=()=>{const t=rt(),{popits:e,render:a}=st({palette:t});return kt(e),()=>{a()}},Ht=()=>{const t="#ff6347",{setBackground:e}=S(),{minusDifficulty:a}=z(),{render:f}=st({palette:t,retry:!0});return e(t),a(),()=>{f()}},_t=()=>{const{addEventClick:t,navigate:e}=S(),{plusDifficulty:a}=z();rt();const{render:f}=it();return t(()=>{e("game")}),a(),()=>{f()}},Lt=()=>{const{addEventResize:t}=S(),{render:e,setIntersections:a}=ot({color:"#ffeb3b",frequency:10}),{render:f,rect:i,up:c,down:o}=it(),{render:r,point:s}=St(),{point:n}=wt(c),{point:u}=xt(o);return t(()=>{const d=s(),h=i(),l=n(),p=u();a((g,M,m)=>!A({x:g,y:M,r:m},d)&&!mt({x:g,y:M,r:m},h)&&!A({x:g,y:M,r:m},l)&&!A({x:g,y:M,r:m},p))}),()=>{e(),f(),r()}},Ft=()=>{const{ctx:t,addEventResize:e,loop:a}=S(),f={x:40,y:100};let i=1,c=1,o;const r=()=>{o=5*Math.ceil(Math.sqrt(innerWidth*innerWidth+innerHeight*innerHeight)/144)};return r(),e(r),a(()=>{f.x+=2*i,f.y+=3*c,i*=-1,c*=-1}),()=>{t.save();var s=Math.random()*2,n=Math.random()*3;t.translate(s,n),t.beginPath(),t.fillStyle="red",t.rect(f.x,f.y,o,o),t.fill(),t.restore()}},$t=[{name:"opening",ctor:Et},{name:"main",ctor:At},{name:"game",ctor:zt},{name:"gameover",ctor:Ht},{name:"gamescore",ctor:_t},{name:"score",ctor:Lt},{name:"devs",ctor:Ft}];yt($t);document.title="Your's last Pop it";
