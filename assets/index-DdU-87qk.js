(function(){const o=document.createElement("link").relList;if(o&&o.supports&&o.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))l(i);new MutationObserver(i=>{for(const c of i)if(c.type==="childList")for(const s of c.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&l(s)}).observe(document,{childList:!0,subtree:!0});function a(i){const c={};return i.integrity&&(c.integrity=i.integrity),i.referrerPolicy&&(c.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?c.credentials="include":i.crossOrigin==="anonymous"?c.credentials="omit":c.credentials="same-origin",c}function l(i){if(i.ep)return;i.ep=!0;const c=a(i);fetch(i.href,c)}})();const dt=()=>{const e=document.createElement("canvas"),o=e.getContext("2d");if(!o)throw new Error("CanvasRenderingContext2D is null");const a=()=>{e.width=innerWidth*devicePixelRatio,e.height=innerHeight*devicePixelRatio,o.scale(devicePixelRatio,devicePixelRatio),e.style.width=`${innerWidth}px`,e.style.height=`${innerHeight}px`},l=t=>{o.clearRect(0,0,innerWidth,innerHeight),t()};return a(),document.body.appendChild(e),{ctx:o,render:l,resize:a,rotate:(t,d,u,h)=>{o.save(),o.translate(d,u),o.rotate(Math.PI*h),o.translate(-d,-u),t(),o.restore()},translate:(t,d,u)=>{o.save(),o.translate(d,u),t(),o.restore()},shade:(t,d)=>{t=t.substring(1);const u=parseInt(t,16),h=Math.round(2.55*d),M=(u>>16)+h,y=(u>>8&255)+h,f=(u&255)+h;return"#"+(16777216+(M<255?M<1?0:M:255)*65536+(y<255?y<1?0:y:255)*256+(f<255?f<1?0:f:255)).toString(16).slice(1)},setBackground:(t,d)=>{var u;document.body.style.background=t,document.body.style.backgroundColor=d||t,(u=document.querySelector('meta[name="theme-color"]'))==null||u.setAttribute("content",d||t)},createImg:(t,d,u=d)=>{const h=document.createElement("canvas"),M=h.getContext("2d");if(!M)throw new Error("CanvasRenderingContext2D is null");return h.width=d*devicePixelRatio,h.height=u*devicePixelRatio,M.scale(devicePixelRatio,devicePixelRatio),t(M),h}}},lt=e=>{let o="",a="",l;const i=n=>e.find(r=>r.name===n)||e[0],s={render:()=>{},navigate:(n,r)=>{const t=i(n);a=o||"",o=(t==null?void 0:t.name)||"",l=r,s.render=(t==null?void 0:t.ctor())||(()=>{})},useScreenMeta:()=>({to:o,from:a,data:l})};return s},ut=()=>{const e=requestAnimationFrame||(s=>setTimeout(s,16.666666666666668)),o=[],a={};return{loop:(s,n)=>{if(Object.entries(a).find(([t,d])=>d===s)||n&&a[n])throw new Error(`Loop${n?" "+n:""} already specified`);n&&o.push(n),n=n||new Date().valueOf().toString(),a[n]=s;const r=()=>{s(),a[n]&&e(r)};r()},stop:s=>{if(typeof s=="string")delete a[s];else{const n=Object.entries(a).find(([r,t])=>t===s);n&&delete a[n[0]]}},stopAll:()=>{for(const s in a)o.indexOf(s)===-1&&delete a[s]}}};let O=[];const ht=()=>{for(const e of O)clearTimeout(e);O=[]},ft=(e,o=400)=>{let a=new Date,l=o,i=setTimeout(e,l);return O.push(i),{pause:()=>{clearTimeout(i),l-=new Date-a},resume:()=>{a=new Date,clearTimeout(i),i=setTimeout(e,l),O.push(i)},stop:()=>{clearTimeout(i)}}},V=2147483646,N=2147483647,pt=16807,gt=(e=Math.floor(Math.random()*N))=>{e=e%N,e<=0&&(e+=V);const o=()=>(e=e*pt%N,e),a=()=>(o()-1)/V;return(i,c)=>(c===void 0&&(c=i,i=0),Math.floor(a()*(c-i+1))+i)},mt=(e,o)=>(o===void 0&&(o=e,e=0),Math.floor(Math.random()*(o-e+1))+e),Mt=()=>{const e=[],o=[],a=[];return{addEventResize:d=>{d(),e.push(d)},onResizeEvents:()=>e.forEach(d=>d()),addEventClick:d=>o.push(d),onClickEvents:(d,u)=>o.forEach(h=>h(d,u)),addEventMove:d=>a.push(d),onMoveEvents:(d,u)=>a.forEach(h=>h(d,u)),removeAllEvents:()=>{e.splice(0),o.splice(0),a.splice(0)}}},A=(e,o)=>{const a=Math.pow(Math.abs(e.x-o.x),2),l=Math.pow(Math.abs(e.y-o.y),2),i=e.r||0,c=o.r||0,s=Math.pow(i+c,2);return a+l<=s},vt=(e,o)=>{const a=e.r||0,l=o.w||0,i=o.h||0;return Math.abs(o.x+l/2-e.x)<=l/2+a&&Math.abs(o.y+i/2-e.y)<=i/2+a},yt=(e,o)=>A(e,o),Et=e=>{const o={},a=i=>{const c=i.split("/");return c[c.length-1].split(".")[0]};return(()=>{for(const i of e){const c=new Audio(i);c.volume=.25,c.addEventListener("ended",function(){this.currentTime=0});const s=a(i);o[s]={audio:c,path:i}}})(),i=>{var r,t;const c=(r=o[i])==null?void 0:r.audio,s=(t=o[i])==null?void 0:t.path;if(!(!c||!s))if(c.currentTime===0)c.play();else{var n=new Audio(s);n.volume=.25,n.play()}}};let B;const Pt=(e,o)=>{if(B)throw new Error("Webcore already specified");const a=dt(),l=lt(e),{loop:i,stop:c,stopAll:s}=ut(),{addEventResize:n,onResizeEvents:r,addEventClick:t,onClickEvents:d,addEventMove:u,onMoveEvents:h,removeAllEvents:M}=Mt();let y=innerWidth/2,f=innerHeight/2,p=innerWidth<innerHeight?innerWidth:innerHeight,m=Math.ceil(Math.sqrt(innerWidth*innerWidth+innerHeight*innerHeight)/144);const g=()=>({cx:y,cy:f,s:p,m}),E=Et([]);B={font:"Tijuf",ctx:a.ctx,shade:a.shade,rotate:a.rotate,translate:a.translate,setBackground:a.setBackground,createImg:a.createImg,useMeasure:g,useScreenMeta:l.useScreenMeta,navigate:(v,S)=>{if(!e.some(w=>w.name===v))throw new Error(`Screen ${v} not specified`);s(),ht(),M(),new Promise(()=>l.navigate(v,S))},loop:i,loopStop:c,useTimer:ft,rand:mt,useRandChain:gt,intersect:yt,addEventResize:n,addEventClick:t,addEventMove:u,playAudio:E},i(()=>a.render(l.render),"draw"),window.onresize=()=>{y=innerWidth/2,f=innerHeight/2,p=innerWidth<innerHeight?innerWidth:innerHeight,m=Math.ceil(Math.sqrt(innerWidth*innerWidth+innerHeight*innerHeight)/144),a.resize(),r()},document.onpointerdown=v=>{d(v.clientX,v.clientY)},document.onmousemove=v=>{h(v.clientX,v.clientY)},l.navigate()},x=()=>{if(!B)throw new Error("Webcore not specified");return{...B}},G={},R=e=>{const{shade:o,ctx:a,createImg:l}=x(),i=()=>{const{r:s,c:n="#ffffff",p:r}=e,t=a.createRadialGradient(s,s,s,s,s,s/5);return t.addColorStop(0,o(n,0)),t.addColorStop(.01,o(n,0)),t.addColorStop(.075,o(n,9)),t.addColorStop(.15,o(n,0)),t.addColorStop(.15,o(n,-15)),t.addColorStop(.18,o(n,-5)),t.addColorStop(.22,o(n,-15)),r?(t.addColorStop(.24,o(n,-10)),t.addColorStop(.3,o(n,-8)),t.addColorStop(.34,o(n,-12)),t.addColorStop(.6,o(n,-6)),t.addColorStop(1,o(n,-4))):(t.addColorStop(.24,o(n,-12)),t.addColorStop(.26,o(n,-8)),t.addColorStop(.3,o(n,-2)),t.addColorStop(.34,o(n,0)),t.addColorStop(.5,o(n,5)),t.addColorStop(1,o(n,10))),t},c=()=>{const{r:s,c:n="#ffffff",p:r}=e,t=`${n}_${r?"push":"pop"}_${s}`;if(G[t])return G[t];const d=l((u=a)=>{const h=i();u.fillStyle=h,u.beginPath(),u.arc(s,s,s,0,2*Math.PI),u.closePath(),u.fill()},2*s);return G[t]=d,d};return(s=a)=>{const{x:n,y:r,r:t}=e,d=c();s.drawImage(d,n-t,r-t,2*t,2*t)}},Y={},L=e=>{const{ctx:o}=x();let a;return Y[e.src]?a=Y[e.src]:(a=new Image,a.src=e.src,Y[e.src]=a),(l=o)=>{const{w:i,h:c=i,x:s=0,y:n=0}=e;a.complete&&l.drawImage(a,s,n,i,c)}},K=e=>{const{font:o,ctx:a}=x(),l=e.text,i=e.text.length,c=2*Math.PI/i/4;return(s=a)=>{const{x:n,y:r,r:t,s:d=0,fs:u}=e,h=u||Math.round(t/4);s.textAlign="center",s.fillStyle="#f9f9f9",s.font=`${h}px ${o}`,s.save(),s.translate(n,r),s.rotate(d);for(let M=0;M<i;M++)s.save(),s.rotate(M*c),s.fillText(l[M],0,-t),s.restore();s.restore()}},St=()=>{var g,E;const{ctx:e,loop:o,rotate:a,navigate:l,useMeasure:i,addEventClick:c,addEventResize:s,setBackground:n}=x();n("#040404");let r=!1,t,d,u,h,M,y=-.2,f=0;s(()=>{const{cx:v,cy:S,s:w}=i(),P=Math.round(w*.25);t={c:"#ff6347",x:v,y:S,r:P,p:!1},d=R(t),u=L({x:v-P+Math.round(P*.35),y:S-P+Math.round(P*.35),w:P*2-Math.round(P*.7),src:"/media/sloth.svg"}),h=K({text:"nezabotin",x:v,y:S,r:Math.round(P*1.1),s:Math.PI*1.6}),M=K({text:"production",x:v,y:S,r:Math.round(P*1.1),s:Math.PI*2.6})});const p=()=>{y+=.01,f=y>=1?1:y,y>=1.8&&(t.p=!0),y>=2.2&&(t.c="#f86a9a"),y>=2.6&&l("main")};c(()=>{[1.4,1.8,2.2,2.6].some(v=>{if(y<v)return y=v,!0})});const m=()=>{o(p),r=!0};return(g=document==null?void 0:document.fonts)!=null&&g.ready?(E=document==null?void 0:document.fonts)==null||E.ready.then(m):m(),()=>{const{cx:v,cy:S}=i();e.globalAlpha=r?1:0,d(),y<1.8&&u(),y<1.4&&a(()=>{h(),M()},v,S,f),e.globalAlpha=1}},_=100/2,wt=()=>{const{loop:e,ctx:o,shade:a}=x(),l={},i=()=>{for(const n in l){const r=l[n];if(!r)return;const t=r.popit;r.tic+=_/5,r.tic>=_&&(r.dir=-1),t.r=r.origR+r.origR*.001*(r.tic+(r.dir>0?0:_-r.tic)),r.tic>=2*_&&(delete l[n],t.r=r.origR)}},c=n=>{const r=new Date().valueOf().toString(),t=1,d=1;l[r]={tic:t,dir:d,popit:n,origR:n.r}},s=()=>{o.globalAlpha=.25;for(const n in l){const r=l[n],t=r.popit;o.fillStyle=a(t.c||"red",-20),o.beginPath(),o.arc(t.x,t.y,t.r+r.origR*.00125*(r.tic+(r.dir>0?0:_-r.tic)),0,Math.PI*2),o.closePath(),o.fill()}o.globalAlpha=1};return e(i),{popEffect:c,render:s}},xt=(e="#ba68c8")=>{const{addEventResize:o,useMeasure:a,useTimer:l,useScreenMeta:i,navigate:c,addEventClick:s,intersect:n}=x(),{from:r}=i();let t,d,u;return o(()=>{const{cx:y,cy:f,s:p,m}=a(),g=Math.round(p*.25);t={c:e,r:Math.round(p*.08),x:y-g-1*m,y:f-g+1*m,p:(r==="score"||r==="opening")&&!t},d=R(t),u=L({x:Number(t.x)-t.r+Math.round(t.r*.5),y:Number(t.y)-t.r+Math.round(t.r*.5),w:t.r*2-Math.round(t.r*1),src:"/media/star.svg"})}),l(()=>{t.p=!1}),s((y,f)=>{n({x:y,y:f},t)&&(t.p=!0,l(()=>{c("score")},100))}),{render:()=>{d(),t.p||u()},point:()=>({x:t.x,y:t.y,r:t.r})}},Ct=(e="#ff6347")=>{const{addEventResize:o,useMeasure:a,useTimer:l,useScreenMeta:i,navigate:c,addEventClick:s,intersect:n}=x(),{from:r}=i();let t,d,u;return o(()=>{const{s:y}=a(),f=Math.round(y*.08);t={c:e,r:f,x:Math.round(1.6*f),y:Math.round(1.6*f),p:r==="main"&&!t},d=R(t),u=L({x:Number(t.x)-f+Math.round(f*.4),y:Number(t.y)-f+Math.round(f*.4),w:f*2-Math.round(f*.8),src:"/media/back.svg"})}),l(()=>{t.p=!1}),s((y,f)=>{n({x:y,y:f},t)&&(t.p=!0,l(()=>{c("main")},100))}),{render:()=>{d(),t.p||u()},point:()=>({x:t.x,y:t.y,r:t.r})}},bt=e=>{const{addEventResize:o,useMeasure:a,useTimer:l,addEventClick:i,intersect:c,rotate:s}=x();let n,r,t;return o(()=>{const{s:h}=a(),M=Math.round(h*.055);n={c:"#ff6347",r:M,x:Math.round(innerWidth-1.6*M),y:Math.round(innerHeight-1.6*M),p:!1},r=R(n),t=L({x:Number(n.x)-M+Math.round(M*.4),y:Number(n.y)-M+Math.round(M*.4),w:M*2-Math.round(M*.8),src:"/media/back.svg"})}),i((h,M)=>{c({x:h,y:M},n)&&(n.p=!0,e(),l(()=>{n.p=!1},100))}),{render:()=>{r(),n.p||s(()=>{t()},n.x,n.y,-.5)},point:()=>({x:n.x,y:n.y,r:n.r})}},Rt=e=>{const{addEventResize:o,useMeasure:a,useTimer:l,addEventClick:i,intersect:c,rotate:s}=x();let n,r,t;return o(()=>{const{s:h}=a(),M=Math.round(h*.055);n={c:"#ff6347",r:M,x:Math.round(innerWidth-1.6*M),y:Math.round(innerHeight-1.6*M-2*M-.3*M),p:!1},r=R(n),t=L({x:Number(n.x)-M+Math.round(M*.4),y:Number(n.y)-M+Math.round(M*.4),w:M*2-Math.round(M*.8),src:"/media/back.svg"})}),i((h,M)=>{c({x:h,y:M},n)&&(n.p=!0,e(),l(()=>{n.p=!1},100))}),{render:()=>{r(),n.p||s(()=>{t()},n.x,n.y,.5)},point:()=>({x:n.x,y:n.y,r:n.r})}},It=e=>{const{ctx:o,shade:a}=x(),l=Math.round(e.r/2.2),i=Math.round(.15*e.r),c=a(e.c||"blue",-3);return(s=o)=>{const{r:n,x:r=n,y:t=n}=e;s.lineCap="round",s.fillStyle=c,s.strokeStyle=c,s.lineWidth=l,s.beginPath(),s.moveTo(r+i,t),s.lineTo(r-i/2,t-i),s.lineTo(r-i/2,t+i),s.closePath(),s.fill(),s.beginPath(),s.moveTo(r+i,t),s.lineTo(r-i/2,t-i),s.moveTo(r-i/2,t-i),s.lineTo(r-i/2,t+i),s.moveTo(r-i/2,t+i),s.lineTo(r+i,t),s.stroke()}},ot=({getX:e,getY:o,color:a="#bef181",popEffect:l=()=>{}})=>{const{addEventResize:i,useMeasure:c,useTimer:s,useScreenMeta:n,navigate:r,addEventClick:t,intersect:d}=x(),{from:u}=n();let h,M,y;return i(()=>{const{cx:m,cy:g,s:E,m:v}=c();h={c:a,r:Math.round(E*.1),x:e(m,E,v),y:o(g,E,v),p:(u==="gamescore"||u==="game"||u==="opening")&&!h},M=R(h),y=It(h)}),s(()=>{h.p=!1}),t((m,g)=>{d({x:m,y:g},h)&&(l(h),h.p=!0,s(()=>{r("game")},100))}),{render:()=>{M(),h.p||y()},point:()=>({x:h.x,y:h.y,r:h.r})}},rt=e=>{const{ctx:o,shade:a}=x(),l=Math.round(e.r/4),i=Math.round(.12*e.r);return(c=o)=>{const{r:s,x:n=s,y:r=s}=e,t=a(e.c||"blue",-3);c.lineCap="round",c.strokeStyle=t,c.lineWidth=l,c.beginPath(),c.moveTo(n-1.5*i,r-2*i),c.lineTo(n-1.5*i,r+2*i),c.stroke(),c.beginPath(),c.moveTo(n+1.5*i,r-2*i),c.lineTo(n+1.5*i,r+2*i),c.stroke()}},Tt=({getX:e,getY:o})=>{const{addEventResize:a,useMeasure:l,useTimer:i,useScreenMeta:c,navigate:s,addEventClick:n,intersect:r}=x(),{from:t}=c();let d,u,h;return a(()=>{const{cx:f,cy:p,s:m,m:g}=l();d={c:"#fd8059",r:Math.round(m*.08),x:e(f,m,g),y:o(p,m,g),p:(t==="game"||t==="opening")&&!d},u=R(d),h=rt(d)}),i(()=>{d.p=!1}),n((f,p)=>{r({x:f,y:p},d)&&(d.p=!0,i(()=>{s("main")},100))}),{render:()=>{u(),d.p||h()},point:()=>({x:d.x,y:d.y,r:d.r})}},J=e=>{const{font:o,ctx:a}=x();return(l=a)=>{const{text:i,x:c,c:s,y:n,fs:r,a:t="center",mw:d}=e;l.textAlign=t,l.fillStyle=s,l.font=`${r}px ${o}`,l.fillText(i,c,n,d)}},Wt=(e="#f86a9a")=>{const{addEventResize:o,useMeasure:a,useTimer:l,useScreenMeta:i,addEventClick:c,intersect:s,navigate:n}=x(),{from:r}=i();let t,d,u,h;return o(()=>{const{cx:f,cy:p,s:m}=a(),g=Math.round(m*.25);t={c:e,x:f,y:p,r:g,p:r==="opening"&&!t},d=R(t),u=J({text:"Yola",c:"#f1f1f1",x:f,y:p-g+Math.round(g*.9),fs:Math.round(g/2.6),mw:g*2}),h=J({text:"PopiT",c:"#ffeb3b",x:f,y:p-g+Math.round(g*1.3),fs:Math.round(g/2.3),mw:g*2})}),l(()=>t.p=!1),c((f,p)=>{s({x:f,y:p},t)&&(t.p=!0,l(()=>{n("opening")},100))}),{render:()=>{d(),t.p||(u(),h())},point:()=>({x:t.x,y:t.y,r:t.r})}},st=({color:e="#00dcfe",frequency:o=25})=>{const{addEventResize:a,useRandChain:l,useMeasure:i,rand:c,useTimer:s,setBackground:n,useScreenMeta:r}=x(),{from:t}=r();n(e);const d=c(0,999);let u=[],h=[];a(()=>{const p=l(d),{s:m}=i();u=[];const g=Math.round(m*.05),E=Math.round(innerWidth/g/2)-1,v=Math.round((innerWidth-2*g*E)/(E+1)),S=Math.round(innerHeight/g/2)-1,w=Math.round((innerHeight-2*g*S)/(S+1));for(let P=0;P<S;P++)for(let C=0;C<E;C++)p(p(o))<1&&u.push({x:v+g+C*g*2+v*C,y:w+g+P*g*2+w*P,r:g,c:e,p:t==="opening"?!0:p(1)>0});h=u.map(P=>R(P))});const M=()=>{s(()=>{const p=c(u.length-1);u[p]&&(u[p].p=!u[p].p),M()},750)};return t==="opening"?s(()=>{u.forEach(p=>p.p=c(1)>0),M()}):M(),{render:()=>{h.forEach(p=>p())},setIntersections:p=>{u=u.filter(({x:m,y:g,r:E})=>p(m,g,E)),h=u.map(m=>R(m))}}},Q="ylp",Z="score",tt="difficulty",X=[.14,.11,.09,.075],et=500,Dt=350,nt=5,k=[];for(let e=0;e*nt<=et-Dt;e++)k.push(et-e*nt);const z=()=>{const e=u=>localStorage.getItem(`${Q}_${u}`),o=(u,h)=>localStorage.setItem(`${Q}_${u}`,h.toString()),a=()=>+(e(Z)||0),l=u=>o(Z,u),i=u=>{const h=a();l(h+u)},c=()=>+(e(tt)||0),s=u=>{const h=c();o(tt,Math.min(Math.max(h+u,0),X.length*k.length-1))};return{getScore:a,addScore:i,plusDifficulty:()=>s(1),minusDifficulty:()=>s(-5),getDifficultyRad:()=>{const u=c(),h=Math.floor(u/k.length);return X[h]||X[1]},getDifficultyTic:()=>{const u=c(),h=Math.floor(u/k.length),M=u-h*k.length;return k[M]||k[0]}}},it=(e=!1)=>{let o=["#f86a9a","#C69FEE","#5bb2f7","#92E6E6","#7ceab2","#bef181","#EFCD74","#fd8059"];const{addEventResize:a,useMeasure:l,setBackground:i,rand:c}=x(),{getDifficultyRad:s}=z();return o=[...o.splice(c(o.length-1),o.length),...o],e||a(()=>{const{s:r}=l(),t=s(),d=Math.round(r*t),u=Math.round(innerWidth/d/2)-1,h=(innerWidth-2*d*u)/(u+1),M=Math.round(innerHeight/d/2)-1,y=(innerHeight-2*d*M)/(M+1),f=innerWidth>=innerHeight,p=f?u:M,m=f?h:y,g=f?innerWidth:innerHeight;let E=0;const v=[];for(let w=0;w<p;w++)o[E]||(E=0),v.push(`${o[E]} ${(m+d+w*d*2+m*w)/g*100}%`),E++;i(`linear-gradient(${f?"to right":"to bottom"}, ${v.join(", ")})`,innerWidth<innerHeight?o[0]:"#040404")}),o},ct=({palette:e,retry:o})=>{const{addEventResize:a,useMeasure:l,rand:i,useTimer:c,useScreenMeta:s,navigate:n,addEventClick:r,intersect:t}=x(),{from:d}=s(),{getDifficultyRad:u}=z(),h=[];let M=[],y,f,p,m;const g=v=>Array.isArray(e)?e[v]:e;return a(()=>{const{s:v}=l();h.splice(0);const S=u(),w=Math.round(v*S),P=Math.round(innerWidth/w/2)-1,C=(innerWidth-2*w*P)/(P+1),I=Math.round(innerHeight/w/2)-1,b=(innerHeight-2*w*I)/(I+1),D=innerWidth>=innerHeight;let W=0;for(let T=0;T<I;T++){for(let F=0;F<P;F++){g(W)||(W=0);const U={x:C+w+F*w*2+C*F,y:b+w+T*w*2+b*T,r:w,c:g(W),p:!0};T===0&&F===P-1?(m={...U,p:(d==="main"||d==="gameover"||d==="gamescore")&&!m},y=R(m),f=rt(m)):h.push(U),W+=D?1:0}W=D?0:W+1}o&&(p=h[i(h.length-1)],c(()=>{p.p=!1})),M=h.map(T=>R(T))}),c(()=>{m.p=!1}),o&&r((v,S)=>{t({x:v,y:S},p)&&(p.p=!0,c(()=>{n("game")},100))}),r((v,S)=>{t({x:v,y:S},m)&&(m.p=!0,c(()=>{n("main")},100))}),{render:()=>{M.forEach(v=>v()),y(),m!=null&&m.p||f()},popits:h}},H=100,$="#222",Ht=e=>{const o=(e==null?void 0:e[0])||0,a=(e==null?void 0:e[1])||0,l=(e==null?void 0:e[2])||0;return"#"+(16777216+(o<255?o<1?0:o:255)*65536+(a<255?a<1?0:a:255)*256+(l<255?l<1?0:l:255)).toString(16).slice(1)},j={},kt=e=>{const{ctx:o,createImg:a,useRandChain:l,useTimer:i}=x();let c,s=!1,n=[];const r=e.r*2/H/2;j[e.imgSrc]?c=j[e.imgSrc]:(c=j[e.imgSrc]={img:new Image,cols:[],isFilled:!1,r:e.r,drawImg:null,score:e.score},c.img.src=e.imgSrc);const t=()=>i(()=>{s=!s,t()},250),d=(f,p=o)=>{const{x:m,y:g,c:E,r:v}=f;p.fillStyle=E||"red",p.beginPath(),p.arc(m+v,g+v,v,0,Math.PI*2),p.closePath(),p.fill()},u=(f=o,p=0,m=0)=>{f.fillStyle=$,f.beginPath(),f.roundRect(p,m,2*e.r,2*e.r,r),f.closePath(),f.fill()},h=()=>{const f=[];for(let v=0;v<H;v++)for(let S=0;S<H;S++){const w={x:S*r*2,y:v*r*2,r,c:$};f.push(w)}let p=e.score-e.winScore;const m=[...f],g=l(0),E=(v=!1)=>{const S=g(m.length-1),w=m[S],P=f.indexOf(w);w.c=v?$:c.cols[P],m.splice(S,1),v&&n.push({...w,c:c.cols[P]})};for(let v=p;v>0;v--)E();if(e.winScore){n=[];for(let v=e.winScore;v>0;v--)E(!0);t()}return f},M=()=>{const f=h();c.drawImg=a((p=o)=>{u(p),f.filter(m=>m.c!==$).forEach(m=>d(m,p))},2*e.r)},y=async()=>{var m;const f=document.createElement("canvas");f.width=H,f.height=H;const p=f.getContext("2d",{willReadFrequently:!0});p==null||p.drawImage(c.img,0,0);for(let g=0;g<H;g++){const E=[];for(let v=0;v<H;v++){const S=(m=p==null?void 0:p.getImageData(v,g,1,1))==null?void 0:m.data;E.push(Ht(S))}c.cols.push(...E)}c.isFilled=!0,M()};return c.isFilled?(c.r!==e.r||c.score!==e.score)&&M():c.img.onload=y,(f=o)=>{const{x:p,y:m,r:g,winScore:E}=e;if(c.drawImg?f.drawImage(c.drawImg,p-g,m-g,2*g,2*g):u(f,p-g,m-g),s&&E&&c.drawImg)for(const v of n)f.fillStyle=v.c||"red",f.beginPath(),f.arc(p-g+v.x+v.r,m-g+v.y+v.r,v.r,0,Math.PI*2),f.closePath(),f.fill()}},q=1e4,at=(e=0)=>{const{addEventResize:o,useMeasure:a,translate:l}=x(),{getScore:i}=z(),c=["/media/cat.png"],s=i();let n,r=0,t=0,d=Math.floor(s/q);return o(()=>{const{cx:f,cy:p,s:m}=a();n=[],r=(m-2*m*.055*1.6)/2,t=m*.05;for(let g=0;g<c.length;g++){const E=c[g];n.push(kt({x:f,y:p+g*r*2+g*t,r,score:s-g*q<0?0:s-g*q,imgSrc:E,winScore:e}))}}),{up:()=>{d=d+1<c.length?d+1:c.length-1},down:()=>{d=d-1<0?0:d-1},render:()=>{l(()=>{n==null||n.forEach(f=>f())},0,-(d*r*2+d*t))},rect:()=>{const{cx:f,cy:p}=a(),m=innerWidth>innerHeight;return{x:m?f-r:0,y:m?0:p-r,w:m?2*r:innerWidth,h:m?innerHeight:2*r}}}},At=({popits:e,popEffect:o=()=>{}})=>{const{useTimer:a,rand:l,addEventClick:i,addEventMove:c,intersect:s,navigate:n}=x(),{addScore:r,getDifficultyTic:t}=z();let d=[],u,h,M=!1,y=0,f=0,p=0;const m=t(),g=()=>{const P=e.filter(b=>d.indexOf(b)===-1),C=l(P.length-1),I=P[C];I&&(I.p=!1,d.push(P[C]))},E=()=>{h=a(()=>{if(p-=10,e.length===d.length){M=!0,h.stop(),a(()=>{n("gameover")});return}g(),E()},p)},v=P=>{d=[];const C=e.length;let I=l(Math.round(C*.3),Math.round(C*.6));const b=[...e];if(P){const D=b.indexOf(P);b.splice(D,1)}for(let D=I;D>0;D--){const W=l(b.length-1),T=b[W];T.p=!1,d.push(T),b.splice(W,1)}p=m,u==null||u.stop(),h==null||h.stop(),u=a(E,d.length*m),y=y>0?y:l(3,5)},S=P=>{o(P),p=Math.min(p+5,m),f++,P.p=!0;const C=d.indexOf(P);d.splice(C,1),d.length<=0&&(y--,y>0?v(P):(u==null||u.stop(),h==null||h.stop(),r(f),a(()=>{n("gamescore",{winScore:f})},100)))},w=(P,C,I=!1)=>{if(!M){for(const b of d)if(s({x:P,y:C},b)){S(b);return}I||g()}};i(w),c((P,C)=>w(P,C,!0)),a(()=>{v()})},zt=()=>{const{addEventResize:e,rand:o,useScreenMeta:a}=x(),{from:l}=a(),i=["#00dcfe","#5bb2f7","#92E6E6","#EFCD74"],c=l==="opening"?i[0]:i[o(i.length-1)],{render:s,setIntersections:n}=st({color:c}),{render:r,point:t}=Wt(),{render:d,point:u}=ot({getX:(y,f,p)=>y+Math.round(f*.25)+2*p,getY:(y,f,p)=>y+Math.round(f*.25)+0*p}),{render:h,point:M}=xt();return e(()=>{const y=M(),f=t(),p=u();n((m,g,E)=>!A({x:m,y:g,r:E},y)&&!A({x:m,y:g,r:E},f)&&!A({x:m,y:g,r:E},p))}),()=>{s(),r(),d(),h()}},Ft=()=>{const e=it(),{popEffect:o,render:a}=wt(),{popits:l,render:i}=ct({palette:e});return At({popits:l,popEffect:o}),()=>{a(),i()}},_t=()=>{const e="#ff6347",{setBackground:o}=x(),{minusDifficulty:a}=z(),{render:l}=ct({palette:e,retry:!0});return o(e),a(),()=>{l()}},Lt=()=>{const{translate:e,useScreenMeta:o}=x(),{plusDifficulty:a}=z(),{data:l}=o();it();const{render:i}=at(l==null?void 0:l.winScore),{render:c}=ot({getX:(n,r,t)=>innerWidth>innerHeight?Math.min(n+(r-2*r*.055*1.6)/2+4*t+Math.round(r*.1),innerWidth-2*t-Math.round(r*.1)):n+(r-2*r*.055*1.6)/8+0*Math.round(r*.1)+2*t,getY:(n,r,t)=>innerWidth>innerHeight?n+(r-2*r*.055*1.6)/2-1*t-Math.round(r*.1):Math.min(n+(r-2*r*.055*1.6)/2+4*t+Math.round(r*.1),innerHeight-2*t-Math.round(r*.1))}),{render:s}=Tt({getX:(n,r,t)=>innerWidth>innerHeight?Math.max(n-(r-2*r*.055*1.6)/2-4*t-Math.round(r*.1),2*t+Math.round(r*.1)):n+(r-2*r*.055*1.6)/8-2*Math.round(r*.1)-2*t,getY:(n,r,t)=>innerWidth>innerHeight?n-(r-2*r*.055*1.6)/2+0*t+Math.round(r*.1):Math.min(n+(r-2*r*.055*1.6)/2+4*t+Math.round(r*.1),innerHeight-2*t-Math.round(r*.1))});return a(),()=>{innerHeight>innerWidth?e(i,0,-Math.round(innerHeight*.07)):i(),c(),s()}},$t=()=>{const{addEventResize:e,rand:o}=x(),a=["#ffeb3b","#C69FEE","#5bb2f7","#92E6E6","#7ceab2","#bef181","#EFCD74"],l=a[o(a.length-1)],{render:i,setIntersections:c}=st({color:l,frequency:10}),{render:s,rect:n,up:r,down:t}=at(),{render:d,point:u}=Ct(),{point:h}=bt(r),{point:M}=Rt(t);return e(()=>{const y=u(),f=n(),p=h(),m=M();c((g,E,v)=>!A({x:g,y:E,r:v},y)&&!vt({x:g,y:E,r:v},f)&&!A({x:g,y:E,r:v},p)&&!A({x:g,y:E,r:v},m))}),()=>{i(),s(),d()}},Ot=()=>{const{ctx:e,addEventResize:o,loop:a}=x(),l={x:40,y:100};let i=1,c=1,s;const n=()=>{s=5*Math.ceil(Math.sqrt(innerWidth*innerWidth+innerHeight*innerHeight)/144)};return n(),o(n),a(()=>{l.x+=2*i,l.y+=3*c,i*=-1,c*=-1}),()=>{e.save();var r=Math.random()*2,t=Math.random()*3;e.translate(r,t),e.beginPath(),e.fillStyle="red",e.rect(l.x,l.y,s,s),e.fill(),e.restore()}},Bt=[{name:"opening",ctor:St},{name:"main",ctor:zt},{name:"game",ctor:Ft},{name:"gameover",ctor:_t},{name:"gamescore",ctor:Lt},{name:"score",ctor:$t},{name:"devs",ctor:Ot}];Pt(Bt);document.title="Your's last Pop it";
