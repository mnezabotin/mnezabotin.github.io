(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))h(s);new MutationObserver(s=>{for(const c of s)if(c.type==="childList")for(const n of c.addedNodes)n.tagName==="LINK"&&n.rel==="modulepreload"&&h(n)}).observe(document,{childList:!0,subtree:!0});function a(s){const c={};return s.integrity&&(c.integrity=s.integrity),s.referrerPolicy&&(c.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?c.credentials="include":s.crossOrigin==="anonymous"?c.credentials="omit":c.credentials="same-origin",c}function h(s){if(s.ep)return;s.ep=!0;const c=a(s);fetch(s.href,c)}})();const it=()=>{const t=document.createElement("canvas"),e=t.getContext("2d");if(!e)throw new Error("CanvasRenderingContext2D is null");const a=()=>{t.width=innerWidth*devicePixelRatio,t.height=innerHeight*devicePixelRatio,e.scale(devicePixelRatio,devicePixelRatio)},h=r=>{e.clearRect(0,0,innerWidth,innerHeight),r()};return a(),document.body.appendChild(t),{ctx:e,render:h,resize:a,rotate:(r,l,d,u)=>{e.save(),e.translate(l,d),e.rotate(Math.PI*u),e.translate(-l,-d),r(),e.restore()},translate:(r,l,d)=>{e.save(),e.translate(l,d),r(),e.restore()},shade:(r,l)=>{r=r.substring(1);const d=parseInt(r,16),u=Math.round(2.55*l),f=(d>>16)+u,p=(d>>8&255)+u,m=(d&255)+u;return"#"+(16777216+(f<255?f<1?0:f:255)*65536+(p<255?p<1?0:p:255)*256+(m<255?m<1?0:m:255)).toString(16).slice(1)},setBackground:(r,l)=>{var d;document.body.style.background=r,document.body.style.backgroundColor=l||r,(d=document.querySelector('meta[name="theme-color"]'))==null||d.setAttribute("content",l||r)},createImg:(r,l,d=l)=>{const u=document.createElement("canvas"),f=u.getContext("2d");if(!f)throw new Error("CanvasRenderingContext2D is null");return u.width=l*devicePixelRatio,u.height=d*devicePixelRatio,f.scale(devicePixelRatio,devicePixelRatio),r(f),u}}},at=t=>{let e="",a="",h;const s=o=>t.find(i=>i.name===o)||t[0],n={render:()=>{},navigate:(o,i)=>{const r=s(o);a=e||"",e=(r==null?void 0:r.name)||"",h=i,n.render=(r==null?void 0:r.ctor())||(()=>{})},useScreenMeta:()=>({to:e,from:a,data:h})};return n},dt=()=>{const t=requestAnimationFrame||(n=>setTimeout(n,16.666666666666668)),e=[],a={};return{loop:(n,o)=>{if(Object.entries(a).find(([r,l])=>l===n)||o&&a[o])throw new Error(`Loop${o?" "+o:""} already specified`);o&&e.push(o),o=o||new Date().valueOf().toString(),a[o]=n;const i=()=>{n(),a[o]&&t(i)};i()},stop:n=>{if(typeof n=="string")delete a[n];else{const o=Object.entries(a).find(([i,r])=>r===n);o&&delete a[o[0]]}},stopAll:()=>{for(const n in a)e.indexOf(n)===-1&&delete a[n]}}};let O=[];const lt=()=>{for(const t of O)clearTimeout(t);O=[]},ut=(t,e=400)=>{let a=new Date,h=e,s=setTimeout(t,h);return O.push(s),{pause:()=>{clearTimeout(s),h-=new Date-a},resume:()=>{a=new Date,clearTimeout(s),s=setTimeout(t,h),O.push(s)},stop:()=>{clearTimeout(s)}}},V=2147483646,B=2147483647,ft=16807,ht=(t=Math.floor(Math.random()*B))=>{t=t%B,t<=0&&(t+=V);const e=()=>(t=t*ft%B,t),a=()=>(e()-1)/V;return(s,c)=>(c===void 0&&(c=s,s=0),Math.floor(a()*(c-s+1))+s)},pt=(t,e)=>(e===void 0&&(e=t,t=0),Math.floor(Math.random()*(e-t+1))+t),gt=()=>{const t=[],e=[],a=[];return{addEventResize:l=>{l(),t.push(l)},onResizeEvents:()=>t.forEach(l=>l()),addEventClick:l=>e.push(l),onClickEvents:(l,d)=>e.forEach(u=>u(l,d)),addEventMove:l=>a.push(l),onMoveEvents:(l,d)=>a.forEach(u=>u(l,d)),removeAllEvents:()=>{t.splice(0),e.splice(0),a.splice(0)}}},z=(t,e)=>{const a=Math.pow(Math.abs(t.x-e.x),2),h=Math.pow(Math.abs(t.y-e.y),2),s=t.r||0,c=e.r||0,n=Math.pow(s+c,2);return a+h<=n},mt=(t,e)=>{const a=t.r||0,h=e.w||0,s=e.h||0;return Math.abs(e.x+h/2-t.x)<=h/2+a&&Math.abs(e.y+s/2-t.y)<=s/2+a},Mt=(t,e)=>z(t,e),vt=t=>{const e={},a=s=>{const c=s.split("/");return c[c.length-1].split(".")[0]};return(()=>{for(const s of t){const c=new Audio(s);c.volume=.25,c.addEventListener("ended",function(){this.currentTime=0});const n=a(s);e[n]={audio:c,path:s}}})(),s=>{var i,r;const c=(i=e[s])==null?void 0:i.audio,n=(r=e[s])==null?void 0:r.path;if(!(!c||!n))if(c.currentTime===0)c.play();else{var o=new Audio(n);o.volume=.25,o.play()}}};let $;const yt=(t,e)=>{if($)throw new Error("Webcore already specified");const a=it(),h=at(t),{loop:s,stop:c,stopAll:n}=dt(),{addEventResize:o,onResizeEvents:i,addEventClick:r,onClickEvents:l,addEventMove:d,onMoveEvents:u,removeAllEvents:f}=gt();let p=innerWidth/2,m=innerHeight/2,g=innerWidth<innerHeight?innerWidth:innerHeight,M=Math.ceil(Math.sqrt(innerWidth*innerWidth+innerHeight*innerHeight)/144);const E=()=>({cx:p,cy:m,s:g,m:M}),x=vt(e);$={font:"Tijuf",ctx:a.ctx,shade:a.shade,rotate:a.rotate,translate:a.translate,setBackground:a.setBackground,createImg:a.createImg,useMeasure:E,useScreenMeta:h.useScreenMeta,navigate:(v,w)=>{if(!t.some(P=>P.name===v))throw new Error(`Screen ${v} not specified`);n(),lt(),f(),new Promise(()=>h.navigate(v,w))},loop:s,loopStop:c,useTimer:ut,rand:pt,useRandChain:ht,intersect:Mt,addEventResize:o,addEventClick:r,addEventMove:d,playAudio:x},s(()=>a.render(h.render),"draw"),window.onresize=()=>{p=innerWidth/2,m=innerHeight/2,g=innerWidth<innerHeight?innerWidth:innerHeight,M=Math.ceil(Math.sqrt(innerWidth*innerWidth+innerHeight*innerHeight)/144),a.resize(),i()},document.onpointerdown=v=>{l(v.clientX,v.clientY)},document.onmousemove=v=>{u(v.clientX,v.clientY)},h.navigate()},S=()=>{if(!$)throw new Error("Webcore not specified");return{...$}},N={},R=t=>{const{shade:e,ctx:a,createImg:h}=S(),s=()=>{const{r:n,c:o="#ffffff",p:i}=t,r=a.createRadialGradient(n,n,n,n,n,n/5);return r.addColorStop(0,e(o,0)),r.addColorStop(.01,e(o,0)),r.addColorStop(.075,e(o,9)),r.addColorStop(.15,e(o,0)),r.addColorStop(.15,e(o,-15)),r.addColorStop(.18,e(o,-5)),r.addColorStop(.22,e(o,-15)),i?(r.addColorStop(.24,e(o,-10)),r.addColorStop(.3,e(o,-8)),r.addColorStop(.34,e(o,-12)),r.addColorStop(.6,e(o,-6)),r.addColorStop(1,e(o,-4))):(r.addColorStop(.24,e(o,-12)),r.addColorStop(.26,e(o,-8)),r.addColorStop(.3,e(o,-2)),r.addColorStop(.34,e(o,0)),r.addColorStop(.5,e(o,5)),r.addColorStop(1,e(o,10))),r},c=()=>{const{r:n,c:o="#ffffff",p:i}=t,r=`${o}_${i?"push":"pop"}_${n}`;if(N[r])return N[r];const l=h((d=a)=>{const u=s();d.fillStyle=u,d.beginPath(),d.arc(n,n,n,0,2*Math.PI),d.closePath(),d.fill()},2*n);return N[r]=l,l};return(n=a)=>{const{x:o,y:i,r}=t,l=c();n.drawImage(l,o-r,i-r,2*r,2*r)}},G={},L=t=>{const{ctx:e}=S();let a;return G[t.src]?a=G[t.src]:(a=new Image,a.src=t.src,G[t.src]=a),(h=e)=>{const{w:s,h:c=s,x:n=0,y:o=0}=t;a.complete&&h.drawImage(a,n,o,s,c)}},K=t=>{const{font:e,ctx:a}=S(),h=t.text,s=t.text.length,c=2*Math.PI/s/4;return(n=a)=>{const{x:o,y:i,r,s:l=0,fs:d}=t,u=d||Math.round(r/4);n.textAlign="center",n.fillStyle="#f9f9f9",n.font=`${u}px ${e}`,n.save(),n.translate(o,i),n.rotate(l);for(let f=0;f<s;f++)n.save(),n.rotate(f*c),n.fillText(h[f],0,-r),n.restore();n.restore()}},Et=()=>{var E,x;const{ctx:t,loop:e,rotate:a,navigate:h,useMeasure:s,addEventClick:c,addEventResize:n,setBackground:o}=S();o("#040404");let i=!1,r,l,d,u,f,p=-.2,m=0;n(()=>{const{cx:v,cy:w,s:P}=s(),y=Math.round(P*.25);r={c:"#ff6347",x:v,y:w,r:y,p:!1},l=R(r),d=L({x:v-y+Math.round(y*.35),y:w-y+Math.round(y*.35),w:y*2-Math.round(y*.7),src:"/media/sloth.svg"}),u=K({text:"nezabotin",x:v,y:w,r:Math.round(y*1.1),s:Math.PI*1.6}),f=K({text:"production",x:v,y:w,r:Math.round(y*1.1),s:Math.PI*2.6})});const g=()=>{p+=.01,m=p>=1?1:p,p>=1.8&&(r.p=!0),p>=2.2&&(r.c="#f86a9a"),p>=2.6&&h("main")};c(()=>{[1.4,1.8,2.2,2.6].some(v=>{if(p<v)return p=v,!0})});const M=()=>{e(g),i=!0};return(E=document==null?void 0:document.fonts)!=null&&E.ready?(x=document==null?void 0:document.fonts)==null||x.ready.then(M):M(),()=>{const{cx:v,cy:w}=s();t.globalAlpha=i?1:0,l(),p<1.8&&d(),p<1.4&&a(()=>{u(),f()},v,w,m),t.globalAlpha=1}},Pt=()=>{const{addEventResize:t,useMeasure:e,useTimer:a,useScreenMeta:h,navigate:s,addEventClick:c,intersect:n}=S(),{from:o}=h();let i,r,l;return t(()=>{const{cx:f,cy:p,s:m,m:g}=e(),M=Math.round(m*.25);i={c:"#ba68c8",r:Math.round(m*.08),x:f-M-1*g,y:p-M+1*g,p:(o==="score"||o==="opening")&&!i},r=R(i),l=L({x:Number(i.x)-i.r+Math.round(i.r*.5),y:Number(i.y)-i.r+Math.round(i.r*.5),w:i.r*2-Math.round(i.r*1),src:"/media/star.svg"})}),a(()=>{i.p=!1}),c((f,p)=>{n({x:f,y:p},i)&&(i.p=!0,a(()=>{s("score")},100))}),{render:()=>{r(),i.p||l()},point:()=>({x:i.x,y:i.y,r:i.r})}},St=()=>{const{addEventResize:t,useMeasure:e,useTimer:a,useScreenMeta:h,navigate:s,addEventClick:c,intersect:n}=S(),{from:o}=h();let i,r,l;return t(()=>{const{s:f}=e(),p=Math.round(f*.08);i={c:"#ff6347",r:p,x:Math.round(1.6*p),y:Math.round(1.6*p),p:o==="main"&&!i},r=R(i),l=L({x:Number(i.x)-p+Math.round(p*.4),y:Number(i.y)-p+Math.round(p*.4),w:p*2-Math.round(p*.8),src:"/media/back.svg"})}),a(()=>{i.p=!1}),c((f,p)=>{n({x:f,y:p},i)&&(i.p=!0,a(()=>{s("main")},100))}),{render:()=>{r(),i.p||l()},point:()=>({x:i.x,y:i.y,r:i.r})}},wt=t=>{const{addEventResize:e,useMeasure:a,useTimer:h,addEventClick:s,intersect:c,rotate:n}=S();let o,i,r;return e(()=>{const{s:u}=a(),f=Math.round(u*.055);o={c:"#ff6347",r:f,x:Math.round(innerWidth-1.6*f),y:Math.round(innerHeight-1.6*f),p:!1},i=R(o),r=L({x:Number(o.x)-f+Math.round(f*.4),y:Number(o.y)-f+Math.round(f*.4),w:f*2-Math.round(f*.8),src:"/media/back.svg"})}),s((u,f)=>{c({x:u,y:f},o)&&(o.p=!0,t(),h(()=>{o.p=!1},100))}),{render:()=>{i(),o.p||n(()=>{r()},o.x,o.y,-.5)},point:()=>({x:o.x,y:o.y,r:o.r})}},xt=t=>{const{addEventResize:e,useMeasure:a,useTimer:h,addEventClick:s,intersect:c,rotate:n}=S();let o,i,r;return e(()=>{const{s:u}=a(),f=Math.round(u*.055);o={c:"#ff6347",r:f,x:Math.round(innerWidth-1.6*f),y:Math.round(innerHeight-1.6*f-2*f-.3*f),p:!1},i=R(o),r=L({x:Number(o.x)-f+Math.round(f*.4),y:Number(o.y)-f+Math.round(f*.4),w:f*2-Math.round(f*.8),src:"/media/back.svg"})}),s((u,f)=>{c({x:u,y:f},o)&&(o.p=!0,t(),h(()=>{o.p=!1},100))}),{render:()=>{i(),o.p||n(()=>{r()},o.x,o.y,.5)},point:()=>({x:o.x,y:o.y,r:o.r})}},Ct=t=>{const{ctx:e,shade:a}=S(),h=Math.round(t.r/2.2),s=Math.round(.15*t.r),c=a(t.c||"blue",-3);return(n=e)=>{const{r:o,x:i=o,y:r=o}=t;n.lineCap="round",n.fillStyle=c,n.strokeStyle=c,n.lineWidth=h,n.beginPath(),n.moveTo(i+s,r),n.lineTo(i-s/2,r-s),n.lineTo(i-s/2,r+s),n.closePath(),n.fill(),n.beginPath(),n.moveTo(i+s,r),n.lineTo(i-s/2,r-s),n.moveTo(i-s/2,r-s),n.lineTo(i-s/2,r+s),n.moveTo(i-s/2,r+s),n.lineTo(i+s,r),n.stroke()}},It=()=>{const{addEventResize:t,useMeasure:e,useTimer:a,useScreenMeta:h,navigate:s,addEventClick:c,intersect:n}=S(),{from:o}=h();let i,r,l;return t(()=>{const{cx:f,cy:p,s:m,m:g}=e(),M=Math.round(m*.25);i={c:"#bef181",r:Math.round(m*.1),x:f+M+2*g,y:p+M,p:(o==="game"||o==="opening")&&!i},r=R(i),l=Ct(i)}),a(()=>{i.p=!1}),c((f,p)=>{n({x:f,y:p},i)&&(i.p=!0,a(()=>{s("game")},100))}),{render:()=>{r(),i.p||l()},point:()=>({x:i.x,y:i.y,r:i.r})}},J=t=>{const{font:e,ctx:a}=S();return(h=a)=>{const{text:s,x:c,c:n,y:o,fs:i,a:r="center",mw:l}=t;h.textAlign=r,h.fillStyle=n,h.font=`${i}px ${e}`,h.fillText(s,c,o,l)}},Rt=()=>{const{addEventResize:t,useMeasure:e,useTimer:a,useScreenMeta:h}=S(),{from:s}=h();let c,n,o,i;return t(()=>{const{cx:d,cy:u,s:f}=e(),p=Math.round(f*.25);c={c:"#f86a9a",x:d,y:u,r:p,p:s==="opening"&&!c},n=R(c),o=J({text:"Yola",c:"#f1f1f1",x:d,y:u-p+Math.round(p*.9),fs:Math.round(p/2.6),mw:p*2}),i=J({text:"PopiT",c:"#ffeb3b",x:d,y:u-p+Math.round(p*1.3),fs:Math.round(p/2.3),mw:p*2})}),a(()=>c.p=!1),{render:()=>{n(),c.p||(o(),i())},point:()=>({x:c.x,y:c.y,r:c.r})}},ot=({color:t="#00dcfe",frequency:e=25})=>{const{addEventResize:a,useRandChain:h,useMeasure:s,rand:c,useTimer:n,setBackground:o,useScreenMeta:i}=S(),{from:r}=i();o(t);const l=c(0,999);let d=[],u=[];a(()=>{const g=h(l),{s:M}=s();d=[];const E=Math.round(M*.05),x=Math.round(innerWidth/E/2)-1,v=Math.round((innerWidth-2*E*x)/(x+1)),w=Math.round(innerHeight/E/2)-1,P=Math.round((innerHeight-2*E*w)/(w+1));for(let y=0;y<w;y++)for(let C=0;C<x;C++)g(g(e))<1&&d.push({x:v+E+C*E*2+v*C,y:P+E+y*E*2+P*y,r:E,c:t,p:r==="opening"?!0:g(1)>0});u=d.map(y=>R(y))});const f=()=>{n(()=>{const g=c(d.length-1);d[g]&&(d[g].p=!d[g].p),f()},750)};return r==="opening"?n(()=>{d.forEach(g=>g.p=c(1)>0),f()}):f(),{render:()=>{u.forEach(g=>g())},setIntersections:g=>{d=d.filter(({x:M,y:E,r:x})=>g(M,E,x)),u=d.map(M=>R(M))}}},Q="ylp",Z="score",tt="difficulty",Y=[.15,.14,.11,.09],et=800,bt=350,nt=10,A=[];for(let t=0;t*nt<=et-bt;t++)A.push(et-t*nt);const H=()=>{const t=d=>localStorage.getItem(`${Q}_${d}`),e=(d,u)=>localStorage.setItem(`${Q}_${d}`,u.toString()),a=()=>+(t(Z)||0),h=d=>e(Z,d),s=d=>{const u=a();h(u+d)},c=()=>+(t(tt)||A.length),n=d=>{const u=c();e(tt,Math.min(Math.max(u+d,0),Y.length*A.length-1))};return{getScore:a,addScore:s,plusDifficulty:()=>n(1),minusDifficulty:()=>n(-1),getDifficultyRad:()=>{const d=c(),u=Math.floor(d/A.length);return Y[u]||Y[1]},getDifficultyTic:()=>{const d=c(),u=Math.floor(d/A.length),f=d-u*A.length;return A[f]||A[0]}}},rt=(t=!1)=>{let e=["#f86a9a","#C69FEE","#5bb2f7","#92E6E6","#7ceab2","#bef181","#EFCD74","#fd8059"];const{addEventResize:a,useMeasure:h,setBackground:s,rand:c}=S(),{getDifficultyRad:n}=H();return e=[...e.splice(c(e.length-1),e.length),...e],t||a(()=>{const{s:i}=h(),r=n(),l=Math.round(i*r),d=Math.round(innerWidth/l/2)-1,u=(innerWidth-2*l*d)/(d+1),f=Math.round(innerHeight/l/2)-1,p=(innerHeight-2*l*f)/(f+1),m=innerWidth>=innerHeight,g=m?d:f,M=m?u:p,E=m?innerWidth:innerHeight;let x=0;const v=[];for(let P=0;P<g;P++)e[x]||(x=0),v.push(`${e[x]} ${(M+l+P*l*2+M*P)/E*100}%`),x++;s(`linear-gradient(${m?"to right":"to bottom"}, ${v.join(", ")})`,innerWidth<innerHeight?e[0]:"#040404")}),e},Tt=t=>{const{ctx:e,shade:a}=S(),h=Math.round(t.r/4),s=Math.round(.12*t.r);return(c=e)=>{const{r:n,x:o=n,y:i=n}=t,r=a(t.c||"blue",-3);c.lineCap="round",c.strokeStyle=r,c.lineWidth=h,c.beginPath(),c.moveTo(o-1.5*s,i-2*s),c.lineTo(o-1.5*s,i+2*s),c.stroke(),c.beginPath(),c.moveTo(o+1.5*s,i-2*s),c.lineTo(o+1.5*s,i+2*s),c.stroke()}},st=({palette:t,retry:e})=>{const{addEventResize:a,useMeasure:h,rand:s,useTimer:c,useScreenMeta:n,navigate:o,addEventClick:i,intersect:r}=S(),{from:l}=n(),{getDifficultyRad:d}=H(),u=[];let f=[],p,m,g,M;const E=v=>Array.isArray(t)?t[v]:t;return a(()=>{const{s:v}=h();u.splice(0);const w=d(),P=Math.round(v*w),y=Math.round(innerWidth/P/2)-1,C=(innerWidth-2*P*y)/(y+1),b=Math.round(innerHeight/P/2)-1,I=(innerHeight-2*P*b)/(b+1),W=innerWidth>=innerHeight;let D=0;for(let T=0;T<b;T++){for(let _=0;_<y;_++){E(D)||(D=0);const U={x:C+P+_*P*2+C*_,y:I+P+T*P*2+I*T,r:P,c:E(D),p:!0};T===0&&_===y-1?(M={...U,p:(l==="main"||l==="gameover"||l==="gamescore")&&!M},p=R(M),m=Tt(M)):u.push(U),D+=W?1:0}D=W?0:D+1}e&&(g=u[s(u.length-1)],c(()=>{g.p=!1})),f=u.map(T=>R(T))}),c(()=>{M.p=!1}),e&&i((v,w)=>{r({x:v,y:w},g)&&(g.p=!0,c(()=>{o("game")},100))}),i((v,w)=>{r({x:v,y:w},M)&&(M.p=!0,c(()=>{o("main")},100))}),{render:()=>{f.forEach(v=>v()),p(),M!=null&&M.p||m()},popits:u}},k=100,j=2,F="#222",Dt=t=>{const e=(t==null?void 0:t[0])||0,a=(t==null?void 0:t[1])||0,h=(t==null?void 0:t[2])||0;return"#"+(16777216+(e<255?e<1?0:e:255)*65536+(a<255?a<1?0:a:255)*256+(h<255?h<1?0:h:255)).toString(16).slice(1)},q={},At=t=>{const{ctx:e,shade:a,createImg:h,useRandChain:s}=S();let c;q[t.imgSrc]?c=q[t.imgSrc]:(c=q[t.imgSrc]={img:new Image,cols:[],isFilled:!1,r:t.r,drawImg:null,score:t.score},c.img.src=t.imgSrc);const n=(l,d=e)=>{const{x:u,y:f,c:p,r:m,p:g}=l;g?(d.fillStyle=a(p,5),d.beginPath(),d.arc(u+m,f+m,m,0,Math.PI*2),d.closePath(),d.fill()):(d.fillStyle=p,d.beginPath(),d.arc(u+m,f+m,m+2,0,Math.PI*2),d.closePath(),d.fill())},o=()=>{const l=[],d=(t.r*2-2*j)/k;for(let m=0;m<k;m++)for(let g=0;g<k;g++){const M={x:j+g*d,y:j+m*d,r:d/2,c:F};l.push(M)}let u=t.score;const f=[...l],p=s(0);for(let m=u;m>0;m--){const g=p(f.length-1),M=f[g],E=l.indexOf(M);M.c=c.cols[E],f.splice(g,1)}return l},i=()=>{const l=o();c.drawImg=h((d=e)=>{l.filter(u=>u.c===F).forEach(u=>n(u,d)),l.filter(u=>u.c!==F).forEach(u=>n(u,d)),l.filter(u=>u.c!==F).forEach(u=>n({...u,p:!0},d))},2*t.r)},r=async()=>{var u;const l=document.createElement("canvas");l.width=k,l.height=k;const d=l.getContext("2d",{willReadFrequently:!0});d==null||d.drawImage(c.img,0,0);for(let f=0;f<k;f++){const p=[];for(let m=0;m<k;m++){const g=(u=d==null?void 0:d.getImageData(m,f,1,1))==null?void 0:u.data;p.push(Dt(g))}c.cols.push(...p)}c.isFilled=!0,i()};return c.isFilled?(c.r!==t.r||c.score!==t.score)&&i():c.img.onload=r,(l=e)=>{const{x:d,y:u,r:f}=t;c.drawImg&&l.drawImage(c.drawImg,d-f,u-f,2*f,2*f)}},X=1e4,ct=()=>{const{addEventResize:t,useMeasure:e,translate:a}=S(),{getScore:h}=H(),s=["/media/cat.png"],c=h();let n,o=0,i=0,r=Math.floor(c/X);return t(()=>{const{cx:p,cy:m,s:g}=e();n=[],o=(g-2*g*.055*1.6)/2,i=g*.05;for(let M=0;M<s.length;M++){const E=s[M];n.push(At({x:p,y:m+M*o*2+M*i,r:o,score:c-M*X<0?0:c-M*X,imgSrc:E}))}}),{up:()=>{r=r+1<s.length?r+1:s.length-1},down:()=>{r=r-1<0?0:r-1},render:()=>{a(()=>{n==null||n.forEach(p=>p())},0,-(r*o*2+r*i))},rect:()=>{const{cx:p,cy:m}=e(),g=innerWidth>innerHeight;return{x:g?p-o:0,y:g?0:m-o,w:g?2*o:innerWidth,h:g?innerHeight:2*o}}}},Wt=t=>{const{useTimer:e,rand:a,addEventClick:h,addEventMove:s,intersect:c,navigate:n,playAudio:o}=S(),{addScore:i,getDifficultyTic:r}=H();let l=[],d,u,f=!1,p=0,m=0,g=0;const M=r(),E=()=>{const y=t.filter(I=>l.indexOf(I)===-1),C=a(y.length-1),b=y[C];b&&(b.p=!1,l.push(y[C]))},x=()=>{u=e(()=>{if(g=Math.max(g-10,250),t.length===l.length){f=!0,u.stop(),e(()=>{n("gameover")});return}E(),x()},g)},v=y=>{l=[];const C=t.length;let b=a(Math.round(C*.3),Math.round(C*.6));const I=[...t];if(y){const W=I.indexOf(y);I.splice(W,1)}for(let W=b;W>0;W--){const D=a(I.length-1),T=I[D];T.p=!1,l.push(T),I.splice(D,1)}g=M,d==null||d.stop(),u==null||u.stop(),d=e(x,l.length*Math.min(M,500)),p=p>0?p:a(3,5)},w=y=>{o("tapfast"),g=Math.min(g+5,M),m++,y.p=!0;const C=l.indexOf(y);l.splice(C,1),l.length<=0&&(p--,p>0?v(y):(i(m),n("gamescore")))},P=(y,C,b=!1)=>{if(!f){for(const I of l)if(c({x:y,y:C},I)){w(I);return}b||E()}};h(P),s((y,C)=>P(y,C,!0)),e(()=>{v()})},kt=()=>{const{addEventResize:t}=S(),{render:e,setIntersections:a}=ot({}),{render:h,point:s}=Rt(),{render:c,point:n}=It(),{render:o,point:i}=Pt();return t(()=>{const r=i(),l=s(),d=n();a((u,f,p)=>!z({x:u,y:f,r:p},r)&&!z({x:u,y:f,r:p},l)&&!z({x:u,y:f,r:p},d))}),()=>{e(),h(),c(),o()}},zt=()=>{const t=rt(),{popits:e,render:a}=st({palette:t});return Wt(e),()=>{a()}},Ht=()=>{const t="#ff6347",{setBackground:e}=S(),{minusDifficulty:a}=H(),{render:h}=st({palette:t,retry:!0});return e(t),a(),()=>{h()}},_t=()=>{const{addEventClick:t,navigate:e}=S(),{plusDifficulty:a}=H();rt();const{render:h}=ct();return t(()=>{e("game")}),a(),()=>{h()}},Lt=()=>{const{addEventResize:t}=S(),{render:e,setIntersections:a}=ot({color:"#ffeb3b",frequency:10}),{render:h,rect:s,up:c,down:n}=ct(),{render:o,point:i}=St(),{point:r}=wt(c),{point:l}=xt(n);return t(()=>{const d=i(),u=s(),f=r(),p=l();a((m,g,M)=>!z({x:m,y:g,r:M},d)&&!mt({x:m,y:g,r:M},u)&&!z({x:m,y:g,r:M},f)&&!z({x:m,y:g,r:M},p))}),()=>{e(),h(),o()}},Ft=()=>{const{ctx:t,addEventResize:e,loop:a}=S(),h={x:40,y:100};let s=1,c=1,n;const o=()=>{n=5*Math.ceil(Math.sqrt(innerWidth*innerWidth+innerHeight*innerHeight)/144)};return o(),e(o),a(()=>{h.x+=2*s,h.y+=3*c,s*=-1,c*=-1}),()=>{t.save();var i=Math.random()*2,r=Math.random()*3;t.translate(i,r),t.beginPath(),t.fillStyle="red",t.rect(h.x,h.y,n,n),t.fill(),t.restore()}},Ot=[{name:"opening",ctor:Et},{name:"main",ctor:kt},{name:"game",ctor:zt},{name:"gameover",ctor:Ht},{name:"gamescore",ctor:_t},{name:"score",ctor:Lt},{name:"devs",ctor:Ft}],$t=["/sounds/tapfast.wav"];yt(Ot,$t);document.title="Your's last Popit";
