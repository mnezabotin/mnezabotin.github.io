(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))f(r);new MutationObserver(r=>{for(const s of r)if(s.type==="childList")for(const i of s.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&f(i)}).observe(document,{childList:!0,subtree:!0});function a(r){const s={};return r.integrity&&(s.integrity=r.integrity),r.referrerPolicy&&(s.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?s.credentials="include":r.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function f(r){if(r.ep)return;r.ep=!0;const s=a(r);fetch(r.href,s)}})();const ve=()=>{const e=document.createElement("canvas"),n=e.getContext("2d");if(!n)throw new Error("CanvasRenderingContext2D is null");const a=()=>{e.width=innerWidth*devicePixelRatio,e.height=innerHeight*devicePixelRatio,n.scale(devicePixelRatio,devicePixelRatio),e.style.width=`${innerWidth}px`,e.style.height=`${innerHeight}px`},f=o=>{n.clearRect(0,0,innerWidth,innerHeight),o()};return a(),document.body.appendChild(e),{ctx:n,render:f,resize:a,rotate:(o,t,l,p)=>{n.save(),n.translate(t,l),n.rotate(Math.PI*p),n.translate(-t,-l),o(),n.restore()},translate:(o,t,l)=>{n.save(),n.translate(t,l),o(),n.restore()},shade:(o,t)=>{o=o.substring(1);const l=parseInt(o,16),p=Math.round(2.55*t),h=(l>>16)+p,c=(l>>8&255)+p,g=(l&255)+p;return"#"+(16777216+(h<255?h<1?0:h:255)*65536+(c<255?c<1?0:c:255)*256+(g<255?g<1?0:g:255)).toString(16).slice(1)},setBackground:(o,t)=>{var l;document.body.style.background=o,document.body.style.backgroundColor=t||o,(l=document.querySelector('meta[name="theme-color"]'))==null||l.setAttribute("content",t||o)},createImg:(o,t,l=t)=>{const p=document.createElement("canvas"),h=p.getContext("2d");if(!h)throw new Error("CanvasRenderingContext2D is null");return p.width=t*devicePixelRatio,p.height=l*devicePixelRatio,h.scale(devicePixelRatio,devicePixelRatio),o(h),p}}},Pe=e=>{let n="",a="",f;const r=u=>e.find(d=>d.name===u)||e[0],i={render:()=>{},navigate:(u,d)=>{const o=r(u);a=n||"",n=(o==null?void 0:o.name)||"",f=d,i.render=(o==null?void 0:o.ctor())||(()=>{})},useScreenMeta:()=>({to:n,from:a,data:f})};return i},Ee=()=>{const e=requestAnimationFrame||(i=>setTimeout(i,16.666666666666668)),n=[],a={};return{loop:(i,u)=>{if(Object.entries(a).find(([o,t])=>t===i)||u&&a[u])throw new Error(`Loop${u?" "+u:""} already specified`);u&&n.push(u),u=u||new Date().valueOf().toString(),a[u]=i;const d=()=>{i(),a[u]&&e(d)};d()},stop:i=>{if(typeof i=="string")delete a[i];else{const u=Object.entries(a).find(([d,o])=>o===i);u&&delete a[u[0]]}},stopAll:()=>{for(const i in a)n.indexOf(i)===-1&&delete a[i]}}};let X=[];const Se=()=>{for(const e of X)clearTimeout(e);X=[]},xe=(e,n=400)=>{let a=new Date,f=n,r=setTimeout(e,f);return X.push(r),{pause:()=>{clearTimeout(r),f-=new Date-a},resume:()=>{a=new Date,clearTimeout(r),r=setTimeout(e,f),X.push(r)},stop:()=>{clearTimeout(r)}}},oe=2147483646,V=2147483647,we=16807,Ce=(e=Math.floor(Math.random()*V))=>{e=e%V,e<=0&&(e+=oe);const n=()=>(e=e*we%V,e),a=()=>(n()-1)/oe;return(r,s)=>(s===void 0&&(s=r,r=0),Math.floor(a()*(s-r+1))+r)},be=(e,n)=>(n===void 0&&(n=e,e=0),Math.floor(Math.random()*(n-e+1))+e),Re=()=>{const e=[],n=[],a=[];return{addEventResize:t=>{t(),e.push(t)},onResizeEvents:()=>e.forEach(t=>t()),addEventClick:t=>n.push(t),onClickEvents:(t,l)=>n.forEach(p=>p(t,l)),addEventMove:t=>a.push(t),onMoveEvents:(t,l)=>a.forEach(p=>p(t,l)),removeAllEvents:()=>{e.splice(0),n.splice(0),a.splice(0)}}},L=(e,n)=>{const a=Math.pow(Math.abs(e.x-n.x),2),f=Math.pow(Math.abs(e.y-n.y),2),r=e.r||0,s=n.r||0,i=Math.pow(r+s,2);return a+f<=i},Ie=(e,n)=>{const a=e.r||0,f=n.w||0,r=n.h||0;return Math.abs(n.x+f/2-e.x)<=f/2+a&&Math.abs(n.y+r/2-e.y)<=r/2+a},Te=(e,n)=>L(e,n),We=()=>{let e=new AudioContext,n={};return async a=>{const f=e.createBufferSource();n[a]||(n[a]=await fetch(a).then(r=>r.arrayBuffer()).then(r=>(e==null?void 0:e.decodeAudioData(r))||null)),f.buffer=n[a],f.connect(e.destination),f.start()}};let j;const He=e=>{if(j)throw new Error("Webcore already specified");const n=ve(),a=Pe(e),{loop:f,stop:r,stopAll:s}=Ee(),{addEventResize:i,onResizeEvents:u,addEventClick:d,onClickEvents:o,addEventMove:t,onMoveEvents:l,removeAllEvents:p}=Re();let h=innerWidth/2,c=innerHeight/2,g=innerWidth<innerHeight?innerWidth:innerHeight,m=Math.ceil(Math.sqrt(innerWidth*innerWidth+innerHeight*innerHeight)/144),P=innerWidth>innerHeight;const M=()=>({cx:h,cy:c,s:g,m,isL:P}),v=We();j={font:"Tijuf",ctx:n.ctx,shade:n.shade,rotate:n.rotate,translate:n.translate,setBackground:n.setBackground,createImg:n.createImg,useMeasure:M,useScreenMeta:a.useScreenMeta,navigate:(y,E)=>{if(!e.some(x=>x.name===y))throw new Error(`Screen ${y} not specified`);s(),Se(),p(),new Promise(()=>a.navigate(y,E))},loop:f,loopStop:r,useTimer:xe,rand:be,useRandChain:Ce,intersect:Te,addEventResize:i,addEventClick:d,addEventMove:t,playSound:v},f(()=>n.render(a.render),"draw"),window.onresize=()=>{h=innerWidth/2,c=innerHeight/2,g=innerWidth<innerHeight?innerWidth:innerHeight,m=Math.ceil(Math.sqrt(innerWidth*innerWidth+innerHeight*innerHeight)/144),P=innerWidth>innerHeight,n.resize(),u()},document.onpointerdown=y=>{o(y.clientX,y.clientY)},document.onmousemove=y=>{l(y.clientX,y.clientY)},a.navigate()},w=()=>{if(!j)throw new Error("Webcore not specified");return{...j}},U={},W=e=>{const{shade:n,ctx:a,createImg:f}=w(),r=()=>{const{r:i,c:u="#ffffff",p:d}=e,o=a.createRadialGradient(i,i,i,i,i,i/5);return o.addColorStop(0,n(u,0)),o.addColorStop(.01,n(u,0)),o.addColorStop(.075,n(u,9)),o.addColorStop(.15,n(u,0)),o.addColorStop(.15,n(u,-15)),o.addColorStop(.18,n(u,-5)),o.addColorStop(.22,n(u,-15)),d?(o.addColorStop(.24,n(u,-10)),o.addColorStop(.3,n(u,-8)),o.addColorStop(.34,n(u,-12)),o.addColorStop(.6,n(u,-6)),o.addColorStop(1,n(u,-4))):(o.addColorStop(.24,n(u,-12)),o.addColorStop(.26,n(u,-8)),o.addColorStop(.3,n(u,-2)),o.addColorStop(.34,n(u,0)),o.addColorStop(.5,n(u,5)),o.addColorStop(1,n(u,12))),o},s=()=>{const{r:i,c:u="#ffffff",p:d}=e,o=`${u}_${d?"push":"pop"}_${i}`;if(U[o])return U[o];const t=f((l=a)=>{const p=r();l.fillStyle=p,l.beginPath(),l.arc(i,i,i,0,2*Math.PI),l.closePath(),l.fill()},2*i);return U[o]=t,t};return(i=a)=>{const{x:u,y:d,r:o}=e,t=s();i.drawImage(t,u-o,d-o,2*o,2*o)}},K={},N=e=>{const{ctx:n}=w();let a;return K[e.src]?a=K[e.src]:(a=new Image,a.src=e.src,K[e.src]=a),(f=n)=>{const{w:r,h:s=r,x:i=0,y:u=0}=e;a.complete&&f.drawImage(a,i,u,r,s)}},re=e=>{const{font:n,ctx:a}=w(),f=e.text,r=e.text.length,s=2*Math.PI/r/4;return(i=a)=>{const{x:u,y:d,r:o,s:t=0,fs:l}=e,p=l||Math.round(o/4);i.textAlign="center",i.fillStyle="#f9f9f9",i.font=`${p}px ${n}`,i.save(),i.translate(u,d),i.rotate(t);for(let h=0;h<r;h++)i.save(),i.rotate(h*s),i.fillText(f[h],0,-o),i.restore();i.restore()}},ke=()=>{var M,v;const{ctx:e,loop:n,rotate:a,navigate:f,useMeasure:r,addEventClick:s,addEventResize:i,setBackground:u}=w();u("#040404");let d=!1,o,t,l,p,h,c=-.2,g=0;i(()=>{const{cx:y,cy:E,s:x}=r(),S=Math.round(x*.25);o={c:"#ff6347",x:y,y:E,r:S,p:!1},t=W(o),l=N({x:y-S+Math.round(S*.35),y:E-S+Math.round(S*.35),w:S*2-Math.round(S*.7),src:"/media/sloth.svg"}),p=re({text:"nezabotin",x:y,y:E,r:Math.round(S*1.1),s:Math.PI*1.6}),h=re({text:"production",x:y,y:E,r:Math.round(S*1.1),s:Math.PI*2.6})});const m=()=>{c+=.01,g=c>=1?1:c,c>=1.8&&(o.p=!0),c>=2.2&&(o.c="#f86a9a"),c>=2.6&&f("main")};s(()=>{[1.4,1.8,2.2,2.6].some(y=>{if(c<y)return c=y,!0})});const P=()=>{n(m),d=!0};return(M=document==null?void 0:document.fonts)!=null&&M.ready?(v=document==null?void 0:document.fonts)==null||v.ready.then(P):P(),()=>{const{cx:y,cy:E}=r();e.globalAlpha=d?1:0,t(),c<1.8&&l(),c<1.4&&a(()=>{p(),h()},y,E,g),e.globalAlpha=1}},ue=["/sounds/pop1.mp3","/sounds/pop2.mp3","/sounds/pop3.mp3","/sounds/pop4.mp3","/sounds/pop5.mp3"];let k=[...ue];const te=()=>{const{rand:e,playSound:n}=w();return{playPop:()=>{const f=e(k.length-1),r=k[f];k.splice(f,1),k.length||(k=[...ue]);const s=e(k.length-1);k=[...k.splice(s,k.length),...k],n(r)}}},F=100/2;let se=0;const O=()=>{const{loop:e,ctx:n,shade:a,rand:f}=w(),{playPop:r}=te(),s={},i=()=>{for(const o in s){const t=s[o];if(!t)return;const l=t.popit;if(!t.shake)t.tic+=F/5,t.tic>=F&&(t.dir=-1),t.withoutRad||(l.r=t.origR+t.origR*75e-5*(t.tic+(t.dir>0?0:F-t.tic)));else{t.tic+=F/5;const p=f(1,2),h=f(1,2);l.x=t.origX+Math.random()*p*(Math.random()>.5?1:-1),l.y=t.origY+Math.random()*h*(Math.random()>.5?1:-1)}t.tic>=2*F&&(delete s[o],l.r=t.origR,l.x=t.origX,l.y=t.origY)}},u=(o,t=!1,l=!1)=>{!l&&!t&&r(),se++;const p=`${new Date().valueOf().toString()}_${se}`,h=1,c=1;s[p]={withoutRad:t,tic:h,dir:c,popit:o,origR:o.r,origX:o.x,origY:o.y,shake:l}},d=()=>{n.globalAlpha=.25;for(const o in s){const t=s[o];if(t.shake)continue;const l=t.popit;n.fillStyle=a(l.c||"red",-12),n.beginPath(),n.arc(l.x,l.y,l.r+t.origR*.001*(t.tic+(t.dir>0?0:F-t.tic)),0,Math.PI*2),n.closePath(),n.fill()}n.globalAlpha=1};return e(i),{popEffect:u,render:d}},ee=e=>{const{font:n,ctx:a}=w();return(f=a)=>{const{text:r,x:s,c:i,y:u,fs:d,a:o="center",mw:t}=e;f.textAlign=o,f.fillStyle=i,f.font=`${d}px ${n}`,f.fillText(r,s,u,t)}},Y=100,fe=e=>{const{loop:n,ctx:a,useMeasure:f,rand:r}=w();let s=null;const i=()=>{if(!s)return;const{m:o}=f();if(s.tic<=Y)s.props.fs=((e==null?void 0:e.mfs)||6)/Y*s.tic*o;else{const t=r(1,1),l=r(1,1);s.props.x=s.origX+Math.random()*t*(Math.random()>.5?1:-1),s.props.y=s.origY+Math.random()*l*(Math.random()>.5?1:-1),s.shake=!0}s.tic+=s.tic>Y?1:10,s.tic>Y*2&&!(e!=null&&e.infinity)&&(s=null)},u=o=>{const{cx:t,m:l}=f(),p=0,h={x:t,y:Math.round(l*((e==null?void 0:e.dy)||16)),text:o,c:(e==null?void 0:e.color)||"#ffffff",fs:0},c=ee(h);s={props:h,shape:c,tic:p,origX:h.x,origY:h.y}},d=()=>{s&&(a.globalAlpha=.01*s.tic,s.shape(),a.globalAlpha=1)};return n(i),{splashEffect:u,render:d}},De=({color:e="#ba68c8",popEffect:n=()=>{}})=>{const{addEventResize:a,useMeasure:f,useTimer:r,useScreenMeta:s,navigate:i,addEventClick:u,intersect:d}=w(),{from:o}=s();let t,l,p;return a(()=>{const{cx:g,cy:m,s:P,m:M}=f(),v=Math.round(P*.25);t={c:e,r:Math.round(P*.08),x:g-v-1*M,y:m-v+1*M,p:(o==="score"||o==="opening")&&!t},l=W(t),p=N({x:Number(t.x)-t.r+Math.round(t.r*.5),y:Number(t.y)-t.r+Math.round(t.r*.5),w:t.r*2-Math.round(t.r*1),src:"/media/star.svg"})}),r(()=>{t.p&&n(t,!1,!0),t.p=!1}),u((g,m)=>{d({x:g,y:m},t)&&(n(t),t.p=!0,r(()=>{i("score")},100))}),{render:()=>{l(),t.p||p()},point:()=>({x:t.x,y:t.y,r:t.r})}},Ae=({color:e="#ff6347",popEffect:n=()=>{}})=>{const{addEventResize:a,useMeasure:f,useTimer:r,useScreenMeta:s,navigate:i,addEventClick:u,intersect:d}=w(),{from:o}=s();let t,l,p;return a(()=>{const{s:g}=f(),m=Math.round(g*.08);t={c:e,r:m,x:Math.round(1.6*m),y:Math.round(1.6*m),p:o==="main"&&!t},l=W(t),p=N({x:Number(t.x)-m+Math.round(m*.4),y:Number(t.y)-m+Math.round(m*.4),w:m*2-Math.round(m*.8),src:"/media/back.svg"})}),r(()=>{t.p&&n(t,!1,!0),t.p=!1}),u((g,m)=>{d({x:g,y:m},t)&&(n(t),t.p=!0,r(()=>{i("main")},100))}),{render:()=>{l(),t.p||p()},point:()=>({x:t.x,y:t.y,r:t.r})}},ze=({onClick:e})=>{const{addEventResize:n,useMeasure:a,useTimer:f,addEventClick:r,intersect:s,rotate:i}=w(),{playPop:u}=te();let d,o,t;return n(()=>{const{s:h}=a(),c=Math.round(h*.08);d={c:"#ff6347",r:c,x:Math.round(innerWidth-1.6*c),y:Math.round(innerHeight-1.6*c),p:!1},o=W(d),t=N({x:Number(d.x)-c+Math.round(c*.4),y:Number(d.y)-c+Math.round(c*.4),w:c*2-Math.round(c*.8),src:"/media/back.svg"})}),r((h,c)=>{s({x:h,y:c},d)&&(u(),d.p=!0,e(),f(()=>{d.p=!1},100))}),{render:()=>{o(),d.p||i(()=>{t()},d.x,d.y,innerHeight>innerWidth?-1:-.5)},point:()=>({x:d.x,y:d.y,r:d.r})}},Le=({onClick:e})=>{const{addEventResize:n,useMeasure:a,useTimer:f,addEventClick:r,intersect:s,rotate:i}=w(),{playPop:u}=te();let d,o,t;return n(()=>{const{s:h}=a(),c=Math.round(h*.08),g=innerWidth<innerHeight?Math.round(innerWidth-1.6*c-2*c-.3*c):Math.round(innerWidth-1.6*c),m=innerWidth<innerHeight?Math.round(innerHeight-1.6*c):Math.round(innerHeight-1.6*c-2*c-.3*c);d={c:"#ff6347",r:c,x:g,y:m,p:!1},o=W(d),t=N({x:Number(d.x)-c+Math.round(c*.4),y:Number(d.y)-c+Math.round(c*.4),w:c*2-Math.round(c*.8),src:"/media/back.svg"})}),r((h,c)=>{s({x:h,y:c},d)&&(u(),d.p=!0,e(),f(()=>{d.p=!1},100))}),{render:()=>{o(),d.p||i(()=>{t()},d.x,d.y,innerHeight>innerWidth?0:.5)},point:()=>({x:d.x,y:d.y,r:d.r})}},_e=e=>{const{ctx:n,shade:a}=w(),f=Math.round(e.r/2.2),r=Math.round(.15*e.r),s=a(e.c||"blue",-3);return(i=n)=>{const{r:u,x:d=u,y:o=u}=e;i.lineCap="round",i.fillStyle=s,i.strokeStyle=s,i.lineWidth=f,i.beginPath(),i.moveTo(d+r,o),i.lineTo(d-r/2,o-r),i.lineTo(d-r/2,o+r),i.closePath(),i.fill(),i.beginPath(),i.moveTo(d+r,o),i.lineTo(d-r/2,o-r),i.moveTo(d-r/2,o-r),i.lineTo(d-r/2,o+r),i.moveTo(d-r/2,o+r),i.lineTo(d+r,o),i.stroke()}},he=({getX:e,getY:n,color:a="#bef181",popEffect:f=()=>{}})=>{const{addEventResize:r,useMeasure:s,useTimer:i,useScreenMeta:u,navigate:d,addEventClick:o,intersect:t}=w(),{from:l}=u();let p,h,c;return r(()=>{const{cx:P,cy:M,s:v,m:y}=s();p={c:a,r:Math.round(v*.1),x:e(P,v,y),y:n(M,v,y),p:(l==="gamescore"||l==="game"||l==="opening")&&!p},h=W(p),c=_e(p)}),i(()=>{p.p&&f(p,!1,!0),p.p=!1}),o((P,M)=>{t({x:P,y:M},p)&&(f(p),p.p=!0,i(()=>{d("game")},100))}),{render:()=>{h(),p.p||c()},point:()=>({x:p.x,y:p.y,r:p.r})}},pe=e=>{const{ctx:n,shade:a}=w(),f=Math.round(e.r/4),r=Math.round(.12*e.r);return(s=n)=>{const{r:i,x:u=i,y:d=i}=e,o=a(e.c||"blue",-3);s.lineCap="round",s.strokeStyle=o,s.lineWidth=f,s.beginPath(),s.moveTo(u-1.5*r,d-2*r),s.lineTo(u-1.5*r,d+2*r),s.stroke(),s.beginPath(),s.moveTo(u+1.5*r,d-2*r),s.lineTo(u+1.5*r,d+2*r),s.stroke()}},Fe=({getX:e,getY:n,popEffect:a=()=>{}})=>{const{addEventResize:f,useMeasure:r,useTimer:s,useScreenMeta:i,navigate:u,addEventClick:d,intersect:o}=w(),{from:t}=i();let l,p,h;return f(()=>{const{cx:m,cy:P,s:M,m:v}=r();l={c:"#fd8059",r:Math.round(M*.08),x:e(m,M,v),y:n(P,M,v),p:(t==="game"||t==="opening")&&!l},p=W(l),h=pe(l)}),s(()=>{l.p&&a(l,!1,!0),l.p=!1},500),d((m,P)=>{o({x:m,y:P},l)&&(a(l),l.p=!0,s(()=>{u("main")},100))}),{render:()=>{p(),l.p||h()},point:()=>({x:l.x,y:l.y,r:l.r})}},$e=({color:e="#f86a9a",popEffect:n=()=>{}})=>{const{addEventResize:a,useMeasure:f,useTimer:r,useScreenMeta:s,addEventClick:i,intersect:u,navigate:d}=w(),{from:o}=s();let t,l,p,h;return a(()=>{const{cx:m,cy:P,s:M}=f(),v=Math.round(M*.25);t={c:e,x:m,y:P,r:v,p:o==="opening"&&!t},l=W(t),p=ee({text:"Yola",c:"#f1f1f1",x:m,y:P-v+Math.round(v*.9),fs:Math.round(v/2.6),mw:v*2}),h=ee({text:"PopiT",c:"#ffeb3b",x:m,y:P-v+Math.round(v*1.3),fs:Math.round(v/2.3),mw:v*2})}),r(()=>{t.p&&n(t,!1,!0),t.p=!1}),i((m,P)=>{u({x:m,y:P},t)&&(n(t),t.p=!0,r(()=>{d("opening")},100))}),{render:()=>{l(),t.p||(p(),h())},point:()=>({x:t.x,y:t.y,r:t.r})}},ge=({color:e="#00dcfe",frequency:n=20})=>{const{addEventResize:a,useRandChain:f,useMeasure:r,rand:s,useTimer:i,setBackground:u,useScreenMeta:d}=w(),{from:o}=d();u(e);const t=s(0,999);let l=[],p=[];a(()=>{const m=f(t),{s:P}=r();l=[];const M=Math.round(P*.05),v=Math.round(innerWidth/M/2)-1,y=Math.round((innerWidth-2*M*v)/(v+1)),E=Math.round(innerHeight/M/2)-1,x=Math.round((innerHeight-2*M*E)/(E+1));for(let S=0;S<E;S++)for(let R=0;R<v;R++)m(m(n))<1&&l.push({x:y+M+R*M*2+y*R,y:x+M+S*M*2+x*S,r:M,c:e,p:o==="opening"?!0:m(1)>0});p=l.map(S=>W(S))});const h=()=>{i(()=>{const m=s(l.length-1);l[m]&&(l[m].p=!l[m].p),h()},250)};return o==="opening"?i(()=>{l.forEach(m=>m.p=s(1)>0),h()}):h(),{render:()=>{p.forEach(m=>m())},setIntersections:m=>{l=l.filter(({x:P,y:M,r:v})=>m(P,M,v)),p=l.map(P=>W(P))}}},ie="ylp",ce="score",J="difficulty",Q=[.14,.11,.09,.075],ae=750,Be=350,de=5,z=[];for(let e=0;e*de<=ae-Be;e++)z.push(ae-e*de);const $=()=>{const e=p=>localStorage.getItem(`${ie}_${p}`),n=(p,h)=>localStorage.setItem(`${ie}_${p}`,h.toString()),a=()=>+(e(ce)||0),f=p=>n(ce,p),r=p=>{const h=a();f(h+p)},s=()=>+(e(J)||0),i=p=>{const h=s();n(J,Math.min(Math.max(h+p,0),Q.length*z.length-1))};return{getScore:a,addScore:r,plusDifficulty:()=>i(1),minusDifficulty:()=>i(-5),getDifficultyRad:()=>{const p=s(),h=Math.floor(p/z.length);return Q[h]||Q[1]},getDifficultyTic:()=>{const p=s(),h=Math.floor(p/z.length),c=p-h*z.length;return z[c]||z[0]},resetDifficulty:()=>n(J,0)}},me=(e=!1)=>{let n=["#f86a9a","#C69FEE","#5bb2f7","#92E6E6","#7ceab2","#bef181","#EFCD74","#fd8059"];const{addEventResize:a,useMeasure:f,setBackground:r,rand:s}=w(),{getDifficultyRad:i}=$();return n=[...n.splice(s(n.length-1),n.length),...n],e||a(()=>{const{s:d}=f(),o=i(),t=Math.round(d*o),l=Math.round(innerWidth/t/2)-1,p=(innerWidth-2*t*l)/(l+1),h=Math.round(innerHeight/t/2)-1,c=(innerHeight-2*t*h)/(h+1),g=innerWidth>=innerHeight,m=g?l:h,P=g?p:c,M=g?innerWidth:innerHeight;let v=0;const y=[];for(let x=0;x<m;x++)n[v]||(v=0),y.push(`${n[v]} ${(P+t+x*t*2+P*x)/M*100}%`),v++;r(`linear-gradient(${g?"to right":"to bottom"}, ${y.join(", ")})`,innerWidth<innerHeight?n[0]:"#040404")}),n},Me=({palette:e,retry:n,popEffect:a=()=>{}})=>{const{addEventResize:f,useMeasure:r,rand:s,useTimer:i,useScreenMeta:u,navigate:d,addEventClick:o,intersect:t}=w(),{from:l}=u(),{getDifficultyRad:p}=$(),h=[];let c=[],g,m,P,M;const v=E=>Array.isArray(e)?e[E]:e;return f(()=>{const{s:E}=r();h.splice(0);const x=p(),S=Math.round(E*x),R=Math.round(innerWidth/S/2)-1,_=(innerWidth-2*S*R)/(R+1),D=Math.round(innerHeight/S/2)-1,B=(innerHeight-2*S*D)/(D+1),I=innerWidth>=innerHeight;let b=0;for(let T=0;T<D;T++){for(let C=0;C<R;C++){v(b)||(b=0);const H={x:_+S+C*S*2+_*C,y:B+S+T*S*2+B*T,r:S,c:v(b),p:!0};T===0&&C===R-1?(M={...H,p:(l==="main"||l==="gameover"||l==="gamescore")&&!M},g=W(M),m=pe(M)):h.push(H),b+=I?1:0}b=I?0:b+1}n&&(P=h[s(h.length-1)],i(()=>{a(P,!1,!0),P.p=!1})),c=h.map(T=>W(T))}),i(()=>{M.p&&a(M,!1,!0),M.p=!1}),n&&o((E,x)=>{t({x:E,y:x},P)&&(a(P),P.p=!0,i(()=>{d("game")},100))}),o((E,x)=>{t({x:E,y:x},M)&&(a(M),M.p=!0,i(()=>{d("main")},100))}),{render:()=>{c.forEach(E=>E()),g(),M!=null&&M.p||m()},popits:h}},A=100,G="#222",Ne=e=>{const n=(e==null?void 0:e[0])||0,a=(e==null?void 0:e[1])||0,f=(e==null?void 0:e[2])||0;return"#"+(16777216+(n<255?n<1?0:n:255)*65536+(a<255?a<1?0:a:255)*256+(f<255?f<1?0:f:255)).toString(16).slice(1)},Z={},Oe=e=>{const{ctx:n,createImg:a,useRandChain:f,useTimer:r}=w();let s,i=!1,u=[];const d=e.r*2/A/2;Z[e.imgSrc]?s=Z[e.imgSrc]:(s=Z[e.imgSrc]={img:new Image,cols:[],isFilled:!1,r:e.r,drawImg:null,score:e.score},s.img.src=e.imgSrc);const o=()=>r(()=>{i=!i,o()},250),t=(g,m=n)=>{const{x:P,y:M,c:v,r:y}=g;m.fillStyle=v||"red",m.beginPath(),m.arc(P+y,M+y,y,0,Math.PI*2),m.closePath(),m.fill()},l=(g=n,m=0,P=0)=>{g.fillStyle=G,g.beginPath(),g.roundRect(m,P,2*e.r,2*e.r,d),g.closePath(),g.fill()},p=()=>{const g=[];for(let y=0;y<A;y++)for(let E=0;E<A;E++){const x={x:E*d*2,y:y*d*2,r:d,c:G};g.push(x)}let m=e.score-e.winScore;const P=[...g],M=f(e.seed),v=(y=!1)=>{const E=M(P.length-1),x=P[E],S=g.indexOf(x);x.c=y?G:s.cols[S],P.splice(E,1),y&&u.push({...x,c:s.cols[S]})};for(let y=m;y>0;y--)v();if(e.winScore){u=[];for(let y=e.winScore;y>0;y--)v(!0);o()}return g},h=()=>{const g=p();s.drawImg=a((m=n)=>{l(m),g.filter(P=>P.c!==G).forEach(P=>t(P,m))},2*e.r)},c=async()=>{var P;const g=document.createElement("canvas");g.width=A,g.height=A;const m=g.getContext("2d",{willReadFrequently:!0});m==null||m.drawImage(s.img,0,0);for(let M=0;M<A;M++){const v=[];for(let y=0;y<A;y++){const E=(P=m==null?void 0:m.getImageData(y,M,1,1))==null?void 0:P.data;v.push(Ne(E))}s.cols.push(...v)}s.isFilled=!0,h()};return s.isFilled?(s.r!==e.r||s.score!==e.score)&&h():s.img.onload=c,(g=n)=>{const{x:m,y:P,r:M,winScore:v}=e;if(s.drawImg?g.drawImage(s.drawImg,m-M,P-M,2*M,2*M):l(g,m-M,P-M),i&&v&&s.drawImg)for(const y of u)g.fillStyle=y.c||"red",g.beginPath(),g.arc(m-M+y.x+y.r,P-M+y.y+y.r,y.r,0,Math.PI*2),g.closePath(),g.fill()}},le=1e4,ye=(e=0,n=!1)=>{const{addEventResize:a,useMeasure:f,translate:r}=w(),{getScore:s}=$(),i=["/media/levels/cat.png","/media/levels/city.png","/media/levels/girl.png","/media/levels/home.png","/media/levels/iron.png","/media/levels/wolf.png","/media/levels/max.png"],u=s();let d,o=0,t=0,l=!1,p=!1;const h=v=>Math.min(Math.floor(v/le),i.length-1);let c=h(u-e);if(e){const v=h(u);l=v!==c,p=v>i.length-1}return a(()=>{const{cx:v,cy:y,s:E,isL:x}=f();d=[],o=(E-2*E*.055*1.6)/2,t=E*.05;let S=n?c:0;for(S;S<(n?c+1:i.length);S++){const R=i[S],_=x?v:v+S*o*2+S*t,D=x?y+S*o*2+S*t:y;d.push(Oe({x:_,y:D,r:o,score:Math.min(u-S*le,1e4),imgSrc:R,winScore:e,seed:S}))}}),{up:()=>{c=c+1<i.length?c+1:i.length-1},down:()=>{c=c-1<0?0:c-1},render:()=>{const{isL:v}=f(),y=v?0:-(c*o*2+c*t),E=v?-(c*o*2+c*t):0;r(()=>{d==null||d.forEach(x=>x())},y,E)},rect:()=>{const{cx:v,cy:y}=f(),E=innerWidth>innerHeight;return{x:E?v-o:0,y:E?0:y-o,w:E?2*o:innerWidth,h:E?innerHeight:2*o}},isJump:l,isCompleted:p}},Ye=({popits:e,popEffect:n=()=>{},splashEffect:a=()=>{}})=>{const{useTimer:f,rand:r,addEventClick:s,addEventMove:i,intersect:u,navigate:d,addEventResize:o}=w(),{getScore:t,addScore:l,getDifficultyTic:p}=$();let h=[],c,g,m=!1,P=0,M=0,v=0;const y=t(),E=p(),x=I=>{const b=e.filter(H=>h.indexOf(H)===-1&&H!==I),T=r(b.length-1),C=b[T];C&&(n(C,!1,!0),C.p=!1,h.push(b[T]))},S=()=>{g=f(()=>{if(v=Math.max(v-10,50),e.length===h.length){m=!0,g.stop(),f(()=>{d("gameover")});return}x(),S()},v)},R=I=>{h=[];const b=e.length;let T=r(Math.round(b*.3),Math.round(b*.6));const C=[...e];if(I){const H=C.indexOf(I);C.splice(H,1)}for(let H=T;H>0;H--){const ne=r(C.length-1),q=C[ne];q.p=!1,n(q,!1,!0),h.push(q),C.splice(ne,1)}v=E,c==null||c.stop(),g==null||g.stop(),y&&(c=f(()=>{a("SLOWLY"),S()},h.length*E)),P=P>0?P:r(3,5)},_=()=>y<1e4?10:y<2e4?5:y<3e4?2:1,D=I=>{n(I),v=Math.min(v+5,E),M++,I.p=!0;const b=h.indexOf(I);if(h.splice(b,1),h.length<=0)if(P--,P>0)f(()=>{a("Round"),R(I)},100);else{c==null||c.stop(),g==null||g.stop();const T=_();l(M*T),f(()=>{d("gamescore",{winScore:M*T})},100)}},B=(I,b,T=!1)=>{if(!m){for(const C of h)if(u({x:I,y:b},C)){D(C);return}if(!T){for(const C of e)if(u({x:I,y:b},C)){n(C,!0),a("Popenalty"),x(C);return}a("Popenalty"),x()}}};s(B),i((I,b)=>B(I,b,!0)),o(()=>{f(()=>{a("Pop it"),R()})})},Ge=()=>{const{addEventResize:e,rand:n,useScreenMeta:a}=w(),{from:f}=a(),{popEffect:r,render:s}=O(),i=["#00dcfe","#5bb2f7","#92E6E6"],u=f==="opening"?i[0]:i[n(i.length-1)],{render:d,setIntersections:o}=ge({color:u}),{render:t,point:l}=$e({popEffect:r}),{render:p,point:h}=he({getX:(m,P,M)=>m+Math.round(P*.25)+2*M,getY:(m,P,M)=>m+Math.round(P*.25)+0*M,popEffect:r}),{render:c,point:g}=De({popEffect:r});return e(()=>{const m=g(),P=l(),M=h();o((v,y,E)=>!L({x:v,y,r:E},m)&&!L({x:v,y,r:E},P)&&!L({x:v,y,r:E},M))}),()=>{s(),d(),t(),p(),c()}},Xe=()=>{const{useMeasure:e,addEventResize:n}=w(),a=me(),{popEffect:f,render:r}=O(),{popits:s,render:i}=Me({palette:a,popEffect:f}),u={mfs:0,dy:0},{splashEffect:d,render:o}=fe(u);return Ye({popits:s,popEffect:f,splashEffect:d}),n(()=>{const t=(s[0].y-s[0].r)/e().m;u.mfs=t,u.dy=t}),()=>{r(),i(),o()}},je=()=>{const e="#ff6347",{popEffect:n,render:a}=O(),{setBackground:f}=w(),{minusDifficulty:r}=$(),{render:s}=Me({palette:e,retry:!0,popEffect:n});return f(e),r(),()=>{a(),s()}},qe=()=>{const{translate:e,useScreenMeta:n}=w(),{plusDifficulty:a,resetDifficulty:f}=$(),{data:r}=n(),{popEffect:s,render:i}=O(),{splashEffect:u,render:d}=fe({infinity:!0});me();const{render:o,isJump:t}=ye(r==null?void 0:r.winScore,!0),{render:l}=he({getX:(h,c,g)=>innerWidth>innerHeight?Math.min(h+(c-2*c*.055*1.6)/2+4*g+Math.round(c*.1),innerWidth-2*g-Math.round(c*.1)):h+(c-2*c*.055*1.6)/8+0*Math.round(c*.1)+2*g,getY:(h,c,g)=>innerWidth>innerHeight?h+(c-2*c*.055*1.6)/2-1*g-Math.round(c*.1):Math.min(h+(c-2*c*.055*1.6)/2+4*g+Math.round(c*.1),innerHeight-2*g-Math.round(c*.1)),popEffect:s}),{render:p}=Fe({getX:(h,c,g)=>innerWidth>innerHeight?Math.max(h-(c-2*c*.055*1.6)/2-4*g-Math.round(c*.1),2*g+Math.round(c*.1)):h+(c-2*c*.055*1.6)/8-2*Math.round(c*.1)-2*g,getY:(h,c,g)=>innerWidth>innerHeight?h-(c-2*c*.055*1.6)/2+0*g+Math.round(c*.1):Math.min(h+(c-2*c*.055*1.6)/2+4*g+Math.round(c*.1),innerHeight-2*g-Math.round(c*.1)),popEffect:s});return t?f():a(),innerHeight>innerWidth&&u(t?"Picture filled":"You win"),()=>{i(),innerHeight>innerWidth?e(o,0,-Math.round(innerHeight*.05)):o(),l(),p(),d()}},Ve=()=>{const{addEventResize:e,rand:n}=w(),{popEffect:a,render:f}=O(),r=["#ffeb3b","#C69FEE","#5bb2f7","#92E6E6","#7ceab2","#bef181","#EFCD74"],s=r[n(r.length-1)],{render:i,setIntersections:u}=ge({color:s,frequency:10}),{render:d,rect:o,up:t,down:l}=ye(),{render:p,point:h}=Ae({popEffect:a}),{render:c,point:g}=ze({onClick:t,popEffect:a}),{render:m,point:P}=Le({onClick:l,popEffect:a});return e(()=>{const M=h(),v=o(),y=g(),E=P();u((x,S,R)=>!L({x,y:S,r:R},M)&&!Ie({x,y:S,r:R},v)&&!L({x,y:S,r:R},y)&&!L({x,y:S,r:R},E))}),()=>{f(),i(),d(),p(),c(),m()}},Ue=()=>{const{ctx:e,addEventResize:n,loop:a}=w(),f={x:40,y:100};let r=1,s=1,i;const u=()=>{i=5*Math.ceil(Math.sqrt(innerWidth*innerWidth+innerHeight*innerHeight)/144)};return u(),n(u),a(()=>{f.x+=2*r,f.y+=3*s,r*=-1,s*=-1}),()=>{e.save();var d=Math.random()*2,o=Math.random()*3;e.translate(d,o),e.beginPath(),e.fillStyle="red",e.rect(f.x,f.y,i,i),e.fill(),e.restore()}},Ke=[{name:"opening",ctor:ke},{name:"main",ctor:Ge},{name:"game",ctor:Xe},{name:"gameover",ctor:je},{name:"gamescore",ctor:qe},{name:"score",ctor:Ve},{name:"devs",ctor:Ue}];He(Ke);document.title="Your's last Pop it";
