(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))p(o);new MutationObserver(o=>{for(const s of o)if(s.type==="childList")for(const t of s.addedNodes)t.tagName==="LINK"&&t.rel==="modulepreload"&&p(t)}).observe(document,{childList:!0,subtree:!0});function a(o){const s={};return o.integrity&&(s.integrity=o.integrity),o.referrerPolicy&&(s.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?s.credentials="include":o.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function p(o){if(o.ep)return;o.ep=!0;const s=a(o);fetch(o.href,s)}})();const Se=()=>{const e=document.createElement("canvas"),n=e.getContext("2d");if(!n)throw new Error("CanvasRenderingContext2D is null");const a=()=>{e.width=innerWidth*devicePixelRatio,e.height=innerHeight*devicePixelRatio,n.scale(devicePixelRatio,devicePixelRatio),e.style.width=`${innerWidth}px`,e.style.height=`${innerHeight}px`},p=i=>{n.clearRect(0,0,innerWidth,innerHeight),i()};return a(),document.body.appendChild(e),{ctx:n,render:p,resize:a,rotate:(i,r,c,g)=>{n.save(),n.translate(r,c),n.rotate(Math.PI*g),n.translate(-r,-c),i(),n.restore()},translate:(i,r,c)=>{n.save(),n.translate(r,c),i(),n.restore()},shade:(i,r)=>{i=i.substring(1);const c=parseInt(i,16),g=Math.round(2.55*r),M=(c>>16)+g,d=(c>>8&255)+g,f=(c&255)+g;return"#"+(16777216+(M<255?M<1?0:M:255)*65536+(d<255?d<1?0:d:255)*256+(f<255?f<1?0:f:255)).toString(16).slice(1)},setBackground:(i,r)=>{var c;document.body.style.background=i,document.body.style.backgroundColor=r||i,(c=document.querySelector('meta[name="theme-color"]'))==null||c.setAttribute("content",r||i)},createImg:(i,r,c=r)=>{const g=document.createElement("canvas"),M=g.getContext("2d");if(!M)throw new Error("CanvasRenderingContext2D is null");return g.width=r*devicePixelRatio,g.height=c*devicePixelRatio,M.scale(devicePixelRatio,devicePixelRatio),i(M),g}}},Ee=e=>{let n="",a="",p;const o=l=>e.find(u=>u.name===l)||e[0],t={render:()=>{},navigate:(l,u)=>{const i=o(l);a=n||"",n=(i==null?void 0:i.name)||"",p=u,t.render=(i==null?void 0:i.ctor())||(()=>{})},useScreenMeta:()=>({to:n,from:a,data:p})};return t},we=()=>{const e=requestAnimationFrame||(t=>setTimeout(t,16.666666666666668)),n=[],a={};return{loop:(t,l)=>{if(Object.entries(a).find(([i,r])=>r===t)||l&&a[l])throw new Error(`Loop${l?" "+l:""} already specified`);l&&n.push(l),l=l||new Date().valueOf().toString(),a[l]=t;const u=()=>{t(),a[l]&&e(u)};u()},stop:t=>{if(typeof t=="string")delete a[t];else{const l=Object.entries(a).find(([u,i])=>i===t);l&&delete a[l[0]]}},stopAll:()=>{for(const t in a)n.indexOf(t)===-1&&delete a[t]}}};let U=[];const xe=()=>{for(const e of U)clearTimeout(e);U=[]},Ce=(e,n=400)=>{let a=new Date,p=n,o=setTimeout(e,p);return U.push(o),{pause:()=>{clearTimeout(o),p-=new Date-a},resume:()=>{a=new Date,clearTimeout(o),o=setTimeout(e,p),U.push(o)},stop:()=>{clearTimeout(o)}}},re=2147483646,J=2147483647,be=16807,Ie=(e=Math.floor(Math.random()*J))=>{e=e%J,e<=0&&(e+=re);const n=()=>(e=e*be%J,e),a=()=>(n()-1)/re;return(o,s)=>(s===void 0&&(s=o,o=0),Math.floor(a()*(s-o+1))+o)},Re=(e,n)=>(n===void 0&&(n=e,e=0),Math.floor(Math.random()*(n-e+1))+e),Te=()=>{const e=[],n=[],a=[];return{addEventResize:r=>{r(),e.push(r)},onResizeEvents:()=>e.forEach(r=>r()),addEventClick:r=>n.push(r),onClickEvents:(r,c)=>n.forEach(g=>g(r,c)),addEventMove:r=>a.push(r),onMoveEvents:(r,c)=>a.forEach(g=>g(r,c)),removeAllEvents:()=>{e.splice(0),n.splice(0),a.splice(0)}}},H=(e,n)=>{const a=Math.pow(Math.abs(e.x-n.x),2),p=Math.pow(Math.abs(e.y-n.y),2),o=e.r||0,s=n.r||0,t=Math.pow(o+s,2);return a+p<=t},We=(e,n)=>{const a=e.r||0,p=n.w||0,o=n.h||0;return Math.abs(n.x+p/2-e.x)<=p/2+a&&Math.abs(n.y+o/2-e.y)<=o/2+a},ke=(e,n)=>H(e,n),He=e=>{const n=new AudioContext,a={},p=s=>{fetch(s).then(t=>t.arrayBuffer()).then(t=>(n==null?void 0:n.decodeAudioData(t))||null).then(t=>{t&&(a[s]=t)})};if(e.length)for(const s of e)p(s);return s=>{setTimeout(async()=>{const t=n.createBufferSource();a[s]||(a[s]=await fetch(s).then(l=>l.arrayBuffer()).then(l=>(n==null?void 0:n.decodeAudioData(l))||null)),t.buffer=a[s],t.connect(n.destination),t.start()},0)}};let V;const De=(e,n)=>{if(V)throw new Error("Webcore already specified");const a=Se(),p=Ee(e),{loop:o,stop:s,stopAll:t}=we(),{addEventResize:l,onResizeEvents:u,addEventClick:i,onClickEvents:r,addEventMove:c,onMoveEvents:g,removeAllEvents:M}=Te();let d=innerWidth/2,f=innerHeight/2,h=innerWidth<innerHeight?innerWidth:innerHeight,P=Math.ceil(Math.sqrt(innerWidth*innerWidth+innerHeight*innerHeight)/144),m=innerWidth>innerHeight;const y=()=>({cx:d,cy:f,s:h,m:P,isL:m}),v=He(n);V={font:"Tijuf",ctx:a.ctx,shade:a.shade,rotate:a.rotate,translate:a.translate,setBackground:a.setBackground,createImg:a.createImg,useMeasure:y,useScreenMeta:p.useScreenMeta,navigate:(S,w)=>{if(!e.some(E=>E.name===S))throw new Error(`Screen ${S} not specified`);t(),xe(),M(),new Promise(()=>p.navigate(S,w))},loop:o,loopStop:s,useTimer:Ce,rand:Re,useRandChain:Ie,intersect:ke,addEventResize:l,addEventClick:i,addEventMove:c,playSound:v},o(()=>a.render(p.render),"draw"),window.onresize=()=>{d=innerWidth/2,f=innerHeight/2,h=innerWidth<innerHeight?innerWidth:innerHeight,P=Math.ceil(Math.sqrt(innerWidth*innerWidth+innerHeight*innerHeight)/144),m=innerWidth>innerHeight,a.resize(),u()},document.onpointerdown=S=>{r(S.clientX,S.clientY)},document.onmousemove=S=>{g(S.clientX,S.clientY)},p.navigate()},x=()=>{if(!V)throw new Error("Webcore not specified");return{...V}},Q={},W=e=>{const{shade:n,ctx:a,createImg:p}=x(),o=()=>{const{r:t,c:l="#ffffff",p:u}=e,i=a.createRadialGradient(t,t,t,t,t,t/5);return i.addColorStop(0,n(l,0)),i.addColorStop(.01,n(l,0)),i.addColorStop(.075,n(l,9)),i.addColorStop(.15,n(l,0)),i.addColorStop(.15,n(l,-15)),i.addColorStop(.18,n(l,-5)),i.addColorStop(.22,n(l,-15)),u?(i.addColorStop(.24,n(l,-10)),i.addColorStop(.3,n(l,-8)),i.addColorStop(.34,n(l,-12)),i.addColorStop(.6,n(l,-6)),i.addColorStop(1,n(l,-4))):(i.addColorStop(.24,n(l,-12)),i.addColorStop(.26,n(l,-8)),i.addColorStop(.3,n(l,-2)),i.addColorStop(.34,n(l,0)),i.addColorStop(.5,n(l,5)),i.addColorStop(1,n(l,12))),i},s=()=>{const{r:t,c:l="#ffffff",p:u}=e,i=`${l}_${u?"push":"pop"}_${t}`;if(Q[i])return Q[i];const r=p((c=a)=>{const g=o();c.fillStyle=g,c.beginPath(),c.arc(t,t,t,0,2*Math.PI),c.closePath(),c.fill()},2*t);return Q[i]=r,r};return(t=a)=>{const{x:l,y:u,r:i}=e,r=s();t.drawImage(r,l-i,u-i,2*i,2*i)}},Z={},N=e=>{const{ctx:n}=x();let a;return Z[e.src]?a=Z[e.src]:(a=new Image,a.src=e.src,Z[e.src]=a),(p=n)=>{const{w:o,h:s=o,x:t=0,y:l=0}=e;a.complete&&p.drawImage(a,t,l,o,s)}},ie=e=>{const{font:n,ctx:a}=x(),p=e.text,o=e.text.length,s=2*Math.PI/o/4;return(t=a)=>{const{x:l,y:u,r:i,s:r=0,fs:c}=e,g=c||Math.round(i/4);t.textAlign="center",t.fillStyle="#f9f9f9",t.font=`${g}px ${n}`,t.save(),t.translate(l,u),t.rotate(r);for(let M=0;M<o;M++)t.save(),t.rotate(M*s),t.fillText(p[M],0,-i),t.restore();t.restore()}},Ae=()=>{var m,y;const{ctx:e,loop:n,rotate:a,navigate:p,useMeasure:o,addEventClick:s,addEventResize:t,setBackground:l}=x();l("#040404");let u=!1,i,r,c,g,M,d=-.2,f=0;t(()=>{const{cx:v,cy:S,s:w}=o(),E=Math.round(w*.25);i={c:"#ff6347",x:v,y:S,r:E,p:!1},r=W(i),c=N({x:v-E+Math.round(E*.35),y:S-E+Math.round(E*.35),w:E*2-Math.round(E*.7),src:"/media/sloth.svg"}),g=ie({text:"nezabotin",x:v,y:S,r:Math.round(E*1.1),s:Math.PI*1.6}),M=ie({text:"production",x:v,y:S,r:Math.round(E*1.1),s:Math.PI*2.6})});const h=()=>{d+=.01,f=d>=1?1:d,d>=1.8&&(i.p=!0),d>=2.2&&(i.c="#f86a9a"),d>=2.6&&p("main")};s(()=>{[1.4,1.8,2.2,2.6].some(v=>{if(d<v)return d=v,!0})});const P=()=>{n(h),u=!0};return(m=document==null?void 0:document.fonts)!=null&&m.ready?(y=document==null?void 0:document.fonts)==null||y.ready.then(P):P(),()=>{const{cx:v,cy:S}=o();e.globalAlpha=u?1:0,r(),d<1.8&&c(),d<1.4&&a(()=>{g(),M()},v,S,f),e.globalAlpha=1}},ce="ylp",ae="score",ee="difficulty",de="sound",te=[.14,.11,.09,.075],le=750,ze=350,ue=5,_=[];for(let e=0;e*ue<=le-ze;e++)_.push(le-e*ue);let $=null;const D=()=>{const e=d=>localStorage.getItem(`${ce}_${d}`),n=(d,f)=>localStorage.setItem(`${ce}_${d}`,f.toString()),a=()=>+(e(ae)||0),p=d=>n(ae,d),o=d=>{const f=a();p(f+d)},s=()=>+(e(ee)||0),t=d=>{const f=s();n(ee,Math.min(Math.max(f+d,0),te.length*_.length-1))};return{getScore:a,addScore:o,plusDifficulty:()=>t(1),minusDifficulty:()=>t(-5),getDifficultyRad:()=>{const d=s(),f=Math.floor(d/_.length);return te[f]||te[1]},getDifficultyTic:()=>{const d=s(),f=Math.floor(d/_.length),h=d-f*_.length;return _[h]||_[0]},resetDifficulty:()=>n(ee,0),getSound:()=>$!==null?$:e(de)==="true"?($=!0,!0):($=!1,!1),setSound:d=>{$=d,n(de,d)}}},pe=["/sounds/pop1.mp3","/sounds/pop2.mp3","/sounds/pop3.mp3","/sounds/pop4.mp3","/sounds/pop5.mp3","/sounds/pop6.mp3","/sounds/pop8.mp3","/sounds/pop9.mp3","/sounds/pop10.mp3","/sounds/pop11.mp3","/sounds/pop12.mp3","/sounds/pop13.mp3","/sounds/pop14.mp3","/sounds/pop15.mp3"];let k=[...pe];const Y=()=>{const{rand:e,playSound:n}=x(),{getSound:a}=D();return{playPop:()=>{if(!a())return;const l=e(k.length-1),u=k[l];k.splice(l,1),k.length||(k=[...pe]);const i=e(k.length-1);k=[...k.splice(i,k.length),...k],n(u)},playMissed:()=>{if(!a())return;n("/sounds/pop7.mp3")},playFail:()=>{if(!a())return;n("/sounds/fail.mp3")},playWin:()=>{if(!a())return;n("/sounds/win.mp3")}}},B=100/2;let fe=0;const G=()=>{const{loop:e,ctx:n,shade:a,rand:p}=x(),{playPop:o,playMissed:s}=Y(),t={},l=()=>{for(const r in t){const c=t[r];if(!c)return;const g=c.popit;if(!c.shake)c.tic+=B/5,c.tic>=B&&(c.dir=-1),c.withoutRad||(g.r=c.origR+c.origR*75e-5*(c.tic+(c.dir>0?0:B-c.tic)));else{c.tic+=B/5;const M=p(1,2),d=p(1,2);g.x=c.origX+Math.random()*M*(Math.random()>.5?1:-1),g.y=c.origY+Math.random()*d*(Math.random()>.5?1:-1)}c.tic>=2*B&&(delete t[r],g.r=c.origR,g.x=c.origX,g.y=c.origY)}},u=(r,c=!1,g=!1)=>{c?s():o(),fe++;const M=`${new Date().valueOf().toString()}_${fe}`,d=1,f=1;t[M]={withoutRad:c,tic:d,dir:f,popit:r,origR:r.r,origX:r.x,origY:r.y,shake:g}},i=()=>{n.globalAlpha=.25;for(const r in t){const c=t[r];if(c.shake)continue;const g=c.popit;n.fillStyle=a(g.c||"red",-12),n.beginPath(),n.arc(g.x,g.y,g.r+c.origR*.001*(c.tic+(c.dir>0?0:B-c.tic)),0,Math.PI*2),n.closePath(),n.fill()}n.globalAlpha=1};return e(l),{popEffect:u,render:i}},oe=e=>{const{font:n,ctx:a}=x();return(p=a)=>{const{text:o,x:s,c:t,y:l,fs:u,a:i="center",mw:r}=e;p.textAlign=i,p.fillStyle=t,p.font=`${u}px ${n}`,p.fillText(o,s,l,r)}},j=100,Fe=e=>{const{loop:n,ctx:a,useMeasure:p,rand:o}=x();let s=null;const t=()=>{if(!s)return;const{m:i}=p();if(s.tic<=j)s.props.fs=((e==null?void 0:e.mfs)||8)/j*s.tic*i;else{const r=o(1,1),c=o(1,1);s.props.x=s.origX+Math.random()*r*(Math.random()>.5?1:-1),s.props.y=s.origY+Math.random()*c*(Math.random()>.5?1:-1),s.shake=!0}s.tic+=s.tic>j?1:10,s.tic>j*2},l=i=>{const{cx:r,m:c}=p(),g=0,M={x:r,y:Math.round(c*((e==null?void 0:e.dy)||16)),text:i,c:(e==null?void 0:e.color)||"#ffffff",fs:0},d=oe(M);s={props:M,shape:d,tic:g,origX:M.x,origY:M.y}},u=()=>{s&&(a.globalAlpha=.01*s.tic,s.shape(),a.globalAlpha=1)};return n(t),{splashEffect:l,render:u}},Le=({color:e="#ba68c8",popEffect:n=()=>{}})=>{const{addEventResize:a,useMeasure:p,useTimer:o,useScreenMeta:s,navigate:t,addEventClick:l,intersect:u}=x(),{from:i}=s();let r,c,g;return a(()=>{const{cx:f,cy:h,s:P,m}=p(),y=Math.round(P*.25);r={c:e,r:Math.round(P*.08),x:f-y-1*m,y:h-y+1*m,p:(i==="score"||i==="opening")&&!r},c=W(r),g=N({x:Number(r.x)-r.r+Math.round(r.r*.5),y:Number(r.y)-r.r+Math.round(r.r*.5),w:r.r*2-Math.round(r.r*1),src:"/media/star.svg"})}),o(()=>{r.p&&n(r,!1,!0),r.p=!1}),l((f,h)=>{u({x:f,y:h},r)&&(n(r),r.p=!0,o(()=>{t("score")},100))}),{render:()=>{c(),r.p||g()},point:()=>({x:r.x,y:r.y,r:r.r})}},_e=({color:e="#ff6347",popEffect:n=()=>{}})=>{const{addEventResize:a,useMeasure:p,useTimer:o,useScreenMeta:s,navigate:t,addEventClick:l,intersect:u}=x(),{from:i}=s();let r,c,g;return a(()=>{const{s:f}=p(),h=Math.round(f*.08);r={c:e,r:h,x:Math.round(1.6*h),y:Math.round(1.6*h),p:i==="main"&&!r},c=W(r),g=N({x:Number(r.x)-h+Math.round(h*.4),y:Number(r.y)-h+Math.round(h*.4),w:h*2-Math.round(h*.8),src:"/media/back.svg"})}),o(()=>{r.p&&n(r,!1,!0),r.p=!1}),l((f,h)=>{u({x:f,y:h},r)&&(n(r),r.p=!0,o(()=>{t("main")},100))}),{render:()=>{c(),r.p||g()},point:()=>({x:r.x,y:r.y,r:r.r})}},Be=({onClick:e})=>{const{addEventResize:n,useMeasure:a,useTimer:p,addEventClick:o,intersect:s,rotate:t}=x(),{playPop:l}=Y();let u,i,r;return n(()=>{const{s:M}=a(),d=Math.round(M*.08);u={c:"#ff6347",r:d,x:Math.round(innerWidth-1.6*d),y:Math.round(innerHeight-1.6*d),p:!1},i=W(u),r=N({x:Number(u.x)-d+Math.round(d*.4),y:Number(u.y)-d+Math.round(d*.4),w:d*2-Math.round(d*.8),src:"/media/back.svg"})}),o((M,d)=>{s({x:M,y:d},u)&&(l(),u.p=!0,e(),p(()=>{u.p=!1},100))}),{render:()=>{i(),u.p||t(()=>{r()},u.x,u.y,innerHeight>innerWidth?-1:-.5)},point:()=>({x:u.x,y:u.y,r:u.r})}},Oe=({onClick:e})=>{const{addEventResize:n,useMeasure:a,useTimer:p,addEventClick:o,intersect:s,rotate:t}=x(),{playPop:l}=Y();let u,i,r;return n(()=>{const{s:M}=a(),d=Math.round(M*.08),f=innerWidth<innerHeight?Math.round(innerWidth-1.6*d-2*d-.3*d):Math.round(innerWidth-1.6*d),h=innerWidth<innerHeight?Math.round(innerHeight-1.6*d):Math.round(innerHeight-1.6*d-2*d-.3*d);u={c:"#ff6347",r:d,x:f,y:h,p:!1},i=W(u),r=N({x:Number(u.x)-d+Math.round(d*.4),y:Number(u.y)-d+Math.round(d*.4),w:d*2-Math.round(d*.8),src:"/media/back.svg"})}),o((M,d)=>{s({x:M,y:d},u)&&(l(),u.p=!0,e(),p(()=>{u.p=!1},100))}),{render:()=>{i(),u.p||t(()=>{r()},u.x,u.y,innerHeight>innerWidth?0:.5)},point:()=>({x:u.x,y:u.y,r:u.r})}},$e=e=>{const{ctx:n,shade:a}=x(),p=Math.round(e.r/2.2),o=Math.round(.15*e.r),s=a(e.c||"blue",-3);return(t=n)=>{const{r:l,x:u=l,y:i=l}=e;t.lineCap="round",t.fillStyle=s,t.strokeStyle=s,t.lineWidth=p,t.beginPath(),t.moveTo(u+o,i),t.lineTo(u-o/2,i-o),t.lineTo(u-o/2,i+o),t.closePath(),t.fill(),t.beginPath(),t.moveTo(u+o,i),t.lineTo(u-o/2,i-o),t.moveTo(u-o/2,i-o),t.lineTo(u-o/2,i+o),t.moveTo(u-o/2,i+o),t.lineTo(u+o,i),t.stroke()}},ge=({getX:e,getY:n,color:a="#bef181",popEffect:p=()=>{}})=>{const{addEventResize:o,useMeasure:s,useTimer:t,useScreenMeta:l,navigate:u,addEventClick:i,intersect:r}=x(),{from:c}=l();let g,M,d;return o(()=>{const{cx:P,cy:m,s:y,m:v}=s();g={c:a,r:Math.round(y*.1),x:e(P,y,v),y:n(m,y,v),p:(c==="gamescore"||c==="game"||c==="opening")&&!g},M=W(g),d=$e(g)}),t(()=>{g.p&&p(g,!1,!0),g.p=!1}),i((P,m)=>{r({x:P,y:m},g)&&(p(g),g.p=!0,t(()=>{u("game")},100))}),{render:()=>{M(),g.p||d()},point:()=>({x:g.x,y:g.y,r:g.r})}},me=e=>{const{ctx:n,shade:a}=x(),p=Math.round(e.r/4),o=Math.round(.12*e.r);return(s=n)=>{const{r:t,x:l=t,y:u=t}=e,i=a(e.c||"blue",-3);s.lineCap="round",s.strokeStyle=i,s.lineWidth=p,s.beginPath(),s.moveTo(l-1.5*o,u-2*o),s.lineTo(l-1.5*o,u+2*o),s.stroke(),s.beginPath(),s.moveTo(l+1.5*o,u-2*o),s.lineTo(l+1.5*o,u+2*o),s.stroke()}},Ne=({getX:e,getY:n,popEffect:a=()=>{}})=>{const{addEventResize:p,useMeasure:o,useTimer:s,useScreenMeta:t,navigate:l,addEventClick:u,intersect:i}=x(),{from:r}=t();let c,g,M;return p(()=>{const{cx:h,cy:P,s:m,m:y}=o();c={c:"#fd8059",r:Math.round(m*.08),x:e(h,m,y),y:n(P,m,y),p:(r==="game"||r==="opening")&&!c},g=W(c),M=me(c)}),s(()=>{c.p&&a(c,!1,!0),c.p=!1},500),u((h,P)=>{i({x:h,y:P},c)&&(a(c),c.p=!0,s(()=>{l("main")},100))}),{render:()=>{g(),c.p||M()},point:()=>({x:c.x,y:c.y,r:c.r})}},Ye=e=>{const{ctx:n,shade:a}=x(),p=Math.round(e.r/4),o=Math.round(.2*e.r),s=a(e.c||"blue",-5);return(t=n)=>{const{r:l,x:u=l,y:i=l}=e;t.lineCap="round",t.fillStyle=s,t.strokeStyle=s,t.lineWidth=p,t.beginPath(),t.ellipse(u-o,i+o,p,o,10*Math.PI/180,0,2*Math.PI),t.closePath(),t.fill(),t.beginPath(),t.moveTo(u-o/2,i+o),t.lineTo(u,i-o),t.lineTo(u+o,i-o),t.stroke(),e.on||(t.lineWidth=Math.round(p/3),t.beginPath(),t.moveTo(u-l/4,i-l/4),t.lineTo(u+l/4,i+l/4),t.stroke())}},Ge=({color:e="#f9f774",popEffect:n=()=>{}})=>{const{addEventResize:a,useMeasure:p,useTimer:o,useScreenMeta:s,addEventClick:t,intersect:l}=x(),{from:u}=s(),{getSound:i,setSound:r}=D();let c,g,M;return a(()=>{const{cx:h,cy:P,s:m,m:y}=p(),v=Math.round(m*.25),S=Math.round(m*.065),w=i();c={c:e,r:S,x:h-v-S-y,y:P-v+3*S,p:u==="opening"&&!c,on:w},g=W(c),M=Ye(c)}),o(()=>{c.p&&n(c,!1,!0),c.p=!1}),t((h,P)=>{if(l({x:h,y:P},c)){let m=i();m=!m,r(m),c.p=!0,c.on=m,n(c),o(()=>{c.p=!1},100)}}),{render:()=>{g(),c.p||M()},point:()=>({x:c.x,y:c.y,r:c.r})}},Xe=({color:e="#f86a9a",popEffect:n=()=>{}})=>{const{addEventResize:a,useMeasure:p,useTimer:o,useScreenMeta:s,addEventClick:t,intersect:l,navigate:u}=x(),{from:i}=s();let r,c,g,M;return a(()=>{const{cx:h,cy:P,s:m}=p(),y=Math.round(m*.25);r={c:e,x:h,y:P,r:y,p:i==="opening"&&!r},c=W(r),g=oe({text:"Yola",c:"#f1f1f1",x:h,y:P-y+Math.round(y*.9),fs:Math.round(y/2.6),mw:y*2}),M=oe({text:"PopiT",c:"#ffeb3b",x:h,y:P-y+Math.round(y*1.3),fs:Math.round(y/2.3),mw:y*2})}),o(()=>{r.p&&n(r,!1,!0),r.p=!1}),t((h,P)=>{l({x:h,y:P},r)&&(n(r),r.p=!0,o(()=>{u("opening")},100))}),{render:()=>{c(),r.p||(g(),M())},point:()=>({x:r.x,y:r.y,r:r.r})}},Me=({color:e="#00dcfe",frequency:n=20})=>{const{addEventResize:a,useRandChain:p,useMeasure:o,rand:s,useTimer:t,setBackground:l,useScreenMeta:u}=x(),{from:i}=u();l(e);const r=s(0,999);let c=[],g=[];a(()=>{const h=p(r),{s:P}=o();c=[];const m=Math.round(P*.04),y=Math.round(innerWidth/m/2)-1,v=Math.round((innerWidth-2*m*y)/(y+1)),S=Math.round(innerHeight/m/2)-1,w=Math.round((innerHeight-2*m*S)/(S+1));for(let E=0;E<S;E++)for(let C=0;C<y;C++)h(h(n))<1&&c.push({x:v+m+C*m*2+v*C,y:w+m+E*m*2+w*E,r:m,c:e,p:i==="opening"?!0:h(1)>0});g=c.map(E=>W(E))});const M=()=>{t(()=>{const h=s(c.length-1);c[h]&&(c[h].p=!c[h].p),M()},750)};return i==="opening"?t(()=>{c.forEach(h=>h.p=s(1)>0),M()}):M(),{render:()=>{g.forEach(h=>h())},setIntersections:h=>{c=c.filter(({x:P,y:m,r:y})=>h(P,m,y)),g=c.map(P=>W(P))}}},ye=(e=!1)=>{let n=["#f86a9a","#C69FEE","#5bb2f7","#92E6E6","#7ceab2","#bef181","#EFCD74","#fd8059"];const{addEventResize:a,useMeasure:p,setBackground:o,rand:s}=x(),{getDifficultyRad:t}=D();return n=[...n.splice(s(n.length-1),n.length),...n],e||a(()=>{const{s:u}=p(),i=t(),r=Math.round(u*i),c=Math.round(innerWidth/r/2)-1,g=(innerWidth-2*r*c)/(c+1),M=Math.round(innerHeight/r/2)-1,d=(innerHeight-2*r*M)/(M+1),f=innerWidth>=innerHeight,h=f?c:M,P=f?g:d,m=f?innerWidth:innerHeight;let y=0;const v=[];for(let w=0;w<h;w++)n[y]||(y=0),v.push(`${n[y]} ${(P+r+w*r*2+P*w)/m*100}%`),y++;o(`linear-gradient(${f?"to right":"to bottom"}, ${v.join(", ")})`,innerWidth<innerHeight?n[0]:"#040404")}),n},ve=({palette:e,retry:n,popEffect:a=()=>{}})=>{const{addEventResize:p,useMeasure:o,rand:s,useTimer:t,useScreenMeta:l,navigate:u,addEventClick:i,intersect:r}=x(),{from:c}=l(),{getDifficultyRad:g}=D(),M=[];let d=[],f,h,P,m={x:0,y:0,r:0};const y=S=>Array.isArray(e)?e[S]:e;return p(()=>{const{s:S}=o();M.splice(0);const w=g(),E=Math.round(S*w),C=Math.round(innerWidth/E/2)-1,A=(innerWidth-2*E*C)/(C+1),z=Math.round(innerHeight/E/2)-1,X=(innerHeight-2*E*z)/(z+1),O=innerWidth>=innerHeight;let b=0;for(let I=0;I<z;I++){for(let T=0;T<C;T++){y(b)||(b=0);const R={x:A+E+T*E*2+A*T,y:X+E+I*E*2+X*I,r:E,c:y(b),p:!0};I===0&&T===C-1?(m={x:R.x,y:R.y,r:R.r,c:R.c,p:(c==="main"||c==="gameover"||c==="gamescore")&&!m.r},f=W(m),h=me(m)):M.push(R),b+=O?1:0}b=O?0:b+1}n&&(P=M[s(M.length-1)],t(()=>{a(P,!1,!0),P.p=!1})),d=M.map(I=>W(I))}),t(()=>{m.p&&a(m,!1,!0),m.p=!1}),n&&i((S,w)=>{r({x:S,y:w},P)&&(a(P),P.p=!0,t(()=>{u("game")},100))}),i((S,w)=>{r({x:S,y:w},m)&&(a(m),m.p=!0,t(()=>{u("main")},100))}),{render:()=>{d.forEach(S=>S()),f(),m!=null&&m.p||h()},popits:M,pausePpt:m}},L=100,q="#222",je=e=>{const n=(e==null?void 0:e[0])||0,a=(e==null?void 0:e[1])||0,p=(e==null?void 0:e[2])||0;return"#"+(16777216+(n<255?n<1?0:n:255)*65536+(a<255?a<1?0:a:255)*256+(p<255?p<1?0:p:255)).toString(16).slice(1)},ne={},qe=e=>{const{ctx:n,createImg:a,useRandChain:p,useTimer:o}=x();let s,t=!1,l=[];const u=e.r*2/L/2;ne[e.imgSrc]?s=ne[e.imgSrc]:(s=ne[e.imgSrc]={img:new Image,cols:[],isFilled:!1,r:e.r,drawImg:null,score:e.score},s.img.src=e.imgSrc);const i=()=>o(()=>{t=!t,i()},250),r=(f,h=n)=>{const{x:P,y:m,c:y,r:v}=f;h.fillStyle=y||"red",h.beginPath(),h.arc(P+v,m+v,v,0,Math.PI*2),h.closePath(),h.fill()},c=(f=n,h=0,P=0)=>{f.fillStyle=q,f.beginPath(),f.roundRect(h,P,2*e.r,2*e.r,u),f.closePath(),f.fill()},g=()=>{const f=[];for(let v=0;v<L;v++)for(let S=0;S<L;S++){const w={x:S*u*2,y:v*u*2,r:u,c:q};f.push(w)}let h=e.score-e.winScore;const P=[...f],m=p(e.seed),y=(v=!1)=>{const S=m(P.length-1),w=P[S],E=f.indexOf(w);w.c=v?q:s.cols[E],P.splice(S,1),v&&l.push({...w,c:s.cols[E]})};for(let v=h;v>0;v--)y();if(e.winScore){l=[];for(let v=e.winScore;v>0;v--)y(!0);i()}return f},M=()=>{const f=g();s.drawImg=a((h=n)=>{c(h),f.filter(P=>P.c!==q).forEach(P=>r(P,h))},2*e.r)},d=async()=>{var P;const f=document.createElement("canvas");f.width=L,f.height=L;const h=f.getContext("2d",{willReadFrequently:!0});h==null||h.drawImage(s.img,0,0);for(let m=0;m<L;m++){const y=[];for(let v=0;v<L;v++){const S=(P=h==null?void 0:h.getImageData(v,m,1,1))==null?void 0:P.data;y.push(je(S))}s.cols.push(...y)}s.isFilled=!0,M()};return s.isFilled?(s.r!==e.r||s.score!==e.score)&&M():s.img.onload=d,(f=n)=>{const{x:h,y:P,r:m,winScore:y}=e;if(s.drawImg?f.drawImage(s.drawImg,h-m,P-m,2*m,2*m):c(f,h-m,P-m),t&&y&&s.drawImg)for(const v of l)f.fillStyle=v.c||"red",f.beginPath(),f.arc(h-m+v.x+v.r,P-m+v.y+v.r,v.r,0,Math.PI*2),f.closePath(),f.fill()}},he=1e4,Pe=(e=0,n=!1)=>{const{addEventResize:a,useMeasure:p,translate:o}=x(),{getScore:s}=D(),t=["/media/levels/cat.png","/media/levels/city.png","/media/levels/girl.png","/media/levels/home.png","/media/levels/iron.png","/media/levels/wolf.png","/media/levels/max.png"],l=s();let u,i=0,r=0,c=!1,g=!1;const M=y=>Math.min(Math.floor(y/he),t.length-1);let d=M(l-e);if(e){const y=M(l);c=y!==d,g=y>t.length-1}return a(()=>{const{cx:y,cy:v,s:S,isL:w}=p();u=[],i=(S-2*S*.055*1.6)/2,r=S*.05;let E=n?d:0;for(E;E<(n?d+1:t.length);E++){const C=t[E],A=w?y:y+E*i*2+E*r,z=w?v+E*i*2+E*r:v;u.push(qe({x:A,y:z,r:i,score:Math.min(l-E*he,1e4),imgSrc:C,winScore:e,seed:E}))}}),{up:()=>{d=d+1<t.length?d+1:t.length-1},down:()=>{d=d-1<0?0:d-1},render:()=>{const{isL:y}=p(),v=y?0:-(d*i*2+d*r),S=y?-(d*i*2+d*r):0;o(()=>{u==null||u.forEach(w=>w())},v,S)},rect:()=>{const{cx:y,cy:v}=p(),S=innerWidth>innerHeight;return{x:S?y-i:0,y:S?0:v-i,w:S?2*i:innerWidth,h:S?innerHeight:2*i}},isJump:c,isCompleted:g}},Ue=({popits:e,pausePpt:n,popEffect:a=()=>{},splashEffect:p=()=>{}})=>{const{useTimer:o,rand:s,addEventClick:t,addEventMove:l,intersect:u,navigate:i,addEventResize:r}=x(),{getScore:c,addScore:g,getDifficultyTic:M}=D();let d=[],f,h,P=!1,m=0,y=0,v=0;const S=c(),w=M(),E=b=>{const I=e.filter(F=>d.indexOf(F)===-1&&F!==b),T=s(I.length-1),R=I[T];R&&(a(R,!1,!0),R.p=!1,d.push(I[T]))},C=()=>{h=o(()=>{if(v=Math.max(v-10,50),e.length===d.length){P=!0,h.stop(),o(()=>{i("gameover")});return}E(),C()},v)},A=b=>{d=[];const I=e.length;let T=s(Math.round(I*.3),Math.round(I*.6));const R=[...e];if(b){const F=R.indexOf(b);R.splice(F,1)}for(let F=T;F>0;F--){const se=s(R.length-1),K=R[se];K.p=!1,a(K,!1,!0),d.push(K),R.splice(se,1)}v=w,f==null||f.stop(),h==null||h.stop(),S&&(f=o(()=>{p("SLOWLY"),C()},d.length*w)),m=m>0?m:s(3,5)},z=()=>1,X=b=>{a(b),v=Math.min(v+5,w),y++,b.p=!0;const I=d.indexOf(b);if(d.splice(I,1),d.length<=0)if(m--,m>0)o(()=>{p("Round"),A(b)},100);else{f==null||f.stop(),h==null||h.stop();const T=z();g(y*T),o(()=>{i("gamescore",{winScore:y*T})},100)}},O=(b,I,T=!1)=>{if(!P){for(const R of d)if(u({x:b,y:I},R)){X(R);return}if(!u({x:b,y:I},n)&&!T){for(const R of e)if(u({x:b,y:I},R)){a(R,!0),p("Popenalty"),E(R);return}p("Popenalty"),E()}}};t(O),l((b,I)=>O(b,I,!0)),r(()=>{o(()=>{p("Pop it"),A()})})},Ve=()=>{const{addEventResize:e,rand:n,useScreenMeta:a}=x(),{from:p}=a(),{popEffect:o,render:s}=G(),t=["#00dcfe","#5bb2f7","#92E6E6"],l=p==="opening"?t[0]:t[n(t.length-1)],{render:u,setIntersections:i}=Me({color:l}),{render:r,point:c}=Xe({popEffect:o}),{render:g,point:M}=ge({getX:(m,y,v)=>m+Math.round(y*.25)+2*v,getY:(m,y,v)=>m+Math.round(y*.25)+0*v,popEffect:o}),{render:d,point:f}=Le({popEffect:o}),{render:h,point:P}=Ge({popEffect:o});return e(()=>{const m=f(),y=c(),v=M(),S=P();i((w,E,C)=>!H({x:w,y:E,r:C},m)&&!H({x:w,y:E,r:C},y)&&!H({x:w,y:E,r:C},v)&&!H({x:w,y:E,r:C},S))}),()=>{s(),u(),r(),g(),d(),h()}},Ke=()=>{const{useMeasure:e,addEventResize:n}=x(),a=ye(),{popEffect:p,render:o}=G(),{popits:s,render:t,pausePpt:l}=ve({palette:a,popEffect:p});return Ue({popits:s,popEffect:p,pausePpt:l}),n(()=>{(s[0].y-s[0].r)/e().m}),()=>{o(),t()}},Je=()=>{const e="#ff6347",{popEffect:n,render:a}=G(),{setBackground:p}=x(),{minusDifficulty:o}=D(),{render:s}=ve({palette:e,retry:!0,popEffect:n}),{playFail:t}=Y();return p(e),o(),t(),()=>{a(),s()}},Qe=()=>{const{translate:e,useScreenMeta:n}=x(),{plusDifficulty:a,resetDifficulty:p}=D(),{data:o}=n(),{popEffect:s,render:t}=G(),{splashEffect:l,render:u}=Fe({infinity:!0});ye();const{playWin:i}=Y(),{render:r,isJump:c}=Pe(o==null?void 0:o.winScore,!0),{render:g}=ge({getX:(d,f,h)=>innerWidth>innerHeight?Math.min(d+(f-2*f*.055*1.6)/2+4*h+Math.round(f*.1),innerWidth-2*h-Math.round(f*.1)):d+(f-2*f*.055*1.6)/8+0*Math.round(f*.1)+2*h,getY:(d,f,h)=>innerWidth>innerHeight?d+(f-2*f*.055*1.6)/2-1*h-Math.round(f*.1):Math.min(d+(f-2*f*.055*1.6)/2+4*h+Math.round(f*.1),innerHeight-2*h-Math.round(f*.1)),popEffect:s}),{render:M}=Ne({getX:(d,f,h)=>innerWidth>innerHeight?Math.max(d-(f-2*f*.055*1.6)/2-4*h-Math.round(f*.1),2*h+Math.round(f*.1)):d+(f-2*f*.055*1.6)/8-2*Math.round(f*.1)-2*h,getY:(d,f,h)=>innerWidth>innerHeight?d-(f-2*f*.055*1.6)/2+0*h+Math.round(f*.1):Math.min(d+(f-2*f*.055*1.6)/2+4*h+Math.round(f*.1),innerHeight-2*h-Math.round(f*.1)),popEffect:s});return c?p():a(),innerHeight>innerWidth&&l(c?"Completed":"You win"),i(),()=>{t(),innerHeight>innerWidth?e(r,0,-Math.round(innerHeight*.05)):r(),g(),M(),u()}},Ze=()=>{const{addEventResize:e,rand:n}=x(),{popEffect:a,render:p}=G(),o=["#ffeb3b","#C69FEE","#5bb2f7","#92E6E6","#7ceab2","#bef181","#EFCD74"],s=o[n(o.length-1)],{render:t,setIntersections:l}=Me({color:s,frequency:10}),{render:u,rect:i,up:r,down:c}=Pe(),{render:g,point:M}=_e({popEffect:a}),{render:d,point:f}=Be({onClick:r,popEffect:a}),{render:h,point:P}=Oe({onClick:c,popEffect:a});return e(()=>{const m=M(),y=i(),v=f(),S=P();l((w,E,C)=>!H({x:w,y:E,r:C},m)&&!We({x:w,y:E,r:C},y)&&!H({x:w,y:E,r:C},v)&&!H({x:w,y:E,r:C},S))}),()=>{p(),t(),u(),g(),d(),h()}},et=()=>{const{ctx:e,addEventResize:n,loop:a}=x(),p={x:40,y:100};let o=1,s=1,t;const l=()=>{t=5*Math.ceil(Math.sqrt(innerWidth*innerWidth+innerHeight*innerHeight)/144)};return l(),n(l),a(()=>{p.x+=2*o,p.y+=3*s,o*=-1,s*=-1}),()=>{e.save();var u=Math.random()*2,i=Math.random()*3;e.translate(u,i),e.beginPath(),e.fillStyle="red",e.rect(p.x,p.y,t,t),e.fill(),e.restore()}},tt=[{name:"opening",ctor:Ae},{name:"main",ctor:Ve},{name:"game",ctor:Ke},{name:"gameover",ctor:Je},{name:"gamescore",ctor:Qe},{name:"score",ctor:Ze},{name:"devs",ctor:et}],nt=["/sounds/pop1.mp3","/sounds/pop2.mp3","/sounds/pop3.mp3","/sounds/pop4.mp3","/sounds/pop5.mp3","/sounds/pop6.mp3","/sounds/pop7.mp3","/sounds/pop8.mp3","/sounds/pop9.mp3","/sounds/pop10.mp3","/sounds/pop11.mp3","/sounds/pop12.mp3","/sounds/pop13.mp3","/sounds/pop14.mp3","/sounds/pop15.mp3","/sounds/fail.mp3","/sounds/win.mp3"];De(tt,nt);document.title="Your's last Pop it";
