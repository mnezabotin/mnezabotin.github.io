(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))f(o);new MutationObserver(o=>{for(const d of o)if(d.type==="childList")for(const t of d.addedNodes)t.tagName==="LINK"&&t.rel==="modulepreload"&&f(t)}).observe(document,{childList:!0,subtree:!0});function u(o){const d={};return o.integrity&&(d.integrity=o.integrity),o.referrerPolicy&&(d.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?d.credentials="include":o.crossOrigin==="anonymous"?d.credentials="omit":d.credentials="same-origin",d}function f(o){if(o.ep)return;o.ep=!0;const d=u(o);fetch(o.href,d)}})();const Pe=()=>{const e=document.createElement("canvas"),n=e.getContext("2d");if(!n)throw new Error("CanvasRenderingContext2D is null");const u=()=>{e.width=innerWidth*devicePixelRatio,e.height=innerHeight*devicePixelRatio,n.scale(devicePixelRatio,devicePixelRatio),e.style.width=`${innerWidth}px`,e.style.height=`${innerHeight}px`},f=s=>{n.clearRect(0,0,innerWidth,innerHeight),s()};return u(),document.body.appendChild(e),{ctx:n,render:f,resize:u,rotate:(s,a,i,h)=>{n.save(),n.translate(a,i),n.rotate(Math.PI*h),n.translate(-a,-i),s(),n.restore()},translate:(s,a,i)=>{n.save(),n.translate(a,i),s(),n.restore()},shade:(s,a)=>{s=s.substring(1);const i=parseInt(s,16),h=Math.round(2.55*a),p=(i>>16)+h,r=(i>>8&255)+h,m=(i&255)+h;return"#"+(16777216+(p<255?p<1?0:p:255)*65536+(r<255?r<1?0:r:255)*256+(m<255?m<1?0:m:255)).toString(16).slice(1)},setBackground:(s,a)=>{var i;document.body.style.background=s,document.body.style.backgroundColor=a||s,(i=document.querySelector('meta[name="theme-color"]'))==null||i.setAttribute("content",a||s)},createImg:(s,a,i=a)=>{const h=document.createElement("canvas"),p=h.getContext("2d");if(!p)throw new Error("CanvasRenderingContext2D is null");return h.width=a*devicePixelRatio,h.height=i*devicePixelRatio,p.scale(devicePixelRatio,devicePixelRatio),s(p),h}}},Se=e=>{let n="",u="",f;const o=l=>e.find(c=>c.name===l)||e[0],t={render:()=>{},navigate:(l,c)=>{const s=o(l);u=n||"",n=(s==null?void 0:s.name)||"",f=c,t.render=(s==null?void 0:s.ctor())||(()=>{})},useScreenMeta:()=>({to:n,from:u,data:f})};return t},Ee=()=>{const e=requestAnimationFrame||(t=>setTimeout(t,16.666666666666668)),n=[],u={};return{loop:(t,l)=>{if(Object.entries(u).find(([s,a])=>a===t)||l&&u[l])throw new Error(`Loop${l?" "+l:""} already specified`);l&&n.push(l),l=l||new Date().valueOf().toString(),u[l]=t;const c=()=>{t(),u[l]&&e(c)};c()},stop:t=>{if(typeof t=="string")delete u[t];else{const l=Object.entries(u).find(([c,s])=>s===t);l&&delete u[l[0]]}},stopAll:()=>{for(const t in u)n.indexOf(t)===-1&&delete u[t]}}};let q=[];const Ce=()=>{for(const e of q)clearTimeout(e);q=[]},Ie=(e,n=400)=>{let u=new Date,f=n,o=setTimeout(e,f);return q.push(o),{pause:()=>{clearTimeout(o),f-=new Date-u},resume:()=>{u=new Date,clearTimeout(o),o=setTimeout(e,f),q.push(o)},stop:()=>{clearTimeout(o)}}},ie=2147483646,J=2147483647,Re=16807,be=(e=Math.floor(Math.random()*J))=>{e=e%J,e<=0&&(e+=ie);const n=()=>(e=e*Re%J,e),u=()=>(n()-1)/ie;return(o,d)=>(d===void 0&&(d=o,o=0),Math.floor(u()*(d-o+1))+o)},xe=(e,n)=>(n===void 0&&(n=e,e=0),Math.floor(Math.random()*(n-e+1))+e),Te=()=>{const e=[],n=[],u=[];return{addEventResize:a=>{a(),e.push(a)},onResizeEvents:()=>e.forEach(a=>a()),addEventClick:a=>n.push(a),onClickEvents:(a,i)=>n.forEach(h=>h(a,i)),addEventMove:a=>u.push(a),onMoveEvents:(a,i)=>u.forEach(h=>h(a,i)),removeAllEvents:()=>{e.splice(0),n.splice(0),u.splice(0)}}},D=(e,n)=>{const u=Math.pow(Math.abs(e.x-n.x),2),f=Math.pow(Math.abs(e.y-n.y),2),o=e.r||0,d=n.r||0,t=Math.pow(o+d,2);return u+f<=t},We=(e,n)=>{const u=e.r||0,f=n.w||0,o=n.h||0;return Math.abs(n.x+f/2-e.x)<=f/2+u&&Math.abs(n.y+o/2-e.y)<=o/2+u},ke=(e,n)=>D(e,n),De=e=>{const n=new AudioContext,u={},f=d=>{fetch(d).then(t=>t.arrayBuffer()).then(t=>(n==null?void 0:n.decodeAudioData(t))||null).then(t=>{t&&(u[d]=t)})};if(e.length)for(const d of e)f(d);return(d,t)=>{setTimeout(async()=>{const l=n.createBufferSource();u[d]||(u[d]=await fetch(d).then(c=>c.arrayBuffer()).then(c=>(n==null?void 0:n.decodeAudioData(c))||null)),l.buffer=u[d],l.connect(n.destination),t&&(l.playbackRate.value=t),l.start()},0)}};let U;const He=(e,n)=>{if(U)throw new Error("Webcore already specified");const u=Pe(),f=Se(e),{loop:o,stop:d,stopAll:t}=Ee(),{addEventResize:l,onResizeEvents:c,addEventClick:s,onClickEvents:a,addEventMove:i,onMoveEvents:h,removeAllEvents:p}=Te();let r=innerWidth/2,m=innerHeight/2,g=innerWidth<innerHeight?innerWidth:innerHeight,y=Math.ceil(Math.sqrt(innerWidth*innerWidth+innerHeight*innerHeight)/144),M=innerWidth>innerHeight;const v=()=>({cx:r,cy:m,s:g,m:y,isL:M}),w=De(n);U={font:"Tijuf",ctx:u.ctx,shade:u.shade,rotate:u.rotate,translate:u.translate,setBackground:u.setBackground,createImg:u.createImg,useMeasure:v,useScreenMeta:f.useScreenMeta,navigate:(P,E)=>{if(!e.some(S=>S.name===P))throw new Error(`Screen ${P} not specified`);t(),Ce(),p(),new Promise(()=>f.navigate(P,E))},loop:o,loopStop:d,useTimer:Ie,rand:xe,useRandChain:be,intersect:ke,addEventResize:l,addEventClick:s,addEventMove:i,playSound:w},o(()=>u.render(f.render),"draw"),window.onresize=()=>{r=innerWidth/2,m=innerHeight/2,g=innerWidth<innerHeight?innerWidth:innerHeight,y=Math.ceil(Math.sqrt(innerWidth*innerWidth+innerHeight*innerHeight)/144),M=innerWidth>innerHeight,u.resize(),c()},document.onpointerdown=P=>{a(P.clientX,P.clientY)},document.onmousemove=P=>{h(P.clientX,P.clientY)},f.navigate()},C=()=>{if(!U)throw new Error("Webcore not specified");return{...U}},Z={},W=e=>{const{shade:n,ctx:u,createImg:f}=C(),o=()=>{const{r:t,c:l="#ffffff",p:c}=e,s=u.createRadialGradient(t,t,t,t,t,t/5);return s.addColorStop(0,n(l,0)),s.addColorStop(.01,n(l,0)),s.addColorStop(.075,n(l,9)),s.addColorStop(.15,n(l,0)),s.addColorStop(.15,n(l,-15)),s.addColorStop(.18,n(l,-5)),s.addColorStop(.22,n(l,-15)),c?(s.addColorStop(.24,n(l,-10)),s.addColorStop(.3,n(l,-8)),s.addColorStop(.34,n(l,-12)),s.addColorStop(.6,n(l,-6)),s.addColorStop(1,n(l,-4))):(s.addColorStop(.24,n(l,-12)),s.addColorStop(.26,n(l,-8)),s.addColorStop(.3,n(l,-2)),s.addColorStop(.34,n(l,0)),s.addColorStop(.5,n(l,5)),s.addColorStop(1,n(l,12))),s},d=()=>{const{r:t,c:l="#ffffff",p:c}=e,s=`${l}_${c?"push":"pop"}_${t}`;if(Z[s])return Z[s];const a=f((i=u)=>{const h=o();i.fillStyle=h,i.beginPath(),i.arc(t,t,t,0,2*Math.PI),i.closePath(),i.fill()},2*t);return Z[s]=a,a};return(t=u)=>{const{x:l,y:c,r:s}=e,a=d();t.drawImage(a,l-s,c-s,2*s,2*s)}},Q={},Y=e=>{const{ctx:n}=C();let u;return Q[e.src]?u=Q[e.src]:(u=new Image,u.src=e.src,Q[e.src]=u),(f=n)=>{const{w:o,h:d=o,x:t=0,y:l=0}=e;u.complete&&f.drawImage(u,t,l,o,d)}},ce=e=>{const{font:n,ctx:u}=C(),f=e.text,o=e.text.length,d=2*Math.PI/o/4;return(t=u)=>{const{x:l,y:c,r:s,s:a=0,fs:i}=e,h=i||Math.round(s/4);t.textAlign="center",t.fillStyle="#f9f9f9",t.font=`${h}px ${n}`,t.save(),t.translate(l,c),t.rotate(a);for(let p=0;p<o;p++)t.save(),t.rotate(p*d),t.fillText(f[p],0,-s),t.restore();t.restore()}},Ae=()=>{var M,v;const{ctx:e,loop:n,rotate:u,navigate:f,useMeasure:o,addEventClick:d,addEventResize:t,setBackground:l}=C();l("#040404");let c=!1,s,a,i,h,p,r=-.2,m=0;t(()=>{const{cx:w,cy:P,s:E}=o(),S=Math.round(E*.25);s={c:"#ff6347",x:w,y:P,r:S,p:!1},a=W(s),i=Y({x:w-S+Math.round(S*.35),y:P-S+Math.round(S*.35),w:S*2-Math.round(S*.7),src:"/media/sloth.svg"}),h=ce({text:"nezabotin",x:w,y:P,r:Math.round(S*1.1),s:Math.PI*1.6}),p=ce({text:"production",x:w,y:P,r:Math.round(S*1.1),s:Math.PI*2.6})});const g=()=>{r+=.01,m=r>=1?1:r,r>=1.8&&(s.p=!0),r>=2.2&&(s.c="#f86a9a"),r>=2.6&&f("main")};d(()=>{[1.4,1.8,2.2,2.6].some(w=>{if(r<w)return r=w,!0})});const y=()=>{n(g),c=!0};return(M=document==null?void 0:document.fonts)!=null&&M.ready?(v=document==null?void 0:document.fonts)==null||v.ready.then(y):y(),()=>{const{cx:w,cy:P}=o();e.globalAlpha=c?1:0,a(),r<1.8&&i(),r<1.4&&u(()=>{h(),p()},w,P,m),e.globalAlpha=1}},ae="ylp",de="score",ee="difficulty",ue="sound",te=[.14,.11,.09,.075],le=750,ze=350,pe=5,_=[];for(let e=0;e*pe<=le-ze;e++)_.push(le-e*pe);let $=null;const H=()=>{const e=r=>localStorage.getItem(`${ae}_${r}`),n=(r,m)=>localStorage.setItem(`${ae}_${r}`,m.toString()),u=()=>+(e(de)||0),f=r=>n(de,r),o=r=>{const m=u();f(m+r)},d=()=>+(e(ee)||0),t=r=>{const m=d();n(ee,Math.min(Math.max(m+r,0),te.length*_.length-1))};return{getScore:u,addScore:o,plusDifficulty:()=>t(1),minusDifficulty:()=>t(-5),getDifficultyRad:()=>{const r=d(),m=Math.floor(r/_.length);return te[m]||te[1]},getDifficultyTic:()=>{const r=d(),m=Math.floor(r/_.length),g=r-m*_.length;return _[g]||_[0]},resetDifficulty:()=>n(ee,0),getSound:()=>$!==null?$:e(ue)==="true"?($=!0,!0):($=!1,!1),setSound:r=>{$=r,n(ue,r)}}};let oe=["/sounds/new/pop1.mp3","/sounds/new/pop2.mp3","/sounds/new/pop3.mp3","/sounds/new/pop4.mp3","/sounds/new/pop5.mp3","/sounds/new/pop6.mp3","/sounds/new/pop7.mp3","/sounds/new/pop8.mp3","/sounds/new/pop9.mp3","/sounds/new/pop10.mp3","/sounds/new/pop11.mp3","/sounds/new/pop12.mp3","/sounds/new/pop13.mp3","/sounds/new/pop14.mp3","/sounds/new/pop15.mp3","/sounds/new/pop16.mp3","/sounds/new/pop17.mp3","/sounds/new/pop18.mp3","/sounds/new/pop19.mp3","/sounds/new/pop20.mp3","/sounds/new/pop21.mp3","/sounds/new/pop22.mp3","/sounds/new/pop23.mp3","/sounds/new/pop24.mp3"];oe=["/sounds/rinat/pop(1).wav","/sounds/rinat/pop(2).wav","/sounds/rinat/pop(3).wav","/sounds/rinat/pop(4).wav","/sounds/rinat/pop(5).wav","/sounds/rinat/pop(6).wav","/sounds/rinat/pop(7).wav","/sounds/rinat/pop(8).wav","/sounds/rinat/pop(9).wav","/sounds/rinat/pop(10).wav","/sounds/rinat/pop(11).wav","/sounds/rinat/pop(12).wav"];let k=[...oe];const G=()=>{const{rand:e,playSound:n}=C(),{getSound:u}=H();return{playPop:()=>{if(!u())return;const l=e(k.length-1),c=k[l];k.splice(l,1),k.length||(k=[...oe]);const s=e(k.length-1);k=[...k.splice(s,k.length),...k],n(c,1.2)},playMissed:()=>{if(!u())return;n("/sounds/new/wrong.mp3")},playFail:()=>{if(!u())return;n("/sounds/fail-fast.mp3")},playWin:()=>{if(!u())return;n("/sounds/win.mp3")}}},B=100/2;let fe=0;const O=()=>{const{loop:e,ctx:n,shade:u,rand:f}=C(),{playPop:o,playMissed:d}=G(),t={},l=()=>{for(const a in t){const i=t[a];if(!i)return;const h=i.popit;if(!i.shake)i.tic+=B/5,i.tic>=B&&(i.dir=-1),i.withoutRad||(h.r=i.origR+i.origR*75e-5*(i.tic+(i.dir>0?0:B-i.tic)));else{i.tic+=B/5;const p=f(1,2),r=f(1,2);h.x=i.origX+Math.random()*p*(Math.random()>.5?1:-1),h.y=i.origY+Math.random()*r*(Math.random()>.5?1:-1)}i.tic>=2*B&&(delete t[a],h.r=i.origR,h.x=i.origX,h.y=i.origY)}},c=(a,i=!1,h=!1)=>{i?d():o(),fe++;const p=`${new Date().valueOf().toString()}_${fe}`,r=1,m=1;t[p]={withoutRad:i,tic:r,dir:m,popit:a,origR:a.r,origX:a.x,origY:a.y,shake:h}},s=()=>{n.globalAlpha=.25;for(const a in t){const i=t[a];if(i.shake)continue;const h=i.popit;n.fillStyle=u(h.c||"red",-12),n.beginPath(),n.arc(h.x,h.y,h.r+i.origR*.001*(i.tic+(i.dir>0?0:B-i.tic)),0,Math.PI*2),n.closePath(),n.fill()}n.globalAlpha=1};return e(l),{popEffect:c,render:s}},V=e=>{const{font:n,ctx:u}=C();return(f=u)=>{const{text:o,x:d,c:t,y:l,fs:c,a:s="center",mw:a,f:i}=e;f.textAlign=s,f.fillStyle=t,f.font=`${c}px ${i||n}`,f.fillText(o,d,l,a)}},Fe=({color:e="#ba68c8",popEffect:n=()=>{}})=>{const{addEventResize:u,useMeasure:f,useTimer:o,useScreenMeta:d,navigate:t,addEventClick:l,intersect:c}=C(),{from:s}=d();let a,i,h;return u(()=>{const{cx:m,cy:g,s:y,m:M}=f(),v=Math.round(y*.25);a={c:e,r:Math.round(y*.08),x:m-v-1*M,y:g-v+1*M,p:(s==="score"||s==="opening"||s==="devs")&&!a},i=W(a),h=Y({x:Number(a.x)-a.r+Math.round(a.r*.5),y:Number(a.y)-a.r+Math.round(a.r*.5),w:a.r*2-Math.round(a.r*1),src:"/media/star.svg"})}),o(()=>{a.p&&n(a,!1,!0),a.p=!1}),l((m,g)=>{c({x:m,y:g},a)&&(n(a),a.p=!0,o(()=>{t("score")},100))}),{render:()=>{i(),a.p||h()},point:()=>({x:a.x,y:a.y,r:a.r})}},ge=({color:e="#ff6347",popEffect:n=()=>{}})=>{const{addEventResize:u,useMeasure:f,useTimer:o,navigate:d,addEventClick:t,intersect:l}=C();let c,s,a;return u(()=>{const{s:p}=f(),r=Math.round(p*.08);c={c:e,r,x:Math.round(1.6*r),y:Math.round(1.6*r),p:!c},s=W(c),a=Y({x:Number(c.x)-r+Math.round(r*.4),y:Number(c.y)-r+Math.round(r*.4),w:r*2-Math.round(r*.8),src:"/media/back.svg"})}),o(()=>{c.p&&n(c,!1,!0),c.p=!1}),t((p,r)=>{l({x:p,y:r},c)&&(n(c),c.p=!0,o(()=>{d("main")},100))}),{render:()=>{s(),c.p||a()},point:()=>({x:c.x,y:c.y,r:c.r})}},Le=({onClick:e})=>{const{addEventResize:n,useMeasure:u,useTimer:f,addEventClick:o,intersect:d,rotate:t}=C(),{playPop:l}=G();let c,s,a;return n(()=>{const{s:p}=u(),r=Math.round(p*.08);c={c:"#ff6347",r,x:Math.round(innerWidth-1.6*r),y:Math.round(innerHeight-1.6*r),p:!1},s=W(c),a=Y({x:Number(c.x)-r+Math.round(r*.4),y:Number(c.y)-r+Math.round(r*.4),w:r*2-Math.round(r*.8),src:"/media/back.svg"})}),o((p,r)=>{d({x:p,y:r},c)&&(l(),c.p=!0,e(),f(()=>{c.p=!1},100))}),{render:()=>{s(),c.p||t(()=>{a()},c.x,c.y,innerHeight>innerWidth?-1:-.5)},point:()=>({x:c.x,y:c.y,r:c.r})}},_e=({onClick:e})=>{const{addEventResize:n,useMeasure:u,useTimer:f,addEventClick:o,intersect:d,rotate:t}=C(),{playPop:l}=G();let c,s,a;return n(()=>{const{s:p}=u(),r=Math.round(p*.08),m=innerWidth<innerHeight?Math.round(innerWidth-1.6*r-2*r-.3*r):Math.round(innerWidth-1.6*r),g=innerWidth<innerHeight?Math.round(innerHeight-1.6*r):Math.round(innerHeight-1.6*r-2*r-.3*r);c={c:"#ff6347",r,x:m,y:g,p:!1},s=W(c),a=Y({x:Number(c.x)-r+Math.round(r*.4),y:Number(c.y)-r+Math.round(r*.4),w:r*2-Math.round(r*.8),src:"/media/back.svg"})}),o((p,r)=>{d({x:p,y:r},c)&&(l(),c.p=!0,e(),f(()=>{c.p=!1},100))}),{render:()=>{s(),c.p||t(()=>{a()},c.x,c.y,innerHeight>innerWidth?0:.5)},point:()=>({x:c.x,y:c.y,r:c.r})}},Be=e=>{const{ctx:n,shade:u}=C(),f=Math.round(e.r/2.2),o=Math.round(.15*e.r),d=u(e.c||"blue",-3);return(t=n)=>{const{r:l,x:c=l,y:s=l}=e;t.lineCap="round",t.fillStyle=d,t.strokeStyle=d,t.lineWidth=f,t.beginPath(),t.moveTo(c+o,s),t.lineTo(c-o/2,s-o),t.lineTo(c-o/2,s+o),t.closePath(),t.fill(),t.beginPath(),t.moveTo(c+o,s),t.lineTo(c-o/2,s-o),t.moveTo(c-o/2,s-o),t.lineTo(c-o/2,s+o),t.moveTo(c-o/2,s+o),t.lineTo(c+o,s),t.stroke()}},me=({getX:e,getY:n,color:u="#bef181",popEffect:f=()=>{}})=>{const{addEventResize:o,useMeasure:d,useTimer:t,useScreenMeta:l,navigate:c,addEventClick:s,intersect:a}=C(),{from:i}=l();let h,p,r;return o(()=>{const{cx:y,cy:M,s:v,m:w}=d();h={c:u,r:Math.round(v*.1),x:e(y,v,w),y:n(M,v,w),p:(i==="gamescore"||i==="game"||i==="gameover"||i==="opening"||i==="devs")&&!h},p=W(h),r=Be(h)}),t(()=>{h.p&&f(h,!1,!0),h.p=!1}),s((y,M)=>{a({x:y,y:M},h)&&(f(h),h.p=!0,t(()=>{c("game")},100))}),{render:()=>{p(),h.p||r()},point:()=>({x:h.x,y:h.y,r:h.r})}},Me=e=>{const{ctx:n,shade:u}=C(),f=Math.round(e.r/4),o=Math.round(.12*e.r);return(d=n)=>{const{r:t,x:l=t,y:c=t}=e,s=u(e.c||"blue",-3);d.lineCap="round",d.strokeStyle=s,d.lineWidth=f,d.beginPath(),d.moveTo(l-1.5*o,c-2*o),d.lineTo(l-1.5*o,c+2*o),d.stroke(),d.beginPath(),d.moveTo(l+1.5*o,c-2*o),d.lineTo(l+1.5*o,c+2*o),d.stroke()}},Oe=({getX:e,getY:n,popEffect:u=()=>{}})=>{const{addEventResize:f,useMeasure:o,useTimer:d,useScreenMeta:t,navigate:l,addEventClick:c,intersect:s}=C(),{from:a}=t();let i,h,p;return f(()=>{const{cx:g,cy:y,s:M,m:v}=o();i={c:"#fd8059",r:Math.round(M*.08),x:e(g,M,v),y:n(y,M,v),p:(a==="game"||a==="opening")&&!i},h=W(i),p=Me(i)}),d(()=>{i.p&&u(i,!1,!0),i.p=!1},500),c((g,y)=>{s({x:g,y},i)&&(u(i),i.p=!0,d(()=>{l("main")},100))}),{render:()=>{h(),i.p||p()},point:()=>({x:i.x,y:i.y,r:i.r})}},Ne=e=>{const{ctx:n,shade:u}=C(),f=Math.round(e.r/4),o=Math.round(.2*e.r),d=u(e.c||"blue",-5);return(t=n)=>{const{r:l,x:c=l,y:s=l}=e;t.lineCap="round",t.fillStyle=d,t.strokeStyle=d,t.lineWidth=f,t.beginPath(),t.ellipse(c-o,s+o,f,o,10*Math.PI/180,0,2*Math.PI),t.closePath(),t.fill(),t.beginPath(),t.moveTo(c-o/2,s+o),t.lineTo(c,s-o),t.lineTo(c+o,s-o),t.stroke(),e.on||(t.lineWidth=Math.round(f/3),t.beginPath(),t.moveTo(c-l/4,s-l/4),t.lineTo(c+l/4,s+l/4),t.stroke())}},$e=({color:e="#f9f774",popEffect:n=()=>{}})=>{const{addEventResize:u,useMeasure:f,useTimer:o,useScreenMeta:d,addEventClick:t,intersect:l}=C(),{from:c}=d(),{getSound:s,setSound:a}=H();let i,h,p;return u(()=>{const{cx:g,cy:y,s:M,m:v}=f(),w=Math.round(M*.25),P=Math.round(M*.065),E=s();i={c:e,r:P,x:g-w-P-v,y:y-w+3*P,p:(c==="opening"||c==="devs")&&!i,on:E},h=W(i),p=Ne(i)}),o(()=>{i.p&&n(i,!1,!0),i.p=!1}),t((g,y)=>{if(l({x:g,y},i)){let M=s();M=!M,a(M),i.p=!0,i.on=M,n(i),o(()=>{i.p=!1},100)}}),{render:()=>{h(),i.p||p()},point:()=>({x:i.x,y:i.y,r:i.r})}},Ye=({color:e="#f86a9a",popEffect:n=()=>{}})=>{const{addEventResize:u,useMeasure:f,useTimer:o,useScreenMeta:d,addEventClick:t,intersect:l,navigate:c}=C(),{from:s}=d();let a,i,h,p;return u(()=>{const{cx:g,cy:y,s:M}=f(),v=Math.round(M*.25);a={c:e,x:g,y,r:v,p:(s==="opening"||s==="devs")&&!a},i=W(a),h=V({text:"Yola",c:"#f1f1f1",x:g,y:y-v+Math.round(v*.9),fs:Math.round(v/2.6),mw:v*2}),p=V({text:"PopiT",c:"#ffeb3b",x:g,y:y-v+Math.round(v*1.3),fs:Math.round(v/2.3),mw:v*2})}),o(()=>{a.p&&n(a,!1,!0),a.p=!1}),t((g,y)=>{l({x:g,y},a)&&(n(a),a.p=!0,o(()=>{c("devs")},100))}),{render:()=>{i(),a.p||(h(),p())},point:()=>({x:a.x,y:a.y,r:a.r})}},ve=({color:e="#00dcfe",frequency:n=20})=>{const{addEventResize:u,useRandChain:f,useMeasure:o,rand:d,useTimer:t,setBackground:l,useScreenMeta:c}=C(),{from:s}=c();l(e);const a=d(0,999);let i=[],h=[];u(()=>{const g=f(a),{s:y}=o();i=[];const M=Math.round(y*.04),v=Math.round(innerWidth/M/2)-2,w=Math.round((innerWidth-2*M*v)/(v+1)),P=Math.round(innerHeight/M/2)-2,E=Math.round((innerHeight-2*M*P)/(P+1));for(let S=0;S<P;S++)for(let I=0;I<v;I++)g(g(n))<1&&i.push({x:w+M+I*M*2+w*I,y:E+M+S*M*2+E*S,r:M,c:e,p:s==="opening"?!0:g(1)>0});h=i.map(S=>W(S))});const p=()=>{t(()=>{const g=d(i.length-1);i[g]&&(i[g].p=!i[g].p),p()},750)};return s==="opening"?t(()=>{i.forEach(g=>g.p=d(1)>0),p()}):p(),{render:()=>{h.forEach(g=>g())},setIntersections:g=>{i=i.filter(({x:y,y:M,r:v})=>g(y,M,v)),h=i.map(y=>W(y))}}},se=(e=!1)=>{let n=["#f86a9a","#C69FEE","#5bb2f7","#92E6E6","#7ceab2","#bef181","#EFCD74","#fd8059"];const{addEventResize:u,useMeasure:f,setBackground:o,rand:d}=C(),{getDifficultyRad:t}=H();return n=[...n.splice(d(n.length-1),n.length),...n],e||u(()=>{const{s:c}=f(),s=t(),a=Math.round(c*s),i=Math.round(innerWidth/a/2)-1,h=(innerWidth-2*a*i)/(i+1),p=Math.round(innerHeight/a/2)-1,r=(innerHeight-2*a*p)/(p+1),m=innerWidth>=innerHeight,g=m?i:p,y=m?h:r,M=m?innerWidth:innerHeight;let v=0;const w=[];for(let E=0;E<g;E++)n[v]||(v=0),w.push(`${n[v]} ${(y+a+E*a*2+y*E)/M*100}%`),v++;o(`linear-gradient(${m?"to right":"to bottom"}, ${w.join(", ")})`,innerWidth<innerHeight?n[0]:"#040404")}),n},we=({palette:e,retry:n,popEffect:u=()=>{}})=>{const{addEventResize:f,useMeasure:o,rand:d,useTimer:t,useScreenMeta:l,navigate:c,addEventClick:s,intersect:a}=C(),{from:i}=l(),{getDifficultyRad:h}=H(),p=[];let r=[],m,g,y,M={x:0,y:0,r:0};const v=P=>Array.isArray(e)?e[P]:e;return f(()=>{const{s:P}=o();p.splice(0);const E=h(),S=Math.round(P*E),I=Math.round(innerWidth/S/2)-1,A=(innerWidth-2*S*I)/(I+1),z=Math.round(innerHeight/S/2)-1,X=(innerHeight-2*S*z)/(z+1),N=innerWidth>=innerHeight;let R=0;for(let b=0;b<z;b++){for(let T=0;T<I;T++){v(R)||(R=0);const x={x:A+S+T*S*2+A*T,y:X+S+b*S*2+X*b,r:S,c:v(R),p:!0};b===0&&T===I-1?(M={x:x.x,y:x.y,r:x.r,c:x.c,p:(i==="main"||i==="gameover"||i==="gamescore")&&!M.r},m=W(M),g=Me(M)):p.push(x),R+=N?1:0}R=N?0:R+1}n&&(y=p[d(p.length-1)],t(()=>{u(y,!1,!0),y.p=!1})),r=p.map(b=>W(b))}),t(()=>{M.p&&u(M,!1,!0),M.p=!1}),n&&s((P,E)=>{a({x:P,y:E},y)&&(u(y),y.p=!0,t(()=>{c("game")},100))}),s((P,E)=>{a({x:P,y:E},M)&&(u(M),M.p=!0,t(()=>{c("main")},100))}),{render:()=>{r.forEach(P=>P()),m(),M!=null&&M.p||g()},popits:p,pausePpt:M}},L=100,j="#222",Ge=e=>{const n=(e==null?void 0:e[0])||0,u=(e==null?void 0:e[1])||0,f=(e==null?void 0:e[2])||0;return"#"+(16777216+(n<255?n<1?0:n:255)*65536+(u<255?u<1?0:u:255)*256+(f<255?f<1?0:f:255)).toString(16).slice(1)},ne={},Xe=e=>{const{ctx:n,createImg:u,useRandChain:f,useTimer:o}=C();let d,t=!1,l=[];const c=e.r*2/L/2;ne[e.imgSrc]?d=ne[e.imgSrc]:(d=ne[e.imgSrc]={img:new Image,cols:[],isFilled:!1,r:e.r,drawImg:null,score:e.score},d.img.src=e.imgSrc);const s=()=>o(()=>{t=!t,s()},250),a=(m,g=n)=>{const{x:y,y:M,c:v,r:w}=m;g.fillStyle=v||"red",g.beginPath(),g.arc(y+w,M+w,w,0,Math.PI*2),g.closePath(),g.fill()},i=(m=n,g=0,y=0)=>{m.fillStyle=j,m.beginPath(),m.roundRect(g,y,2*e.r,2*e.r,c),m.closePath(),m.fill()},h=()=>{const m=[];for(let w=0;w<L;w++)for(let P=0;P<L;P++){const E={x:P*c*2,y:w*c*2,r:c,c:j};m.push(E)}let g=e.score-e.winScore;const y=[...m],M=f(e.seed),v=(w=!1)=>{const P=M(y.length-1),E=y[P],S=m.indexOf(E);E.c=w?j:d.cols[S],y.splice(P,1),w&&l.push({...E,c:d.cols[S]})};for(let w=g;w>0;w--)v();if(e.winScore){l=[];for(let w=e.winScore;w>0;w--)v(!0);s()}return m},p=()=>{const m=h();d.drawImg=u((g=n)=>{i(g),m.filter(y=>y.c!==j).forEach(y=>a(y,g))},2*e.r)},r=async()=>{var y;const m=document.createElement("canvas");m.width=L,m.height=L;const g=m.getContext("2d",{willReadFrequently:!0});g==null||g.drawImage(d.img,0,0);for(let M=0;M<L;M++){const v=[];for(let w=0;w<L;w++){const P=(y=g==null?void 0:g.getImageData(w,M,1,1))==null?void 0:y.data;v.push(Ge(P))}d.cols.push(...v)}d.isFilled=!0,p()};return d.isFilled?(d.r!==e.r||d.score!==e.score)&&p():d.img.onload=r,(m=n)=>{const{x:g,y,r:M,winScore:v}=e;if(d.drawImg?m.drawImage(d.drawImg,g-M,y-M,2*M,2*M):i(m,g-M,y-M),t&&v&&d.drawImg)for(const w of l)m.fillStyle=w.c||"red",m.beginPath(),m.arc(g-M+w.x+w.r,y-M+w.y+w.r,w.r,0,Math.PI*2),m.closePath(),m.fill()}},he=1e4,ye=(e=0,n=!1)=>{const{addEventResize:u,useMeasure:f,translate:o}=C(),{getScore:d}=H(),t=["/media/levels/cat.png","/media/levels/city.png","/media/levels/girl.png","/media/levels/home.png","/media/levels/iron.png","/media/levels/wolf.png","/media/levels/max.png"],l=d();let c,s=0,a=0,i=!1,h=!1;const p=v=>Math.min(Math.floor(v/he),t.length-1);let r=p(l-e);if(e){const v=p(l);i=v!==r,h=v>t.length-1}return u(()=>{const{cx:v,cy:w,s:P,isL:E}=f();c=[],s=(P-2*P*.055*1.6)/2,a=P*.05;let S=n?r:0;for(S;S<(n?r+1:t.length);S++){const I=t[S],A=E?v:v+S*s*2+S*a,z=E?w+S*s*2+S*a:w;c.push(Xe({x:A,y:z,r:s,score:Math.min(l-S*he,1e4),imgSrc:I,winScore:e,seed:S}))}}),{up:()=>{r=r+1<t.length?r+1:t.length-1},down:()=>{r=r-1<0?0:r-1},render:()=>{const{isL:v}=f(),w=v?0:-(r*s*2+r*a),P=v?-(r*s*2+r*a):0;o(()=>{c==null||c.forEach(E=>E())},w,P)},rect:()=>{const{cx:v,cy:w}=f(),P=innerWidth>innerHeight;return{x:P?v-s:0,y:P?0:w-s,w:P?2*s:innerWidth,h:P?innerHeight:2*s}},isJump:i,isCompleted:h}},je=({popits:e,pausePpt:n,popEffect:u=()=>{},splashEffect:f=()=>{}})=>{const{useTimer:o,rand:d,addEventClick:t,addEventMove:l,intersect:c,navigate:s,addEventResize:a}=C(),{getScore:i,addScore:h,getDifficultyTic:p}=H();let r=[],m,g,y=!1,M=0,v=0,w=0;const P=i(),E=p(),S=R=>{const b=e.filter(F=>r.indexOf(F)===-1&&F!==R),T=d(b.length-1),x=b[T];x&&(u(x,!1,!0),x.p=!1,r.push(b[T]))},I=()=>{g=o(()=>{if(w=Math.max(w-10,50),e.length===r.length){y=!0,g.stop(),o(()=>{s("gameover")});return}S(),I()},w)},A=R=>{r=[];const b=e.length;let T=d(Math.round(b*.3),Math.round(b*.6));const x=[...e];if(R){const F=x.indexOf(R);x.splice(F,1)}for(let F=T;F>0;F--){const re=d(x.length-1),K=x[re];K.p=!1,u(K,!1,!0),r.push(K),x.splice(re,1)}w=E,m==null||m.stop(),g==null||g.stop(),P&&(m=o(()=>{f("SLOWLY"),I()},r.length*E)),M=M>0?M:d(3,5)},z=()=>1,X=R=>{u(R),w=Math.min(w+5,E),v++,R.p=!0;const b=r.indexOf(R);if(r.splice(b,1),r.length<=0)if(M--,M>0)o(()=>{f("Round"),A(R)},100);else{m==null||m.stop(),g==null||g.stop();const T=z();h(v*T),o(()=>{s("gamescore",{winScore:v*T})},100)}},N=(R,b,T=!1)=>{if(!y){for(const x of r)if(c({x:R,y:b},x)){X(x);return}if(!c({x:R,y:b},n)&&!T){for(const x of e)if(c({x:R,y:b},x)){u(x,!0),f("Popenalty"),S(x);return}f("Popenalty"),S()}}};t(N),l((R,b)=>N(R,b,!0)),a(()=>{o(()=>{f("Pop it"),A()})})},qe=()=>{const{addEventResize:e,rand:n,useScreenMeta:u}=C(),{from:f}=u(),{popEffect:o,render:d}=O(),t=["#00dcfe","#5bb2f7","#92E6E6"],l=f==="opening"?t[0]:t[n(t.length-1)],{render:c,setIntersections:s}=ve({color:l}),{render:a,point:i}=Ye({popEffect:o}),{render:h,point:p}=me({getX:(M,v,w)=>M+Math.round(v*.25)+2*w,getY:(M,v,w)=>M+Math.round(v*.25)+0*w,popEffect:o}),{render:r,point:m}=Fe({popEffect:o}),{render:g,point:y}=$e({popEffect:o});return e(()=>{const M=m(),v=i(),w=p(),P=y();s((E,S,I)=>!D({x:E,y:S,r:I},M)&&!D({x:E,y:S,r:I},v)&&!D({x:E,y:S,r:I},w)&&!D({x:E,y:S,r:I},P))}),()=>{d(),c(),a(),h(),r(),g()}},Ue=()=>{const{useMeasure:e,addEventResize:n}=C(),u=se(),{popEffect:f,render:o}=O(),{popits:d,render:t,pausePpt:l}=we({palette:u,popEffect:f});return je({popits:d,popEffect:f,pausePpt:l}),n(()=>{(d[0].y-d[0].r)/e().m}),()=>{o(),t()}},Ve=()=>{const e="#ff6347",{popEffect:n,render:u}=O(),{setBackground:f}=C(),{minusDifficulty:o}=H(),{render:d}=we({palette:e,retry:!0,popEffect:n}),{playFail:t}=G();return f(e),o(),t(),()=>{u(),d()}},Ke=()=>{const{translate:e,useScreenMeta:n}=C(),{plusDifficulty:u,resetDifficulty:f}=H(),{data:o}=n(),{popEffect:d,render:t}=O();se();const{playWin:l}=G(),{render:c,isJump:s}=ye(o==null?void 0:o.winScore,!0),{render:a}=me({getX:(h,p,r)=>innerWidth>innerHeight?Math.min(h+(p-2*p*.055*1.6)/2+4*r+Math.round(p*.1),innerWidth-2*r-Math.round(p*.1)):h+(p-2*p*.055*1.6)/8+0*Math.round(p*.1)+2*r,getY:(h,p,r)=>innerWidth>innerHeight?h+(p-2*p*.055*1.6)/2-1*r-Math.round(p*.1):Math.min(h+(p-2*p*.055*1.6)/2+4*r+Math.round(p*.1),innerHeight-2*r-Math.round(p*.1)),popEffect:d}),{render:i}=Oe({getX:(h,p,r)=>innerWidth>innerHeight?Math.max(h-(p-2*p*.055*1.6)/2-4*r-Math.round(p*.1),2*r+Math.round(p*.1)):h+(p-2*p*.055*1.6)/8-2*Math.round(p*.1)-2*r,getY:(h,p,r)=>innerWidth>innerHeight?h-(p-2*p*.055*1.6)/2+0*r+Math.round(p*.1):Math.min(h+(p-2*p*.055*1.6)/2+4*r+Math.round(p*.1),innerHeight-2*r-Math.round(p*.1)),popEffect:d});return s?f():u(),l(),()=>{t(),innerHeight>innerWidth?e(c,0,-Math.round(innerHeight*.05)):c(),a(),i()}},Je=()=>{const{addEventResize:e,rand:n}=C(),{popEffect:u,render:f}=O(),o=["#ffeb3b","#C69FEE","#7ceab2","#bef181","#EFCD74"],d=o[n(o.length-1)],{render:t,setIntersections:l}=ve({color:d,frequency:10}),{render:c,rect:s,up:a,down:i}=ye(),{render:h,point:p}=ge({popEffect:u}),{render:r,point:m}=Le({onClick:a,popEffect:u}),{render:g,point:y}=_e({onClick:i,popEffect:u});return e(()=>{const M=p(),v=s(),w=m(),P=y();l((E,S,I)=>!D({x:E,y:S,r:I},M)&&!We({x:E,y:S,r:I},v)&&!D({x:E,y:S,r:I},w)&&!D({x:E,y:S,r:I},P))}),()=>{f(),t(),c(),h(),r(),g()}},Ze=()=>{const{addEventResize:e,setBackground:n,createImg:u,useMeasure:f,ctx:o,loop:d}=C(),{popEffect:t,render:l}=O(),{render:c}=ge({popEffect:t}),s=se(!0);let a=[];const i=["Director","Producer","Designer","Developer"];return e(()=>{const{m:h,cy:p,s:r}=f();a=[];const m=Math.round(h*3.5),g=Math.round(r*.6),y=Math.round((r-g)/2);let M=p,v=0;for(const w of i){s[v]||(v=0);const P=V({text:w,x:0,y:m,c:s[v],fs:Math.round(m*.7),mw:g,a:"left"}),E=V({text:"MAXIM NEZABOTIN",x:g,y:m*2,c:"#fff",fs:Math.round(m*.75),mw:g,a:"right"}),S=u((I=o)=>{P(I),E(I)},g,2*m);a.push({img:S,x:y,y:M,w:g,h:5*m}),M+=7*m,v++}}),n("#040404"),d(()=>{for(const h of a)h.y-=1}),()=>{a.forEach(({img:h,x:p,y:r,w:m,h:g})=>{o.drawImage(h,p,r,m,g)}),l(),c()}},Qe=[{name:"opening",ctor:Ae},{name:"main",ctor:qe},{name:"game",ctor:Ue},{name:"gameover",ctor:Ve},{name:"gamescore",ctor:Ke},{name:"score",ctor:Je},{name:"devs",ctor:Ze}],et=["/sounds/new/pop1.mp3","/sounds/new/pop2.mp3","/sounds/new/pop3.mp3","/sounds/new/pop4.mp3","/sounds/new/pop5.mp3","/sounds/new/pop6.mp3","/sounds/new/pop7.mp3","/sounds/new/pop8.mp3","/sounds/new/pop9.mp3","/sounds/new/pop10.mp3","/sounds/new/pop11.mp3","/sounds/new/pop12.mp3","/sounds/new/pop13.mp3","/sounds/new/pop14.mp3","/sounds/new/pop15.mp3","/sounds/new/pop16.mp3","/sounds/new/pop17.mp3","/sounds/new/pop18.mp3","/sounds/new/pop19.mp3","/sounds/new/pop20.mp3","/sounds/new/pop21.mp3","/sounds/new/pop22.mp3","/sounds/new/pop23.mp3","/sounds/new/pop24.mp3","/sounds/rinat/pop(1).wav","/sounds/rinat/pop(2).wav","/sounds/rinat/pop(3).wav","/sounds/rinat/pop(4).wav","/sounds/rinat/pop(5).wav","/sounds/rinat/pop(6).wav","/sounds/rinat/pop(7).wav","/sounds/rinat/pop(8).wav","/sounds/rinat/pop(9).wav","/sounds/rinat/pop(10).wav","/sounds/rinat/pop(11).wav","/sounds/rinat/pop(12).wav","/sounds/fail-fast.mp3","/sounds/new/wrong.mp3","/sounds/win.mp3"];He(Qe,et);document.title="Your's last Pop it";
